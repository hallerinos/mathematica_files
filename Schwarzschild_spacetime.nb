(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63551,       1625]
NotebookOptionsPosition[     57629,       1543]
NotebookOutlinePosition[     58028,       1559]
CellTagsIndexPosition[     57985,       1556]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["GP coordinates", "Subsection",
 CellChangeTimes->{{3.885297198570616*^9, 3.8852972121461678`*^9}, {
  3.885449745407755*^9, 3.885449752430788*^9}, {3.885450288947383*^9, 
  3.885450295206008*^9}},ExpressionUUID->"988f28cf-0eb9-4384-bfb7-\
c3023488300b"],

Cell[BoxData[{
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SqrtBox[
      RowBox[{"1", "/", "r"}]]}], ")"}], ",", "r"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"%", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SqrtBox[
       RowBox[{"1", "/", "r"}]]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Radius in arbitrary units (a.u.)\>\"", ",", " ", 
      "\"\<acceleration in a.u.\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8858854414960213`*^9, 3.885885542080432*^9}, {
  3.8858857679866247`*^9, 3.885885772147203*^9}, {3.885885950553445*^9, 
  3.885886001849655*^9}},
 CellLabel->
  "In[4085]:=",ExpressionUUID->"9b8bd884-b4e1-46eb-a6a6-1b193db15148"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"x", ",", "y", ",", "z", ",", "u"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uv", "[", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "=", 
  RowBox[{
   RowBox[{"u", "[", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["y", "2"], "+", 
      SuperscriptBox["z", "2"]}]], "]"}], "*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], "/", 
    SqrtBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ".", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
      ")"}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gdn\[Mu]\[Nu]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"uv", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], ".", 
           RowBox[{"uv", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], ")"}], "/", 
         SuperscriptBox["c", "2"]}], "-", "1"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"uv", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/", "c"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"uv", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "/", "c"}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"uv", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "/", "c"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"uv", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "/", "c"}], ",", "1", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"uv", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "/", "c"}], ",", "0", ",", "1", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"uv", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "/", "c"}], ",", "0", ",", "0", 
       ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.884861808239718*^9, 3.884861883841229*^9}, {
   3.884861956499875*^9, 3.884862020929134*^9}, {3.884862106228424*^9, 
   3.884862201587612*^9}, {3.884862236798028*^9, 3.88486225017664*^9}, {
   3.8850169547525578`*^9, 3.885016981265163*^9}, {3.88528632412142*^9, 
   3.885286511253622*^9}, {3.885286644929265*^9, 3.885286656560495*^9}, 
   3.88528864668674*^9, 3.885289160019541*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"e93c3905-82c0-409f-9438-4a8e7c604c42"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8852847671029797`*^9, 3.885284847066435*^9}, {
   3.88528489229494*^9, 3.885284924625367*^9}, {3.885284983534301*^9, 
   3.885284989021551*^9}, {3.8852865264622097`*^9, 3.885286535448617*^9}, {
   3.885286583794962*^9, 3.885286600669304*^9}, {3.885287351138403*^9, 
   3.885287354019038*^9}, {3.885287691822521*^9, 3.885287708741131*^9}, 
   3.885287873578261*^9},
 CellLabel->
  "In[158]:=",ExpressionUUID->"9482ef13-e370-42fb-82ec-383f99afe1b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"J", "\[Transpose]"}], ".", "gdn\[Mu]\[Nu]", ".", "J"}], "//", 
    "ComplexExpand"}], "//", "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"gdn\[Mu]\[Nu]", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"%", ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{"r", ">", "0"}], "&&", 
      RowBox[{"c", ">", "0"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.885287401969308*^9, 3.885287466905648*^9}, {
  3.885287500234779*^9, 3.885287530585455*^9}, {3.885287635166295*^9, 
  3.885287647775794*^9}, {3.8853883083241043`*^9, 3.885388309736702*^9}, {
  3.885388898145759*^9, 3.885388904252947*^9}, {3.885450492943417*^9, 
  3.885450539460322*^9}, {3.88545057424214*^9, 3.885450575020035*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"0629c7fb-7290-4df6-871f-c61eda054c78"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dxupmu", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", " ", "dt"}], ",", "dr", ",", "d\[Theta]", ",", "d\[Phi]"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.884861889316669*^9, 3.884861910015328*^9}, {
  3.8848620303620443`*^9, 3.8848620558748503`*^9}, {3.885016672488845*^9, 
  3.8850166730328617`*^9}, {3.8850168901183968`*^9, 3.8850169016875973`*^9}, {
  3.885285304923381*^9, 3.885285307308096*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"3e8a04f5-62b3-4e57-b192-e3aafa0229b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dxupmu", ".", "gdn\[Mu]\[Nu]", ".", "dxupmu"}], "//", 
   "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"dt", ",", "r"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.884861911440591*^9, 3.884861931527753*^9}, {
  3.884862002973052*^9, 3.88486200871346*^9}, {3.884862057907208*^9, 
  3.8848620586056623`*^9}, {3.885285057198131*^9, 3.885285078234153*^9}, {
  3.885388804781845*^9, 3.8853888111590557`*^9}, {3.885450311586344*^9, 
  3.885450358816221*^9}, {3.8854504057120028`*^9, 3.885450415398337*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"3d27c896-919f-44d7-bc72-1f0b51cb28cc"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmudn", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[CapitalEpsilon]"}], "/", "c"}], ",", "k1", ",", "k2", 
     ",", "k3"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8853916222886343`*^9, 3.885391625898324*^9}, {
  3.8853929647079153`*^9, 3.885392966679316*^9}, {3.885393745944997*^9, 
  3.885393751018509*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"eaa74705-0b90-46f4-b2c1-156a54ef4165"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse", "[", "gdn\[Mu]\[Nu]", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.885539701116437*^9, 3.885539702681507*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"6c5aa7f8-db71-4c2a-864e-aee8551f9164"],

Cell[BoxData[{
 RowBox[{"\[CapitalEta]", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"kmudn", ".", 
        RowBox[{"Inverse", "[", "gdn\[Mu]\[Nu]", "]"}], ".", "kmudn"}], 
       ")"}]}], ")"}], "//", "ExpandAll"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalEta]red", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]", "->", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"k2", "->", "0"}]}], "}"}]}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"c", ">", "0"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solk1full", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"\[CapitalEta]", "==", "0"}], ",", "k1"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"solk1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]", "->", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"k2", "->", "0"}]}], "}"}]}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"c", ">", "0"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8848622080870037`*^9, 3.884862222449749*^9}, {
   3.8848624252366943`*^9, 3.8848624638992567`*^9}, {3.884862504879808*^9, 
   3.8848625116209173`*^9}, {3.885016931348331*^9, 3.8850169345441723`*^9}, {
   3.885017121380129*^9, 3.885017213726275*^9}, {3.885284586579384*^9, 
   3.885284593263257*^9}, {3.885286996873794*^9, 3.885287004613237*^9}, {
   3.885287035259197*^9, 3.88528703597968*^9}, {3.88528805405155*^9, 
   3.88528805931489*^9}, 3.885288097880926*^9, {3.885288815664693*^9, 
   3.885288821625875*^9}, {3.8852892762058163`*^9, 3.885289366925148*^9}, {
   3.885289398360824*^9, 3.885289398494131*^9}, {3.885289524155774*^9, 
   3.8852895473867064`*^9}, {3.8852898991897497`*^9, 3.88528990249702*^9}, {
   3.885297101391761*^9, 3.885297137232707*^9}, {3.8852971806819696`*^9, 
   3.88529718156144*^9}, {3.8853899713601933`*^9, 3.885389975498654*^9}, {
   3.885392757591639*^9, 3.885392757832052*^9}, {3.8853928502984657`*^9, 
   3.885392850808782*^9}, {3.885392980788957*^9, 3.8853929808642*^9}, {
   3.8853936820611773`*^9, 3.885393683161648*^9}, {3.88539389200496*^9, 
   3.88539389338515*^9}, {3.885394733222052*^9, 3.885394765269813*^9}, {
   3.885532897271895*^9, 3.885532897526808*^9}, {3.8855329622395487`*^9, 
   3.885533023730373*^9}, {3.885539505934273*^9, 3.885539513073938*^9}, {
   3.8855395611716213`*^9, 3.8855395615507517`*^9}, {3.885539755199494*^9, 
   3.8855397553194437`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"8c319ae8-56b3-4763-88b2-2ba132f2f622"],

Cell[BoxData[{
 RowBox[{"solE", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"\[CapitalEta]red", "==", "0"}], ",", "\[CapitalEpsilon]"}], 
    "]"}], "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"solEfull", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"\[CapitalEta]", "==", "0"}], ",", "\[CapitalEpsilon]"}], "]"}], 
   "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.885019894844769*^9, 3.885019906080962*^9}, {
   3.8852889459049463`*^9, 3.885288953812726*^9}, {3.8852899119228907`*^9, 
   3.885289912094469*^9}, {3.885297462918358*^9, 3.885297474322439*^9}, 
   3.885391533145606*^9, {3.88539212160997*^9, 3.885392125667293*^9}, {
   3.8855395171186666`*^9, 3.885539522150556*^9}, {3.8855395686090307`*^9, 
   3.885539570277079*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"d0d45d1f-cf82-4c4a-8f89-ed55812e12ab"],

Cell[BoxData[{
 RowBox[{"\[Theta]dot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[CapitalEta]", ",", "k2"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"k2dot", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]", ",", "\[Theta]"}], "]"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.885011308711698*^9, 3.8850113108903027`*^9}, {
   3.885011451316997*^9, 3.8850114731527033`*^9}, 3.8850168152823877`*^9, {
   3.885016861505574*^9, 3.8850168631244287`*^9}, {3.885016940905403*^9, 
   3.8850169414030848`*^9}, {3.885017232706881*^9, 3.885017242750943*^9}, {
   3.8852888508405848`*^9, 3.885288856826127*^9}, {3.88528991933782*^9, 
   3.885289920830818*^9}, {3.885391636382587*^9, 3.885391638260828*^9}, {
   3.885392182448874*^9, 3.885392187643676*^9}, {3.8853929918338757`*^9, 
   3.885392996604417*^9}, {3.885393790768219*^9, 3.8853937909661913`*^9}, {
   3.885395317100081*^9, 3.88539532217572*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"0becaf95-b6fd-4fbf-8e1e-6c8ad3237697"],

Cell[BoxData[{
 RowBox[{"\[Phi]dot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[CapitalEta]red", ",", "k3"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"k3dot", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]red", ",", "\[Phi]"}], "]"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.885011308711698*^9, 3.8850113108903027`*^9}, {
   3.885011451316997*^9, 3.8850114731527033`*^9}, 3.8850168152823877`*^9, {
   3.885016861505574*^9, 3.8850168631244287`*^9}, {3.885016940905403*^9, 
   3.8850169414030848`*^9}, {3.885017232706881*^9, 3.885017242750943*^9}, {
   3.8852837745448008`*^9, 3.8852837777750998`*^9}, {3.8852888676039057`*^9, 
   3.8852888730385027`*^9}, {3.88529078531035*^9, 3.885290785507146*^9}, {
   3.885391277292238*^9, 3.8853912785151777`*^9}, {3.8853916407620993`*^9, 
   3.88539164374049*^9}, {3.885392192111733*^9, 3.8853922104977407`*^9}, {
   3.885393004684462*^9, 3.885393008841723*^9}, {3.885393708912162*^9, 
   3.885393720440785*^9}, {3.885393795515546*^9, 3.885393795747944*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"3bc5dce5-814b-4d16-9bdf-21cee14dacf8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"\[CapitalEta]red", ",", "k1"}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "solk1"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.885011308711698*^9, 3.8850113108903027`*^9}, {
   3.885011451316997*^9, 3.8850114731527033`*^9}, 3.8850168152823877`*^9, {
   3.885016861505574*^9, 3.8850168631244287`*^9}, {3.885016940905403*^9, 
   3.8850169414030848`*^9}, {3.885017232706881*^9, 3.885017242750943*^9}, {
   3.8852837745448008`*^9, 3.8852837777750998`*^9}, {3.8852888676039057`*^9, 
   3.8852888730385027`*^9}, {3.88529078531035*^9, 3.885290785507146*^9}, {
   3.885291553486381*^9, 3.8852915548831663`*^9}, {3.8852917279024277`*^9, 
   3.885291727973996*^9}, {3.8852957626005583`*^9, 3.885295843401264*^9}, {
   3.885295898262909*^9, 3.885295942275381*^9}, {3.885295985752532*^9, 
   3.885296076878561*^9}, {3.885296118796465*^9, 3.885296131556382*^9}, {
   3.885296947135415*^9, 3.885296947465575*^9}, {3.8852974853522253`*^9, 
   3.885297495493372*^9}, {3.885297654640978*^9, 3.8852976639805*^9}, {
   3.8852982297927*^9, 3.885298232491517*^9}, {3.88539154679286*^9, 
   3.88539154706039*^9}, 3.885393030524477*^9, {3.8855337364395533`*^9, 
   3.885533736513824*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"aa893a83-90ba-458f-88d2-192a9fbc10da"],

Cell[BoxData[{
 RowBox[{"rdot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"\[CapitalEta]red", ",", "k1"}], "]"}], "/.", "solk1"}], "//", 
    "ExpandAll"}], "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rdot", "/.", 
    RowBox[{"solk1", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"gprdot", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"%", ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["c", "2"], "-", 
         SuperscriptBox[
          RowBox[{"u", "[", "r", "]"}], "2"]}], ")"}], ">", "0"}], "&&", 
      RowBox[{"c", ">", "0"}], "&&", 
      RowBox[{"r", ">", "0"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"k1dot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]red", ",", "r"}], "]"}], "//", "ExpandAll"}], "//",
    "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{
  3.885387679963595*^9, {3.8853908404389133`*^9, 3.8853908541423893`*^9}, {
   3.885391249198538*^9, 3.885391272891295*^9}, {3.885391543888397*^9, 
   3.885391544146359*^9}, {3.885392285676669*^9, 3.885392296036046*^9}, {
   3.88539304141481*^9, 3.885393041513626*^9}, {3.8855331623565807`*^9, 
   3.885533166627719*^9}, {3.885533455132413*^9, 3.885533465824205*^9}, {
   3.885533680315928*^9, 3.885533680802926*^9}, {3.885533740478606*^9, 
   3.885533744785625*^9}, {3.885533890803008*^9, 3.885533892274469*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"baff83e5-e910-45c3-ae8b-a1a0ab92f091"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]dot", "/", "rdot"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.885391289346264*^9, 3.885391328924696*^9}, {
  3.885392312832158*^9, 3.885392316315752*^9}, {3.885392906164113*^9, 
  3.885392906464746*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"b2ea0232-3bd0-4fa6-93b2-41235399ae0a"],

Cell[BoxData[
 RowBox[{"dtd\[Tau]", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]red", ",", "\[CapitalEpsilon]"}], "]"}], "/.", 
    RowBox[{"(", "solE", ")"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.885294964017777*^9, 3.885294969778471*^9}, {
   3.8852950549632683`*^9, 3.8852950550990973`*^9}, {3.885295095580987*^9, 
   3.885295142265387*^9}, {3.88529519669706*^9, 3.8852951994513474`*^9}, {
   3.8852958897995653`*^9, 3.885295890022332*^9}, {3.8852975132276993`*^9, 
   3.885297517411509*^9}, {3.885297561040135*^9, 3.885297562073461*^9}, {
   3.885297739736718*^9, 3.885297739846766*^9}, {3.885298014375496*^9, 
   3.885298016827613*^9}, {3.885299917055127*^9, 3.885299920204199*^9}, 
   3.885300541785285*^9, {3.8853006375353527`*^9, 3.885300661035994*^9}, {
   3.885301278525751*^9, 3.8853012853876247`*^9}, {3.885393100473001*^9, 
   3.885393104073482*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"1da71078-5083-40bb-ae9d-612dabdaa914"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"radial", " ", "trajectory"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rdot", "/", 
      RowBox[{"dtd\[Tau]", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
     RowBox[{"(", 
      RowBox[{"solk1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"rtdot", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{"{", 
        RowBox[{"k3", "->", "0"}], "}"}]}], ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["c", "2"], "-", 
           SuperscriptBox[
            RowBox[{"u", "[", "r", "]"}], "2"]}], ")"}], ">", "0"}], "&&", 
        RowBox[{"c", ">", "0"}], "&&", 
        RowBox[{"r", ">", "0"}], "&&", 
        RowBox[{"\[CapitalEpsilon]", ">", "0"}]}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"rtddot", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"%", ",", "r"}], "]"}], "*", 
     RowBox[{"rtdot", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8854494698871737`*^9, 3.8854496497830057`*^9}, {
  3.885450585348379*^9, 3.885450589832246*^9}, {3.885450696367559*^9, 
  3.885450725365107*^9}, {3.885450775181159*^9, 3.885450776098104*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"d7e22302-d986-41a0-b414-062846ba0a98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u", "[", "r_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "c"}], 
   SqrtBox[
    RowBox[{"1", "/", "r"}]]}]}], "\n", 
 RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]", 
 RowBox[{"gpvel", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"rtdot", "/", "c"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "1", ",", "10"}], "}"}], ",", 
    RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"MaTeX", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<r(t)/r_s\>\"", ",", "\"\<\\\\dot r(t)/c\>\""}], "}"}], 
      "]"}]}], ",", 
    RowBox[{"PlotLabel", "->", 
     RowBox[{
     "MaTeX", "[", 
      "\"\<\\\\text{Gullstrand-Peinlev\[EAcute] coordinates}\>\"", "]"}]}], 
    ",", 
    RowBox[{"ImageSize", "->", "300"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"gpacc", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"rtddot", "/", 
        SuperscriptBox["c", "2"]}], "10"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "1", ",", "10"}], "}"}], ",", 
    RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"MaTeX", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<r(t)/r_s\>\"", ",", "\"\<10\\\\ddot r(t) r_s/c^2\>\""}], 
       "}"}], "]"}]}], ",", 
    RowBox[{"PlotLabel", "->", 
     RowBox[{
     "MaTeX", "[", "\"\<\\\\phantom{\\\\text{Schwarzschild coordinates}}\>\"",
       "]"}]}], ",", 
    RowBox[{"ImageSize", "->", "300"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"u", ",", "r", ",", "c"}], "]"}]}], "Input",
 CellChangeTimes->{{3.885449889738673*^9, 3.885449901236451*^9}, {
   3.885449952605863*^9, 3.885450045008494*^9}, {3.885450741454214*^9, 
   3.885450751825842*^9}, {3.8854508373366013`*^9, 3.885451307066925*^9}, {
   3.885451346409542*^9, 3.885451380706107*^9}, 3.8855330793307133`*^9, {
   3.885534504367733*^9, 3.885534593586821*^9}, {3.885534643002371*^9, 
   3.885534684432473*^9}, {3.885534715650876*^9, 3.885534755330166*^9}, {
   3.885534870138389*^9, 3.885534870282649*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"cb10ada6-a732-4234-b47e-a76cae928814"]
}, Open  ]],

Cell[CellGroupData[{

Cell["In Schwarzschild coordinates", "Subsection",
 CellChangeTimes->{{3.8854480145400257`*^9, 
  3.885448019485833*^9}},ExpressionUUID->"6cad944a-0483-47b8-8adb-\
079438813493"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gdn\[Mu]\[Nu]", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"u", "[", "r", "]"}], "2"], 
         SuperscriptBox["c", "2"]]}], ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", 
         RowBox[{"1", "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"u", "[", "r", "]"}], "2"], 
           SuperscriptBox["c", "2"]]}]]}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", 
        SuperscriptBox["r", "2"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["r", "2"]}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.885286612149077*^9, 3.885286630186881*^9}, {
   3.8852866748288307`*^9, 3.885286677170607*^9}, {3.885287950641889*^9, 
   3.8852879855831137`*^9}, 3.8852886593511457`*^9, {3.885288984694275*^9, 
   3.885288986246936*^9}, {3.885289044478767*^9, 3.885289045557081*^9}, {
   3.885289178782981*^9, 3.8852891897149067`*^9}, {3.8852936043028708`*^9, 
   3.885293609522921*^9}, {3.885387690112624*^9, 3.885387701679615*^9}, {
   3.885448081091825*^9, 3.885448082796939*^9}, {3.885448124442255*^9, 
   3.885448248128063*^9}, 3.885448285548346*^9, {3.88544834037048*^9, 
   3.885448343068355*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"77dbed02-cf61-4b10-be5b-a7501440c3af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dxupmu", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", " ", "dt"}], ",", "dr", ",", "d\[Theta]", ",", "d\[Phi]"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.884861889316669*^9, 3.884861910015328*^9}, {
  3.8848620303620443`*^9, 3.8848620558748503`*^9}, {3.885016672488845*^9, 
  3.8850166730328617`*^9}, {3.8850168901183968`*^9, 3.8850169016875973`*^9}, {
  3.885285304923381*^9, 3.885285307308096*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"a021cfa6-149d-432c-b5ee-400bb4bb2e1b"],

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dxupmu", ".", "gdn\[Mu]\[Nu]", ".", "dxupmu"}], "//", 
    "FullSimplify"}], ",", 
   RowBox[{"{", 
    RowBox[{"dt", ",", 
     RowBox[{"-", 
      SuperscriptBox["r", "2"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.884861911440591*^9, 3.884861931527753*^9}, {
  3.884862002973052*^9, 3.88486200871346*^9}, {3.884862057907208*^9, 
  3.8848620586056623`*^9}, {3.885285057198131*^9, 3.885285078234153*^9}, {
  3.885388804781845*^9, 3.8853888111590557`*^9}, {3.885448435350243*^9, 
  3.8854484641127157`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"3dd77467-6645-4ad1-921e-9a4253f58d89"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"k1", ",", "k2", ",", "k3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmudn", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[CapitalEpsilon]"}], "/", "c"}], ",", "k1", ",", "k2", 
     ",", "k3"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8853916222886343`*^9, 3.885391625898324*^9}, {
  3.8853929647079153`*^9, 3.885392966679316*^9}, {3.885393745944997*^9, 
  3.885393751018509*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"0c3828a1-109d-4cfa-a694-311c23329c56"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Inverse", "[", "gdn\[Mu]\[Nu]", "]"}], "//", "FullSimplify"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.88528840343377*^9, 3.8852884107113123`*^9}, {
  3.885389418135474*^9, 3.8853894209437513`*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"02212ed3-3190-4520-97ca-d9794cff9a08"],

Cell[BoxData[{
 RowBox[{"\[CapitalEta]", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{"kmudn", ".", 
        RowBox[{"Inverse", "[", "gdn\[Mu]\[Nu]", "]"}], ".", "kmudn"}], 
       ")"}]}], ")"}], "//", "ExpandAll"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalEta]red", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]", "->", 
        RowBox[{"\[Pi]", "/", "2"}]}], ",", 
       RowBox[{"k2", "->", "0"}]}], "}"}]}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"c", ">", "0"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"solk1", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "==", "0"}], ",", "k1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8848622080870037`*^9, 3.884862222449749*^9}, {
   3.8848624252366943`*^9, 3.8848624638992567`*^9}, {3.884862504879808*^9, 
   3.8848625116209173`*^9}, {3.885016931348331*^9, 3.8850169345441723`*^9}, {
   3.885017121380129*^9, 3.885017213726275*^9}, {3.885284586579384*^9, 
   3.885284593263257*^9}, {3.885286996873794*^9, 3.885287004613237*^9}, {
   3.885287035259197*^9, 3.88528703597968*^9}, {3.88528805405155*^9, 
   3.88528805931489*^9}, 3.885288097880926*^9, {3.885288815664693*^9, 
   3.885288821625875*^9}, {3.8852892762058163`*^9, 3.885289366925148*^9}, {
   3.885289398360824*^9, 3.885289398494131*^9}, {3.885289524155774*^9, 
   3.8852895473867064`*^9}, {3.8852898991897497`*^9, 3.88528990249702*^9}, {
   3.885297101391761*^9, 3.885297137232707*^9}, {3.8852971806819696`*^9, 
   3.88529718156144*^9}, {3.8853899713601933`*^9, 3.885389975498654*^9}, {
   3.885392757591639*^9, 3.885392757832052*^9}, {3.8853928502984657`*^9, 
   3.885392850808782*^9}, {3.885392980788957*^9, 3.8853929808642*^9}, {
   3.8853936820611773`*^9, 3.885393683161648*^9}, {3.88539389200496*^9, 
   3.88539389338515*^9}, {3.885394733222052*^9, 3.885394765269813*^9}, {
   3.885448941153491*^9, 3.885448941256824*^9}, {3.885536788855538*^9, 
   3.8855368037298117`*^9}, 3.8855373556625013`*^9, 3.885539023901587*^9, 
   3.885539435169383*^9},
 CellLabel->
  "In[203]:=",ExpressionUUID->"2a0328d7-1277-4370-8d3e-9a495e59f5b5"],

Cell[BoxData[{
 RowBox[{"solE", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"\[CapitalEta]red", "==", "0"}], ",", "\[CapitalEpsilon]"}], 
    "]"}], "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"solEfull", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"\[CapitalEta]", "==", "0"}], ",", "\[CapitalEpsilon]"}], "]"}], 
   "//", "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"r", ">", "0"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.885019894844769*^9, 3.885019906080962*^9}, {
   3.8852889459049463`*^9, 3.885288953812726*^9}, {3.8852899119228907`*^9, 
   3.885289912094469*^9}, {3.885297462918358*^9, 3.885297474322439*^9}, 
   3.885391533145606*^9, {3.88539212160997*^9, 3.885392125667293*^9}, {
   3.885454008810813*^9, 3.885454029248865*^9}, 3.885536540874539*^9, {
   3.885539455757598*^9, 3.8855394636192913`*^9}, {3.8861482319770203`*^9, 
   3.886148233447153*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"e0268ff2-ec19-460a-b665-76f608fa468c"],

Cell[BoxData[
 RowBox[{"solEsimple", "=", 
  RowBox[{"First", "[", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[CapitalEpsilon]", "/.", "solE"}], ")"}], "2"], "//", 
      "ExpandAll"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["k1", "2"], ",", 
       RowBox[{
        SuperscriptBox["k3", "2"], "/", 
        SuperscriptBox["r", "2"]}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8854489451417427`*^9, 3.885448965249379*^9}, {
  3.886149158893579*^9, 3.886149177618709*^9}, {3.886149322173336*^9, 
  3.8861493581279097`*^9}, {3.886149388396434*^9, 3.88614940150675*^9}, {
  3.886149536885228*^9, 3.886149555542934*^9}, {3.886152475563184*^9, 
  3.886152486862949*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"9fba444a-91dd-4056-87b7-c97fef358478"],

Cell[BoxData[{
 RowBox[{"c", 
  SqrtBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"u", "[", "r", "]"}], "2"], 
      SuperscriptBox["c", "2"]]}], ")"}]], 
  SqrtBox[
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["k3", "2"], 
      SuperscriptBox["r", "2"]], "+", 
     RowBox[{
      SuperscriptBox["k1", "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"u", "[", "r", "]"}], "2"], 
         SuperscriptBox["c", "2"]]}], ")"}]}]}], 
    ")"}]]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["%", "2"], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[CapitalEpsilon]", "/.", "solE"}], ")"}], "2"]}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"r", ">", "0"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.886149424941556*^9, 3.88614946453442*^9}, {
  3.886152433486225*^9, 3.886152507706379*^9}, {3.8861525394315557`*^9, 
  3.886152721562372*^9}, {3.886152751624517*^9, 3.8861527770091257`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"09cf2fa6-a197-449c-9714-4c866c425ac2"],

Cell[BoxData[{
 RowBox[{"\[Theta]dotf", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[CapitalEta]", ",", "k2"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"k2dotf", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]", ",", "\[Theta]"}], "]"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]dot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[CapitalEta]red", ",", "k2"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"k2dot", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]red", ",", "\[Theta]"}], "]"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.885011308711698*^9, 3.8850113108903027`*^9}, {
   3.885011451316997*^9, 3.8850114731527033`*^9}, 3.8850168152823877`*^9, {
   3.885016861505574*^9, 3.8850168631244287`*^9}, {3.885016940905403*^9, 
   3.8850169414030848`*^9}, {3.885017232706881*^9, 3.885017242750943*^9}, {
   3.8852888508405848`*^9, 3.885288856826127*^9}, {3.88528991933782*^9, 
   3.885289920830818*^9}, {3.885391636382587*^9, 3.885391638260828*^9}, {
   3.885392182448874*^9, 3.885392187643676*^9}, {3.8853929918338757`*^9, 
   3.885392996604417*^9}, {3.885393790768219*^9, 3.8853937909661913`*^9}, {
   3.885395317100081*^9, 3.88539532217572*^9}, {3.88544855440077*^9, 
   3.88544855752704*^9}, {3.885450187201968*^9, 3.885450209958601*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"6349ddba-dcf2-41c1-a24e-ce88b8bd823d"],

Cell[BoxData[{
 RowBox[{"\[Phi]dotf", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[CapitalEta]", ",", "k3"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"k3dotf", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]", ",", "\[Phi]"}], "]"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Phi]dot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"\[CapitalEta]red", ",", "k3"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"k3dot", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]red", ",", "\[Phi]"}], "]"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.885011308711698*^9, 3.8850113108903027`*^9}, {
   3.885011451316997*^9, 3.8850114731527033`*^9}, 3.8850168152823877`*^9, {
   3.885016861505574*^9, 3.8850168631244287`*^9}, {3.885016940905403*^9, 
   3.8850169414030848`*^9}, {3.885017232706881*^9, 3.885017242750943*^9}, {
   3.8852837745448008`*^9, 3.8852837777750998`*^9}, {3.8852888676039057`*^9, 
   3.8852888730385027`*^9}, {3.88529078531035*^9, 3.885290785507146*^9}, {
   3.885391277292238*^9, 3.8853912785151777`*^9}, {3.8853916407620993`*^9, 
   3.88539164374049*^9}, {3.885392192111733*^9, 3.8853922104977407`*^9}, {
   3.885393004684462*^9, 3.885393008841723*^9}, {3.885393708912162*^9, 
   3.885393720440785*^9}, {3.885393795515546*^9, 3.885393795747944*^9}, {
   3.8854502149414387`*^9, 3.8854502226076508`*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"487d9646-90be-4531-9f8c-97c34ecafb30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rdot", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"\[CapitalEta]red", ",", "k1"}], "]"}], "/.", "solk1"}], "//", 
     "ExpandAll"}], "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["c", "2"], "-", 
        SuperscriptBox[
         RowBox[{"u", "[", "r", "]"}], "2"]}], ")"}], ">", "0"}], "&&", 
     RowBox[{"c", ">", "0"}]}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rdot", "/.", 
    RowBox[{"solk1", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"srdot", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"%", ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["c", "2"], "-", 
         SuperscriptBox[
          RowBox[{"u", "[", "r", "]"}], "2"]}], ")"}], ">", "0"}], "&&", 
      RowBox[{"c", ">", "0"}], "&&", 
      RowBox[{"r", ">", "0"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k1dot", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"\[CapitalEta]red", ",", "r"}], "]"}], "//", "ExpandAll"}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["c", "2"], "-", 
        SuperscriptBox[
         RowBox[{"u", "[", "r", "]"}], "2"]}], ")"}], ">", "0"}], "&&", 
     RowBox[{"c", ">", "0"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.885387679963595*^9, {3.8853908404389133`*^9, 3.8853908541423893`*^9}, {
   3.885391249198538*^9, 3.885391272891295*^9}, {3.885391543888397*^9, 
   3.885391544146359*^9}, {3.885392285676669*^9, 3.885392296036046*^9}, {
   3.88539304141481*^9, 3.885393041513626*^9}, {3.885448641208527*^9, 
   3.8854486820948772`*^9}, {3.885533180803834*^9, 3.885533184516571*^9}, {
   3.885533334529541*^9, 3.885533386378474*^9}, {3.885533444453518*^9, 
   3.885533444881268*^9}, {3.885533749194618*^9, 3.885533753435403*^9}, {
   3.885533795916374*^9, 3.885533798178554*^9}, {3.885533976865687*^9, 
   3.885533977730373*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"76b8be65-f38f-477b-9601-cdadd5498b83"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]dot", "/", "rdot"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["c", "2"], "-", 
        SuperscriptBox[
         RowBox[{"u", "[", "r", "]"}], "2"]}], ")"}], ">", "0"}], "&&", 
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"r", ">", "0"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.885391289346264*^9, 3.885391328924696*^9}, {
  3.885392312832158*^9, 3.885392316315752*^9}, {3.885392906164113*^9, 
  3.885392906464746*^9}, {3.8854486917477293`*^9, 3.885448701303895*^9}, {
  3.88614827820636*^9, 3.8861482930965443`*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"7f15e4c0-0b8f-4853-bee8-7c4cdaa0432e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dtd\[Tau]", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[CapitalEta]red", ",", "\[CapitalEpsilon]"}], "]"}], "/.", 
    RowBox[{"(", "solE", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["c", "2"], "-", 
        SuperscriptBox[
         RowBox[{"u", "[", "r", "]"}], "2"]}], ")"}], ">", "0"}], "&&", 
     RowBox[{"c", ">", "0"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.885294964017777*^9, 3.885294969778471*^9}, {
   3.8852950549632683`*^9, 3.8852950550990973`*^9}, {3.885295095580987*^9, 
   3.885295142265387*^9}, {3.88529519669706*^9, 3.8852951994513474`*^9}, {
   3.8852958897995653`*^9, 3.885295890022332*^9}, {3.8852975132276993`*^9, 
   3.885297517411509*^9}, {3.885297561040135*^9, 3.885297562073461*^9}, {
   3.885297739736718*^9, 3.885297739846766*^9}, {3.885298014375496*^9, 
   3.885298016827613*^9}, {3.885299917055127*^9, 3.885299920204199*^9}, 
   3.885300541785285*^9, {3.8853006375353527`*^9, 3.885300661035994*^9}, {
   3.885301278525751*^9, 3.8853012853876247`*^9}, {3.885393100473001*^9, 
   3.885393104073482*^9}, {3.88544871230824*^9, 3.885448713829879*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"81716858-1f4b-4d6b-8bdb-fbf8a5a9c6b2"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"u", ",", "r", ",", "c"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rdot", "/", 
    RowBox[{"dtd\[Tau]", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
   RowBox[{"(", 
    RowBox[{"solk1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rtdot", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{"{", 
        RowBox[{"k3", "->", "0"}], "}"}]}], "//", "ExpandAll"}], "//", 
     "ComplexExpand"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["c", "2"], "-", 
         SuperscriptBox[
          RowBox[{"u", "[", "r", "]"}], "2"]}], ")"}], ">", "0"}], "&&", 
      RowBox[{"c", ">", "0"}], "&&", 
      RowBox[{"r", ">", "0"}], "&&", 
      RowBox[{"\[CapitalEpsilon]", ">", "0"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rtddot", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"%", ",", "r"}], "]"}], "*", 
   RowBox[{"rtdot", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.8854494698871737`*^9, 3.8854496497830057`*^9}, {
   3.885449709608075*^9, 3.8854497268548098`*^9}, {3.88544979659492*^9, 
   3.885449799055358*^9}, {3.8854498538263474`*^9, 3.885449868971057*^9}, {
   3.885449936013962*^9, 3.885450013356336*^9}, {3.88545071877779*^9, 
   3.8854507189080544`*^9}, {3.885450793651216*^9, 3.885450794115082*^9}, {
   3.885535000693385*^9, 3.885535001051708*^9}, 3.886148215985384*^9, 
   3.886148256145969*^9},
 CellLabel->
  "In[230]:=",ExpressionUUID->"cdbf91d2-e48a-4cb1-860e-83b1f1557803"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u", "[", "r_", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "c"}], 
   SqrtBox[
    RowBox[{"1", "/", "r"}]]}]}], "\n", 
 RowBox[{"<<", "MaTeX`"}], "\[IndentingNewLine]", 
 RowBox[{"svel", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"rtdot", "/", "c"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "1", ",", "10"}], "}"}], ",", 
    RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"MaTeX", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<r(t)/r_s\>\"", ",", "\"\<\\\\dot r(t)/c\>\""}], "}"}], 
      "]"}]}], ",", 
    RowBox[{"PlotLabel", "->", 
     RowBox[{
     "MaTeX", "[", "\"\<\\\\text{Schwarzschild coordinates}\>\"", "]"}]}], 
    ",", 
    RowBox[{"ImageSize", "->", "300"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sacc", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"10", 
       RowBox[{"rtddot", "/", 
        SuperscriptBox["c", "2"]}]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "1", ",", "10"}], "}"}], ",", 
    RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
    RowBox[{"PlotLabel", "->", 
     RowBox[{
     "MaTeX", "[", "\"\<\\\\phantom{\\\\text{Schwarzschild coordinates}}\>\"",
       "]"}]}], ",", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"MaTeX", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<r(t)/r_s\>\"", ",", "\"\<10\\\\ddot r(t) r_s/c^2\>\""}], 
       "}"}], "]"}]}], ",", 
    RowBox[{"ImageSize", "->", "300"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"u", ",", "r", ",", "c"}], "]"}]}], "Input",
 CellChangeTimes->{{3.885449889738673*^9, 3.885449901236451*^9}, {
  3.885449952605863*^9, 3.885450045008494*^9}, {3.885450741454214*^9, 
  3.885450751825842*^9}, {3.8854508373366013`*^9, 3.885451307066925*^9}, {
  3.885451346409542*^9, 3.8854514170102453`*^9}, {3.885533092596965*^9, 
  3.885533117376912*^9}, {3.885534774097241*^9, 3.88553484327909*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"c5bcc348-ae4b-4826-b3e8-0be576c0efb0"],

Cell[BoxData[
 RowBox[{"comp", "=", 
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gpvel", ",", "svel"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"gpacc", ",", "sacc"}], "}"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.885451449222993*^9, 3.885451466773258*^9}, {
  3.885451516663817*^9, 3.885451517585557*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"4a8b5127-1816-49c2-98d7-4222054230f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Some trivial checks", "Subsection",
 CellChangeTimes->{{3.885297198570616*^9, 3.8852972014195967`*^9}, {
  3.885450442115984*^9, 3.885450442889079*^9}, {3.885542051036425*^9, 
  3.8855420530822353`*^9}},ExpressionUUID->"e41f8026-aa86-4f5c-9a31-\
f8f42efe2b8c"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"vF", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.886153518080408*^9, 3.886153524172125*^9}},
 CellLabel->
  "In[424]:=",ExpressionUUID->"b370534e-809a-4316-9cc1-8e77ed8224e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xv", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.8850178649774647`*^9, 3.885017886144474*^9}, {
   3.88538906015312*^9, 3.885389062819461*^9}, {3.885389506041376*^9, 
   3.885389506816483*^9}, 3.8861534910125027`*^9, 3.886579585758993*^9},
 CellLabel->
  "In[432]:=",ExpressionUUID->"dbf89a79-f010-4d7a-8267-487644e5b238"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r", " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
   RowBox[{"r", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{"r", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.886579580113562*^9, 3.8865795860880213`*^9}},
 CellLabel->
  "Out[432]=",ExpressionUUID->"d703b211-1da6-43c7-924d-cda7749a68e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rhat", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Theta]hat", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"-", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Phi]hat", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.885017888241384*^9, 3.88501794101476*^9}, {
  3.885018474949514*^9, 3.885018538441503*^9}},
 CellLabel->
  "In[433]:=",ExpressionUUID->"de05f4ec-fedc-485e-b843-7cbf778caf7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8865795808791037`*^9, 3.886579586993915*^9}},
 CellLabel->
  "Out[433]=",ExpressionUUID->"aa828f75-9b83-4d16-a8d7-663cfc20c40c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{"-", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8865795808791037`*^9, 3.8865795869961452`*^9}},
 CellLabel->
  "Out[434]=",ExpressionUUID->"021540c3-a871-4eed-a71c-1766fb57e8ea"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8865795808791037`*^9, 3.8865795869984426`*^9}},
 CellLabel->
  "Out[435]=",ExpressionUUID->"3bfbe831-d2cc-4c89-bc5f-ee18eb236c0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xv", ".", "rhat"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xv", ".", "\[Theta]hat"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xv", ".", "\[Phi]hat"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.885389508685186*^9, 3.885389527875217*^9}},
 CellLabel->
  "In[436]:=",ExpressionUUID->"6d79c925-6779-4d8b-ae21-c382ab8c603a"],

Cell[BoxData["r"], "Output",
 CellChangeTimes->{{3.886579582078628*^9, 3.886579587540103*^9}},
 CellLabel->
  "Out[436]=",ExpressionUUID->"fabdc778-a8db-4032-9bd5-0e3003ba4410"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886579582078628*^9, 3.886579587542285*^9}},
 CellLabel->
  "Out[437]=",ExpressionUUID->"b0e04f59-d03a-4535-9c4b-0b93fffb4816"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886579582078628*^9, 3.886579587544647*^9}},
 CellLabel->
  "Out[438]=",ExpressionUUID->"318217f8-3a61-40a6-b9b4-702fc2519de3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], "/.", 
  RowBox[{"First", "[", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kr", "==", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ".", "rhat"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"k\[Theta]", "==", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ".", 
          "\[Theta]hat"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"k\[Phi]", "==", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ".", 
          "\[Phi]hat"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.88501790999944*^9, 3.88501794465125*^9}, {
  3.885018432216406*^9, 3.885018471582732*^9}, {3.885018544409938*^9, 
  3.885018545998893*^9}, {3.8850185760960913`*^9, 3.885018581460936*^9}, {
  3.885389083161075*^9, 3.8853891348182173`*^9}, {3.8853892042112226`*^9, 
  3.885389226943012*^9}, {3.885389593868718*^9, 3.885389594091193*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"076f2d7c-ea22-4086-b931-b87da631c12e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"f", " ", 
         SuperscriptBox["kr", "2"]}], "+", 
        SuperscriptBox["k\[Phi]", "2"]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kr", "->", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ".", "rhat"}]}], ",", 
         RowBox[{"k\[Theta]", "->", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ".", 
           "\[Theta]hat"}]}], ",", 
         RowBox[{"k\[Phi]", "->", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"kx", ",", "ky", ",", "kz"}], "}"}], ".", 
           "\[Phi]hat"}]}]}], "}"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", "->", 
       RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], ")"}], "//", "TrigExpand"}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.885018547639824*^9, 3.885018567891005*^9}, {
  3.886153562561101*^9, 3.8861536692152348`*^9}, {3.886153740156625*^9, 
  3.886153742974682*^9}, {3.886153807165214*^9, 3.886153836457111*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"ecdb54b1-b585-4c07-86ea-4b04f4b6c840"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kx", "2"], "+", 
     SuperscriptBox["ky", "2"]}], ")"}], "+", 
   RowBox[{"f", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["kx", "2"]}], "+", 
      SuperscriptBox["ky", "2"]}], ")"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "-", 
   RowBox[{"2", " ", "f", " ", "kx", " ", "ky", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], "//", "FullSimplify"}]], "Input",\

 CellChangeTimes->{{3.88615377311302*^9, 3.886153793915654*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"8cf4d54e-47a0-467f-a2a9-75bf3d0a8b22"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["k\[Phi]", "2"], "+", 
  RowBox[{"(", "1", ")"}]}]], "Input",
 CellChangeTimes->{{3.886153539697921*^9, 
  3.886153544843378*^9}},ExpressionUUID->"a9d64901-2bca-45dc-af30-\
077d6c5912c9"],

Cell[BoxData[{
 RowBox[{"rpl", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Theta]", "->", 
     RowBox[{"\[Pi]", "/", "4"}]}], ",", 
    RowBox[{"\[Phi]", "->", 
     RowBox[{"\[Pi]", "/", "4"}]}], ",", 
    RowBox[{"r", "->", "1"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"Tube", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"x", "+", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "/.", "rpl"}], 
           "]"}], "]"}]}], "}"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"rhat", ",", "\[Theta]hat", ",", "\[Phi]hat"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Blue", ",", "Green"}], "}"}]}], "}"}], 
        "\[Transpose]"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{"Tube", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "x"}], "}"}], "/.",
           "rpl"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
       RowBox[{"Sphere", "[", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"ViewPoint", "->", "Front"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8850186889378242`*^9, 3.885019244731814*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"99c42b1f-b885-4473-aae2-baa54be173e3"],

Cell[BoxData[
 RowBox[{"Eigensystem", "[", 
  RowBox[{
   RowBox[{"vF", "[", "r", "]"}], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "[", "i", "]"}], 
      RowBox[{"PauliMatrix", "[", "i", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.885548792842345*^9, 3.885548792999558*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"b1692207-09b6-4f80-820d-fb7cf63d860f"],

Cell[BoxData[
 RowBox[{"Eigensystem", "[", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"vF", "[", "r", "]"}], 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"k", "[", "i", "]"}], 
      RowBox[{"PauliMatrix", "[", "i", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8855361895528727`*^9, 3.8855362125286837`*^9}, {
  3.8855487831489*^9, 3.8855487835519238`*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"b30e7c86-e48e-45c1-b5aa-db76f1499431"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.886494845085519*^9},ExpressionUUID->"03a98035-dd80-4ab3-af6e-\
e78c5f12b176"]
}, Open  ]]
},
WindowSize->{960, 1027},
WindowMargins->{{Automatic, 0}, {Automatic, -180}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"aaa97b42-3b61-4739-b0e5-a2e6b890f1e5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 259, 4, 54, "Subsection",ExpressionUUID->"988f28cf-0eb9-4384-bfb7-c3023488300b"],
Cell[842, 28, 919, 27, 94, "Input",ExpressionUUID->"9b8bd884-b4e1-46eb-a6a6-1b193db15148"],
Cell[1764, 57, 3492, 101, 152, "Input",ExpressionUUID->"e93c3905-82c0-409f-9438-4a8e7c604c42"],
Cell[5259, 160, 1344, 34, 73, "Input",ExpressionUUID->"9482ef13-e370-42fb-82ec-383f99afe1b0"],
Cell[6606, 196, 942, 21, 73, "Input",ExpressionUUID->"0629c7fb-7290-4df6-871f-c61eda054c78"],
Cell[7551, 219, 540, 12, 30, "Input",ExpressionUUID->"3e8a04f5-62b3-4e57-b192-e3aafa0229b3"],
Cell[8094, 233, 717, 15, 52, "Input",ExpressionUUID->"3d27c896-919f-44d7-bc72-1f0b51cb28cc"],
Cell[8814, 250, 561, 14, 52, "Input",ExpressionUUID->"eaa74705-0b90-46f4-b2c1-156a54ef4165"],
Cell[9378, 266, 257, 6, 30, "Input",ExpressionUUID->"6c5aa7f8-db71-4c2a-864e-aee8551f9164"],
Cell[9638, 274, 2794, 62, 112, "Input",ExpressionUUID->"8c319ae8-56b3-4763-88b2-2ba132f2f622"],
Cell[12435, 338, 893, 20, 52, "Input",ExpressionUUID->"d0d45d1f-cf82-4c4a-8f89-ed55812e12ab"],
Cell[13331, 360, 1077, 22, 52, "Input",ExpressionUUID->"0becaf95-b6fd-4fbf-8e1e-6c8ad3237697"],
Cell[14411, 384, 1183, 23, 52, "Input",ExpressionUUID->"3bc5dce5-814b-4d16-9bdf-21cee14dacf8"],
Cell[15597, 409, 1368, 23, 52, "Input",ExpressionUUID->"aa893a83-90ba-458f-88d2-192a9fbc10da"],
Cell[16968, 434, 1644, 42, 96, "Input",ExpressionUUID->"baff83e5-e910-45c3-ae8b-a1a0ab92f091"],
Cell[18615, 478, 342, 7, 30, "Input",ExpressionUUID->"b2ea0232-3bd0-4fa6-93b2-41235399ae0a"],
Cell[18960, 487, 1004, 18, 30, "Input",ExpressionUUID->"1da71078-5083-40bb-ae9d-612dabdaa914"],
Cell[19967, 507, 1491, 43, 96, "Input",ExpressionUUID->"d7e22302-d986-41a0-b414-062846ba0a98"],
Cell[21461, 552, 2299, 58, 205, "Input",ExpressionUUID->"cb10ada6-a732-4234-b47e-a76cae928814"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23797, 615, 178, 3, 54, "Subsection",ExpressionUUID->"6cad944a-0483-47b8-8adb-079438813493"],
Cell[23978, 620, 1781, 45, 92, "Input",ExpressionUUID->"77dbed02-cf61-4b10-be5b-a7501440c3af"],
Cell[25762, 667, 540, 12, 30, "Input",ExpressionUUID->"a021cfa6-149d-432c-b5ee-400bb4bb2e1b"],
Cell[26305, 681, 676, 16, 33, "Input",ExpressionUUID->"3dd77467-6645-4ad1-921e-9a4253f58d89"],
Cell[26984, 699, 561, 14, 52, "Input",ExpressionUUID->"0c3828a1-109d-4cfa-a694-311c23329c56"],
Cell[27548, 715, 345, 8, 30, "Input",ExpressionUUID->"02212ed3-3190-4520-97ca-d9794cff9a08"],
Cell[27896, 725, 2276, 47, 91, "Input",ExpressionUUID->"2a0328d7-1277-4370-8d3e-9a495e59f5b5"],
Cell[30175, 774, 1167, 27, 73, "Input",ExpressionUUID->"e0268ff2-ec19-460a-b665-76f608fa468c"],
Cell[31345, 803, 863, 22, 33, "Input",ExpressionUUID->"9fba444a-91dd-4056-87b7-c97fef358478"],
Cell[32211, 827, 1249, 39, 89, "Input",ExpressionUUID->"09cf2fa6-a197-449c-9714-4c866c425ac2"],
Cell[33463, 868, 1532, 34, 94, "Input",ExpressionUUID->"6349ddba-dcf2-41c1-a24e-ce88b8bd823d"],
Cell[34998, 904, 1588, 35, 94, "Input",ExpressionUUID->"487d9646-90be-4531-9f8c-97c34ecafb30"],
Cell[36589, 941, 2494, 68, 142, "Input",ExpressionUUID->"76b8be65-f38f-477b-9601-cdadd5498b83"],
Cell[39086, 1011, 814, 20, 54, "Input",ExpressionUUID->"7f15e4c0-0b8f-4853-bee8-7c4cdaa0432e"],
Cell[39903, 1033, 1386, 29, 54, "Input",ExpressionUUID->"81716858-1f4b-4d6b-8bdb-fbf8a5a9c6b2"],
Cell[41292, 1064, 1784, 47, 140, "Input",ExpressionUUID->"cdbf91d2-e48a-4cb1-860e-83b1f1557803"],
Cell[43079, 1113, 2149, 55, 205, "Input",ExpressionUUID->"c5bcc348-ae4b-4826-b3e8-0be576c0efb0"],
Cell[45231, 1170, 458, 12, 30, "Input",ExpressionUUID->"4a8b5127-1816-49c2-98d7-4222054230f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45726, 1187, 266, 4, 54, "Subsection",ExpressionUUID->"e41f8026-aa86-4f5c-9a31-f8f42efe2b8c"],
Cell[45995, 1193, 231, 5, 30, "Input",ExpressionUUID->"b370534e-809a-4316-9cc1-8e77ed8224e4"],
Cell[CellGroupData[{
Cell[46251, 1202, 776, 19, 30, "Input",ExpressionUUID->"dbf89a79-f010-4d7a-8267-487644e5b238"],
Cell[47030, 1223, 517, 13, 34, "Output",ExpressionUUID->"d703b211-1da6-43c7-924d-cda7749a68e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47584, 1241, 1130, 32, 73, "Input",ExpressionUUID->"de05f4ec-fedc-485e-b843-7cbf778caf7d"],
Cell[48717, 1275, 472, 12, 34, "Output",ExpressionUUID->"aa828f75-9b83-4d16-a8d7-663cfc20c40c"],
Cell[49192, 1289, 494, 13, 34, "Output",ExpressionUUID->"021540c3-a871-4eed-a71c-1766fb57e8ea"],
Cell[49689, 1304, 328, 8, 34, "Output",ExpressionUUID->"3bfbe831-d2cc-4c89-bc5f-ee18eb236c0e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50054, 1317, 435, 11, 73, "Input",ExpressionUUID->"6d79c925-6779-4d8b-ae21-c382ab8c603a"],
Cell[50492, 1330, 177, 3, 34, "Output",ExpressionUUID->"fabdc778-a8db-4032-9bd5-0e3003ba4410"],
Cell[50672, 1335, 177, 3, 34, "Output",ExpressionUUID->"b0e04f59-d03a-4535-9c4b-0b93fffb4816"],
Cell[50852, 1340, 177, 3, 34, "Output",ExpressionUUID->"318217f8-3a61-40a6-b9b4-702fc2519de3"]
}, Open  ]],
Cell[51044, 1346, 1384, 34, 115, "Input",ExpressionUUID->"076f2d7c-ea22-4086-b931-b87da631c12e"],
Cell[52431, 1382, 1261, 35, 54, "Input",ExpressionUUID->"ecdb54b1-b585-4c07-86ea-4b04f4b6c840"],
Cell[53695, 1419, 697, 21, 33, "Input",ExpressionUUID->"8cf4d54e-47a0-467f-a2a9-75bf3d0a8b22"],
Cell[54395, 1442, 228, 6, 30, "Input",ExpressionUUID->"a9d64901-2bca-45dc-af30-077d6c5912c9"],
Cell[54626, 1450, 1826, 54, 73, "Input",ExpressionUUID->"99c42b1f-b885-4473-aae2-baa54be173e3"],
Cell[56455, 1506, 465, 13, 30, "Input",ExpressionUUID->"b1692207-09b6-4f80-820d-fb7cf63d860f"],
Cell[56923, 1521, 540, 14, 30, "Input",ExpressionUUID->"b30e7c86-e48e-45c1-b5aa-db76f1499431"],
Cell[57466, 1537, 147, 3, 52, "Input",ExpressionUUID->"03a98035-dd80-4ab3-af6e-e78c5f12b176"]
}, Open  ]]
}
]
*)

