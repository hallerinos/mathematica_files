(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    100747,       2757]
NotebookOptionsPosition[     94728,       2658]
NotebookOutlinePosition[     95127,       2674]
CellTagsIndexPosition[     95084,       2671]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "a", ",", "\[Delta]a1", ",", "\[Delta]a2", ",", "L1", ",", "L2", ",", "dom",
    ",", "a1", ",", "a2", ",", "a3", ",", "as", ",", "bs", ",", "uc", ",", 
   "t1", ",", "t2", ",", "tnnn", ",", "ts", ",", "tnnns", ",", "tnnnpr"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Delta]a1", ",", "\[Delta]a2"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.0", ",", "0.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Delta]a1", ",", "\[Delta]a2"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Delta]a1", ",", "\[Delta]a2"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "0.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dtda1", ",", "dtda2"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], "/", "3"}], "*", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"L1", ",", "L2"}], "}"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"12", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "+", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dom", "=", 
    RowBox[{"{", 
     RowBox[{"4.2", ",", "4.5"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a", "-", "\[Delta]a1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SqrtBox["3"], "/", "2"}], 
      RowBox[{"(", 
       RowBox[{"a", "-", "\[Delta]a2"}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "a"}], "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a3", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox["3"]}], "/", "2"}], 
      RowBox[{"(", 
       RowBox[{"a", "-", "\[Delta]a2"}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "a"}], "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"as", ":=", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bs", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a2", "-", "a3"}], ",", 
     RowBox[{"a3", "-", "a1"}], ",", 
     RowBox[{"a1", "-", "a2"}], ",", 
     RowBox[{"a1", "-", "a3"}], ",", 
     RowBox[{"a2", "-", "a1"}], ",", 
     RowBox[{"a3", "-", "a2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uc", " ", ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "a2"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"styles", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"Dashed", ",", "Dotted"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nas", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "#", "]"}], "&"}], "/@", "as"}], "]"}], ",", 
     "Greater"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbs", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "#", "]"}], "&"}], "/@", "bs"}], "]"}], ",", 
     "Greater"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"styles", " ", "=", " ", 
    RowBox[{"styles", "[", 
     RowBox[{"[", 
      RowBox[{";;", 
       RowBox[{"Length", "[", "nas", "]"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latt", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"n1", "*", 
            RowBox[{"bs", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "+", 
           RowBox[{"n2", "*", 
            RowBox[{"bs", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", 
           RowBox[{"uc", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "i"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n1", ",", "L1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"n2", ",", "L2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}]}], "]"}], ",", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orig", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"IntegerPart", "[", 
      RowBox[{"L2", "/", "2"}], "]"}], "*", 
     RowBox[{"bs", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"IntegerPart", "[", 
      RowBox[{"L1", "/", "2"}], "]"}], 
     RowBox[{"bs", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"domain", "=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"orig", "-", "dom", "+", 
      RowBox[{"{", 
       RowBox[{"1.4", ",", "1"}], "}"}]}], ",", 
     RowBox[{"orig", "+", "dom", "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "0.5"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RegionMember", "[", 
      RowBox[{"domain", ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", "latt"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latt", "=", 
    RowBox[{"Pick", "[", 
     RowBox[{"latt", ",", "test"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"213", ",", "177", ",", "119"}], "}"}], "/", "255"}]}], ";", 
  RowBox[{"c2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"132", ",", "180", ",", "185"}], "}"}], "/", "255"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"color", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RGBColor", "[", 
       RowBox[{"Sequence", "@@", "c1"}], "]"}], ",", 
      RowBox[{"RGBColor", "[", 
       RowBox[{"Sequence", "@@", "c2"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graph", "=", 
   RowBox[{"NearestNeighborGraph", "[", 
    RowBox[{
     RowBox[{"latt", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"1.01", "a"}]}], "}"}], ",", 
     RowBox[{"EdgeStyle", "->", "Black"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lattice", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"color", "[", 
         RowBox[{"[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0.2"}], "]"}]}], "}"}], 
      "&"}], "/@", "latt"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nnVecs", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"Circle", "[", 
           RowBox[{"orig", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nas", ",", "styles"}], "}"}], "\[Transpose]"}], ")"}]}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{"orig", ",", 
           RowBox[{"orig", "+", "#"}]}], "}"}], "]"}], "&"}], "/@", "as"}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nnnVecs", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"Circle", "[", 
           RowBox[{"orig", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nbs", ",", "styles"}], "}"}], "\[Transpose]"}], ")"}]}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{"orig", ",", 
           RowBox[{"orig", "+", "#"}]}], "}"}], "]"}], "&"}], "/@", "bs"}]}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"graph", ",", "lattice", ",", "nnVecs", ",", "nnnVecs"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.890384543515416*^9, 3.8903845683820457`*^9}, {
   3.890384613830944*^9, 3.890384613935902*^9}, {3.890384645031761*^9, 
   3.890384718982173*^9}, {3.8903847520733547`*^9, 3.890384778396982*^9}, {
   3.890384819004445*^9, 3.890384845660028*^9}, {3.890385103991968*^9, 
   3.8903851096307783`*^9}, {3.8903851401715612`*^9, 3.890385161382433*^9}, {
   3.890385193753572*^9, 3.890385216193288*^9}, {3.890480353289768*^9, 
   3.8904803550868464`*^9}, {3.890480423353634*^9, 3.890480470804882*^9}, {
   3.8904805903725767`*^9, 3.890480604136467*^9}, {3.890480650370914*^9, 
   3.8904806523849697`*^9}, {3.890480683296894*^9, 3.890480818027876*^9}, {
   3.890480874773406*^9, 3.8904809086760387`*^9}, {3.890532934855267*^9, 
   3.890532985224992*^9}, {3.8905335666690893`*^9, 3.8905336128049994`*^9}, {
   3.8905336558557177`*^9, 3.8905337092682734`*^9}, {3.890533771202409*^9, 
   3.8905338807370977`*^9}, {3.890533937918045*^9, 3.890534024402892*^9}, {
   3.890534060345656*^9, 3.890534122910659*^9}, {3.890534172621449*^9, 
   3.8905342497041597`*^9}, {3.890534289093459*^9, 3.890534335282543*^9}, {
   3.890534408185671*^9, 3.8905346746149197`*^9}, {3.890534708273978*^9, 
   3.890534849462294*^9}, {3.890534881100032*^9, 3.890535237670186*^9}, {
   3.890535423898889*^9, 3.890535429415915*^9}, {3.8905361795614*^9, 
   3.890536333479537*^9}, {3.8905365104666224`*^9, 3.890536510671476*^9}, {
   3.890536564557798*^9, 3.890536632634453*^9}, {3.89053668562843*^9, 
   3.890536785346469*^9}, {3.890536821985272*^9, 3.890537064236339*^9}, {
   3.890537130930208*^9, 3.8905371449073353`*^9}, {3.890537177849381*^9, 
   3.890537305620625*^9}, {3.890537346093527*^9, 3.8905373741445513`*^9}, {
   3.8905374152709084`*^9, 3.890537431806633*^9}, {3.8905374652557783`*^9, 
   3.8905376193413486`*^9}, {3.890537712176321*^9, 3.890537859607986*^9}, {
   3.890616111615755*^9, 3.890616239872733*^9}, {3.890616852720598*^9, 
   3.890616859905127*^9}, {3.890617044192483*^9, 3.890617044281838*^9}, {
   3.8906171431319313`*^9, 3.8906171522504253`*^9}, {3.890617195391571*^9, 
   3.890617252061982*^9}, {3.890617537357038*^9, 3.890617630924358*^9}, {
   3.890617678177466*^9, 3.890617824512308*^9}, {3.890617864186673*^9, 
   3.89061791933076*^9}, {3.890618303475668*^9, 3.8906183038036118`*^9}, {
   3.890618337405724*^9, 3.890618576529306*^9}, {3.890618625700345*^9, 
   3.8906186313678837`*^9}, {3.890619003058667*^9, 3.8906190032986383`*^9}, {
   3.8906192222026787`*^9, 3.890619241939702*^9}, {3.890619284120927*^9, 
   3.890619293533018*^9}, {3.8906196523300257`*^9, 3.89061966471798*^9}, {
   3.890619716319724*^9, 3.890619733744911*^9}, {3.890619956823277*^9, 
   3.890619957149012*^9}, {3.890619991863571*^9, 3.890619992414084*^9}, {
   3.890620076857396*^9, 3.8906201385091*^9}, {3.890620189122547*^9, 
   3.890620191577546*^9}, {3.890620227280015*^9, 3.8906202626784077`*^9}, {
   3.89062033946836*^9, 3.890620341787217*^9}, {3.890620382410252*^9, 
   3.89062039161576*^9}, 3.8906517222513323`*^9, {3.8906517656279984`*^9, 
   3.890651774595428*^9}, {3.890652521633583*^9, 3.890652521962104*^9}, {
   3.890652598640526*^9, 3.890652613490484*^9}, {3.890652657952777*^9, 
   3.890652669440445*^9}, {3.890652845297668*^9, 3.890653014764244*^9}, {
   3.890653190206126*^9, 3.8906532311993723`*^9}, {3.890653262988594*^9, 
   3.8906532727082987`*^9}, {3.890653313367003*^9, 3.890653591468947*^9}, 
   3.890653655933703*^9, 3.890653707826044*^9, {3.890653785812893*^9, 
   3.890653787128166*^9}, 3.8906538483635406`*^9, {3.890654119625662*^9, 
   3.890654227983852*^9}, {3.89065426686552*^9, 3.8906542740167217`*^9}, 
   3.8906543395508413`*^9, {3.890654373541738*^9, 3.890654380138818*^9}, {
   3.89065442781822*^9, 3.8906547114442*^9}, {3.890654745821576*^9, 
   3.890654789295743*^9}, {3.8906554774606943`*^9, 3.8906555244735928`*^9}, {
   3.890656117109153*^9, 3.890656128287286*^9}},
 CellLabel->
  "In[6199]:=",ExpressionUUID->"00e4702b-2c65-412d-86b2-8482e5759209"],

Cell[BoxData[
 GraphicsBox[{GraphicsComplexBox[CompressedData["
1:eJxdkLELQVEUxm8yvEIGmSUSCoWS6b3IoiwGfwCZLfZnsFmsNruVTd7ZvEHC
rFiZbQw873y37j310ul8vu/33WR/1B0GhBD53+f9Wr1Bq11IULXiTdQyeT/8
52U+S7VzuJuk438Pyru/C2uz3trjSIrK/H/o/T2k+zm4Cx7c/e3uwO+k5S8X
3jzMSb1RvLpp9gvK/APztHf7a3OakX1s1leZR+tDah+DtHzJ6+8fB/nghx78
yHeZH/lz5o83O7OVmZX80IP/vr/UY++c5Ice/Fp/UvsbpOU7yHeZH37ghx78
yMf7Q4/3vyl3YWl9SO1jkOYn8/Ge8EO+6m/QF6zwSto=
    "], {
     {GrayLevel[0], Opacity[0.7], Arrowheads[0.], 
      ArrowBox[{{1, 6}, {2, 4}, {2, 11}, {3, 4}, {3, 6}, {3, 13}, {5, 6}, {5, 
       15}, {7, 9}, {7, 19}, {8, 9}, {8, 11}, {8, 21}, {10, 11}, {10, 13}, {
       10, 23}, {12, 13}, {12, 15}, {12, 25}, {14, 15}, {14, 27}, {16, 17}, {
       16, 19}, {16, 29}, {18, 19}, {18, 21}, {18, 31}, {20, 21}, {20, 23}, {
       20, 33}, {22, 23}, {22, 25}, {22, 35}, {24, 25}, {24, 27}, {24, 36}, {
       26, 27}, {28, 29}, {28, 31}, {28, 38}, {30, 31}, {30, 33}, {30, 40}, {
       32, 33}, {32, 35}, {32, 41}, {34, 35}, {34, 36}, {37, 38}, {37, 40}, {
       37, 42}, {39, 40}, {39, 41}}, 0.053381642512077304`]}, 
     {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
      DiskBox[1, 0.053381642512077304], DiskBox[2, 0.053381642512077304], 
      DiskBox[3, 0.053381642512077304], DiskBox[4, 0.053381642512077304], 
      DiskBox[5, 0.053381642512077304], DiskBox[6, 0.053381642512077304], 
      DiskBox[7, 0.053381642512077304], DiskBox[8, 0.053381642512077304], 
      DiskBox[9, 0.053381642512077304], DiskBox[10, 0.053381642512077304], 
      DiskBox[11, 0.053381642512077304], DiskBox[12, 0.053381642512077304], 
      DiskBox[13, 0.053381642512077304], DiskBox[14, 0.053381642512077304], 
      DiskBox[15, 0.053381642512077304], DiskBox[16, 0.053381642512077304], 
      DiskBox[17, 0.053381642512077304], DiskBox[18, 0.053381642512077304], 
      DiskBox[19, 0.053381642512077304], DiskBox[20, 0.053381642512077304], 
      DiskBox[21, 0.053381642512077304], DiskBox[22, 0.053381642512077304], 
      DiskBox[23, 0.053381642512077304], DiskBox[24, 0.053381642512077304], 
      DiskBox[25, 0.053381642512077304], DiskBox[26, 0.053381642512077304], 
      DiskBox[27, 0.053381642512077304], DiskBox[28, 0.053381642512077304], 
      DiskBox[29, 0.053381642512077304], DiskBox[30, 0.053381642512077304], 
      DiskBox[31, 0.053381642512077304], DiskBox[32, 0.053381642512077304], 
      DiskBox[33, 0.053381642512077304], DiskBox[34, 0.053381642512077304], 
      DiskBox[35, 0.053381642512077304], DiskBox[36, 0.053381642512077304], 
      DiskBox[37, 0.053381642512077304], DiskBox[38, 0.053381642512077304], 
      DiskBox[39, 0.053381642512077304], DiskBox[40, 0.053381642512077304], 
      DiskBox[41, 0.053381642512077304], 
      DiskBox[42, 0.053381642512077304]}}], {
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-7.794228634059948, 3.9000000000000004}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-7.794228634059947, 1.2999999999999998}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-8.660254037844386, 2.6000000000000005}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-7.794228634059947, 2.1000000000000005}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-9.526279441628825, 3.8999999999999995}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-8.660254037844386, 3.3999999999999995}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-7.794228634059947, -1.2999999999999998}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-8.660254037844386, 0.}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-7.794228634059947, -0.5}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-9.526279441628825, 1.3000000000000007}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-8.660254037844386, 0.8000000000000007}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-10.392304845413264, 2.5999999999999996}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-9.526279441628825, 2.0999999999999996}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-11.258330249197702, 3.9000000000000004}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-10.392304845413262, 3.4000000000000004}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-8.660254037844386, -2.6000000000000005}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-7.794228634059947, -3.1000000000000005}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-9.526279441628825, -1.3000000000000007}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-8.660254037844386, -1.8000000000000007}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-10.392304845413264, 0.}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-9.526279441628825, -0.5}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-11.258330249197702, 1.299999999999999}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-10.392304845413262, 0.7999999999999989}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-12.12435565298214, 2.5999999999999996}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-11.258330249197702, 2.0999999999999996}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-12.99038105676658, 3.9000000000000004}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-12.12435565298214, 3.4000000000000004}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-10.392304845413264, -2.5999999999999996}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-9.526279441628825, -3.0999999999999996}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-11.258330249197702, -1.299999999999999}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-10.392304845413262, -1.799999999999999}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-12.12435565298214, 0.}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-11.258330249197702, -0.5}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-12.99038105676658, 1.3000000000000007}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-12.12435565298214, 0.8000000000000007}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-12.990381056766578, 2.1000000000000014}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-12.12435565298214, -2.5999999999999996}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-11.258330249197702, -3.0999999999999996}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[71, 85], 0.8352941176470589], 
      NCache[
       Rational[59, 85], 0.6941176470588235], 
      NCache[
       Rational[7, 15], 0.4666666666666667]], 
     DiskBox[{-12.99038105676658, -1.3000000000000007}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-12.12435565298214, -1.8000000000000007}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-12.990381056766578, -0.5}, 0.2]}, 
    {RGBColor[
      NCache[
       Rational[44, 85], 0.5176470588235295], 
      NCache[
       Rational[12, 17], 0.7058823529411765], 
      NCache[
       Rational[37, 51], 0.7254901960784313]], 
     DiskBox[{-12.990381056766578, -3.1000000000000014}, 0.2]}}, {{
     {Dashing[{Small, Small}], CircleBox[{-10.392304845413264, 0.}, 1.]}, 
     {Dashing[{0, Small}], CircleBox[{-10.392304845413264, 0.}, 0.8]}}, {
     ArrowBox[{{-10.392304845413264`, 0.}, {-10.392304845413264`, 0.8}}], 
     ArrowBox[{{-10.392304845413264`, 0.}, {-9.526279441628825, -0.5}}], 
     ArrowBox[{{-10.392304845413264`, 0.}, {-11.258330249197703`, -0.5}}]}}, {{
     {Dashing[{Small, Small}], 
      CircleBox[{-10.392304845413264, 0.}, 1.7320508075688772]}, 
     {Dashing[{0, Small}], 
      CircleBox[{-10.392304845413264, 0.}, 1.562049935181331]}}, {
     ArrowBox[{{-10.392304845413264`, 0.}, {-8.660254037844387, 0.}}], 
     ArrowBox[{{-10.392304845413264`, 0.}, {-11.258330249197703`, -1.3}}], 
     ArrowBox[{{-10.392304845413264`, 0.}, {-11.258330249197703`, 1.3}}], 
     ArrowBox[{{-10.392304845413264`, 0.}, {-9.526279441628825, 1.3}}], 
     ArrowBox[{{-10.392304845413264`, 0.}, {-9.526279441628825, -1.3}}], 
     ArrowBox[{{-10.392304845413264`, 0.}, {-12.12435565298214, 0.}}]}}},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{
  3.890651729436255*^9, 3.8906517751803923`*^9, 3.890652522568565*^9, 
   3.890652613925069*^9, 3.890652670285005*^9, {3.89065284617313*^9, 
   3.8906529630373*^9}, {3.890653005608407*^9, 3.8906530152033577`*^9}, {
   3.8906531978174047`*^9, 3.890653231843639*^9}, {3.890653266280527*^9, 
   3.890653273211337*^9}, {3.890653400194354*^9, 3.89065346644095*^9}, {
   3.890653499905105*^9, 3.8906535921275587`*^9}, 3.8906536566693077`*^9, 
   3.890653708277926*^9, 3.890653787695486*^9, 3.890653849197647*^9, {
   3.890654120163714*^9, 3.89065422815084*^9}, {3.8906542680958643`*^9, 
   3.890654271320269*^9}, {3.89065434087009*^9, 3.890654380711315*^9}, {
   3.890654431924205*^9, 3.890654711869109*^9}, {3.8906547485259857`*^9, 
   3.890654789487276*^9}, {3.8906554783750277`*^9, 3.890655525007023*^9}, 
   3.890655606969387*^9, {3.890656117710099*^9, 3.89065612920931*^9}},
 CellLabel->
  "Out[6228]=",ExpressionUUID->"c831fe2f-6f38-4ae8-bb03-bcdcf76ec378"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"a", ",", "\[Delta]a1", ",", "\[Delta]a2"}], "]"}]], "Input",
 CellChangeTimes->{{3.890655609743853*^9, 3.8906556134777308`*^9}, {
  3.890655681290389*^9, 3.8906556818884077`*^9}},
 CellLabel->
  "In[6300]:=",ExpressionUUID->"d5ee9abd-dd6f-42cb-88a5-eb38f3b11d64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]a1", "=", "\[Delta]a"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]a2", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8906566602107677`*^9, 3.8906566724106693`*^9}, 
   3.89065807562823*^9},
 CellLabel->
  "In[6301]:=",ExpressionUUID->"a17df307-4eb2-4edd-9ad8-564787bd7ab9"],

Cell[CellGroupData[{

Cell[BoxData[{"as", "\[IndentingNewLine]", "bs"}], "Input",
 CellChangeTimes->{{3.890655616271969*^9, 3.8906556164298353`*^9}, {
  3.890656814591758*^9, 3.890656815103755*^9}},
 CellLabel->
  "In[6303]:=",ExpressionUUID->"9765244e-0c72-4a01-b0b4-a615fb26a4dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"a", "-", "\[Delta]a"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SqrtBox["3"], " ", "a"}], "2"], ",", 
     RowBox[{"-", 
      FractionBox["a", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox["3"], " ", "a"}], "2"]}], ",", 
     RowBox[{"-", 
      FractionBox["a", "2"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.890655616933895*^9, 3.89065568622143*^9, 
  3.8906566200328836`*^9, 3.89065667459978*^9, 3.890656815318912*^9, 
  3.8906580797911*^9},
 CellLabel->
  "Out[6303]=",ExpressionUUID->"9310be0a-646c-47b0-b955-687e090cc6b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SqrtBox["3"], " ", "a"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox["3"], " ", "a"}], "2"]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "a"}], "2"]}], "+", "\[Delta]a"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SqrtBox["3"], " ", "a"}], "2"]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"3", " ", "a"}], "2"], "-", "\[Delta]a"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SqrtBox["3"], " ", "a"}], "2"], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"3", " ", "a"}], "2"], "-", "\[Delta]a"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SqrtBox["3"], " ", "a"}], "2"], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "a"}], "2"]}], "+", "\[Delta]a"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SqrtBox["3"]}], " ", "a"}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.890655616933895*^9, 3.89065568622143*^9, 
  3.8906566200328836`*^9, 3.89065667459978*^9, 3.890656815318912*^9, 
  3.890658079798891*^9},
 CellLabel->
  "Out[6304]=",ExpressionUUID->"5f1cc2ea-0c50-46ab-946b-412f7a4e04ec"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<../CORE/figures/\>\""}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<quinoid2.pdf\>\"", ",", "plot"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.89065359332526*^9, 3.890653681149021*^9}, {
  3.890653714740527*^9, 3.890653718006988*^9}, {3.890654233893208*^9, 
  3.890654234040428*^9}, {3.890654721100459*^9, 3.890654721205245*^9}},
 CellLabel->
  "In[6305]:=",ExpressionUUID->"03466bea-e24b-4889-8f16-14b326e630b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "h1", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h1", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
  RowBox[{"ComplexExpand", "[", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"TrigExpand", "[", 
     RowBox[{"ComplexExpand", "[", 
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"kx", ",", "ky"}], "}"}], ".", 
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"as", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"t1", "[", "1", "]"}], ",", 
                RowBox[{"t1", "[", "2", "]"}], ",", 
                RowBox[{"t1", "[", "2", "]"}]}], "}"}]}], "}"}], 
            "\[Transpose]"}]}], "}"}]}], "]"}]}], "]"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h1", "[", 
   RowBox[{"kx", ",", "ky"}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h1", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"ky", "->", "0"}], "}"}]}], ")"}], "==", "0"}], ",", "kx"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8906204495750732`*^9, 3.8906206422345*^9}, {
   3.890620831291334*^9, 3.890620874341671*^9}, {3.890621013089446*^9, 
   3.890621014047069*^9}, {3.890651797094006*^9, 3.8906518128139067`*^9}, {
   3.8906526274998293`*^9, 3.890652627782255*^9}, {3.890653895191968*^9, 
   3.890653954199068*^9}, {3.890655414532908*^9, 3.890655450624099*^9}, {
   3.890655545515286*^9, 3.890655569484149*^9}, {3.8906556285406437`*^9, 
   3.89065562867102*^9}, {3.8906558473385057`*^9, 3.890655847394251*^9}, {
   3.890656624355255*^9, 3.890656624472815*^9}, {3.890656751167452*^9, 
   3.8906567948072987`*^9}, {3.890657168415214*^9, 3.890657169970421*^9}, 
   3.890657260420546*^9},
 CellLabel->
  "In[6306]:=",ExpressionUUID->"af2f609f-a70e-481f-8b8b-ff53311d5f29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "ky", " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "\[Delta]a"}], ")"}]}]]}], " ", 
   RowBox[{"t1", "[", "1", "]"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", "a", " ", "ky"}]], 
   " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
   RowBox[{"t1", "[", "2", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.890651740100298*^9, 3.890651813442268*^9}, 
   3.890651854615513*^9, {3.8906519131169367`*^9, 3.890651918359633*^9}, {
   3.8906525453753433`*^9, 3.890652558252034*^9}, {3.890652622217332*^9, 
   3.890652629003757*^9}, 3.890652674441819*^9, {3.890653795957287*^9, 
   3.8906538028352127`*^9}, {3.890653858509178*^9, 3.8906538689599533`*^9}, {
   3.890653920789893*^9, 3.890653955029243*^9}, 3.890655406104657*^9, {
   3.890655438735669*^9, 3.8906554515976543`*^9}, {3.8906555365976562`*^9, 
   3.890655546704582*^9}, 3.890655629394803*^9, 3.890655687982032*^9, 
   3.890655848393458*^9, {3.890656622595842*^9, 3.8906566250767813`*^9}, {
   3.890656777948291*^9, 3.890656795314221*^9}, 3.890657170659623*^9, {
   3.890657262254283*^9, 3.8906572832461367`*^9}, 3.890657469362252*^9, 
   3.8906580815221653`*^9},
 CellLabel->
  "Out[6308]=",ExpressionUUID->"e9638ed2-c2a8-46b2-a8b2-f3e996bb1907"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"kx", "\[Rule]", 
     TemplateBox[{
       FractionBox[
        RowBox[{"2", " ", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{"-", 
                RowBox[{"ArcCos", "[", 
                  RowBox[{"-", 
                    FractionBox[
                    RowBox[{"t1", "[", "1", "]"}], 
                    RowBox[{"2", " ", 
                    RowBox[{"t1", "[", "2", "]"}]}]]}], "]"}]}], "+", 
              RowBox[{"2", " ", "\[Pi]", " ", 
                TemplateBox[{"1"}, "C"]}]}], ")"}]}], 
        RowBox[{
          SqrtBox["3"], " ", "a"}]], 
       RowBox[{
         TemplateBox[{"1"}, "C"], "\[Element]", 
         TemplateBox[{}, "Integers"]}]},
      "ConditionalExpression"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"kx", "\[Rule]", 
     TemplateBox[{
       FractionBox[
        RowBox[{"2", " ", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{"ArcCos", "[", 
                RowBox[{"-", 
                  FractionBox[
                   RowBox[{"t1", "[", "1", "]"}], 
                   RowBox[{"2", " ", 
                    RowBox[{"t1", "[", "2", "]"}]}]]}], "]"}], "+", 
              RowBox[{"2", " ", "\[Pi]", " ", 
                TemplateBox[{"1"}, "C"]}]}], ")"}]}], 
        RowBox[{
          SqrtBox["3"], " ", "a"}]], 
       RowBox[{
         TemplateBox[{"1"}, "C"], "\[Element]", 
         TemplateBox[{}, "Integers"]}]},
      "ConditionalExpression"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.890651740100298*^9, 3.890651813442268*^9}, 
   3.890651854615513*^9, {3.8906519131169367`*^9, 3.890651918359633*^9}, {
   3.8906525453753433`*^9, 3.890652558252034*^9}, {3.890652622217332*^9, 
   3.890652629003757*^9}, 3.890652674441819*^9, {3.890653795957287*^9, 
   3.8906538028352127`*^9}, {3.890653858509178*^9, 3.8906538689599533`*^9}, {
   3.890653920789893*^9, 3.890653955029243*^9}, 3.890655406104657*^9, {
   3.890655438735669*^9, 3.8906554515976543`*^9}, {3.8906555365976562`*^9, 
   3.890655546704582*^9}, 3.890655629394803*^9, 3.890655687982032*^9, 
   3.890655848393458*^9, {3.890656622595842*^9, 3.8906566250767813`*^9}, {
   3.890656777948291*^9, 3.890656795314221*^9}, 3.890657170659623*^9, {
   3.890657262254283*^9, 3.8906572832461367`*^9}, 3.890657469362252*^9, 
   3.890658081617793*^9},
 CellLabel->
  "Out[6309]=",ExpressionUUID->"3b9d66a0-7d7a-499c-8fee-c1b357383bdc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "h2", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h2", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
  RowBox[{"ComplexExpand", "[", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"TrigExpand", "[", 
     RowBox[{"ComplexExpand", "[", 
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"kx", ",", "ky"}], "}"}], ".", 
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]]}], ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"bs", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"t2", "[", "1", "]"}], ",", 
                RowBox[{"t2", "[", "2", "]"}], ",", 
                RowBox[{"t2", "[", "2", "]"}], ",", 
                RowBox[{"t2", "[", "2", "]"}], ",", 
                RowBox[{"t2", "[", "2", "]"}], ",", 
                RowBox[{"t2", "[", "1", "]"}]}], "}"}]}], "}"}], 
            "\[Transpose]"}]}], "}"}]}], "]"}]}], "]"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h2", "[", 
   RowBox[{"kx", ",", "ky"}], "]"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.8906209251284733`*^9, 3.890620941870967*^9}, {
   3.890621008318817*^9, 3.890621016776723*^9}, 3.8906519000836563`*^9, {
   3.890656708054582*^9, 3.890656734974784*^9}, 3.890657281419602*^9, {
   3.89065735887819*^9, 3.8906573618197603`*^9}, {3.8906576879186707`*^9, 
   3.8906577047597237`*^9}},
 CellLabel->
  "In[6310]:=",ExpressionUUID->"de734b72-89be-4689-8cdf-1300e50ae39f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
     RowBox[{"t2", "[", "1", "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", "a", " ", "ky"}], "2"], "-", 
       RowBox[{"ky", " ", "\[Delta]a"}]}], "]"}], " ", 
     RowBox[{"t2", "[", "2", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8906577051849117`*^9, 3.890658082534697*^9},
 CellLabel->
  "Out[6312]=",ExpressionUUID->"a593f7ac-57cc-4835-badb-3f908bf889ae"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "H", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h2", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], ",", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{
        RowBox[{"h1", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "\[Conjugate]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h1", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], ",", 
      RowBox[{"h2", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}]}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.890657709849332*^9, 3.890657755622285*^9}},
 CellLabel->
  "In[6313]:=",ExpressionUUID->"cd70d5d4-35d7-4426-9625-b5a149badff6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Tr", "[", 
     RowBox[{
      RowBox[{"H", "[", 
       RowBox[{"kx", ",", "ky"}], "]"}], ".", 
      RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], "//", "Simplify"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.890657760308267*^9, 3.890657874303122*^9}, {
  3.890657918900797*^9, 3.8906579190635223`*^9}, {3.890658048468598*^9, 
  3.890658048529298*^9}, {3.89065816464461*^9, 3.8906581646887493`*^9}, {
  3.8906583087226677`*^9, 3.890658308790498*^9}},
 CellLabel->
  "In[6317]:=",ExpressionUUID->"5149ab17-cf7d-4db3-a78e-b74403d62a44"],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cos", "[", 
      RowBox[{"ky", " ", 
       RowBox[{"(", 
        RowBox[{"a", "-", "\[Delta]a"}], ")"}]}], "]"}]}], " ", 
    RowBox[{"t1", "[", "1", "]"}]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"a", " ", "ky"}], "2"], "]"}], " ", 
    RowBox[{"t1", "[", "2", "]"}]}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.890657768877111*^9, 3.890657875244223*^9}, 
   3.890657919953512*^9, 3.8906580493190517`*^9, 3.890658084504306*^9, 
   3.890658165447377*^9, 3.890658309920209*^9},
 CellLabel->
  "Out[6317]//MatrixForm=",ExpressionUUID->"005c2675-ac45-4107-b00d-\
f516c5b8ffe4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "d", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h2", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ",", 
    TagBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"ky", " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "\[Delta]a"}], ")"}]}], "]"}]}], " ", 
       RowBox[{"t1", "[", "1", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"a", " ", "ky"}], "2"], "]"}], " ", 
       RowBox[{"t1", "[", "2", "]"}]}]}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], ",", 
    TagBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         RowBox[{"ky", " ", 
          RowBox[{"(", 
           RowBox[{"a", "-", "\[Delta]a"}], ")"}]}], "]"}]}], " ", 
       RowBox[{"t1", "[", "1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"a", " ", "ky"}], "2"], "]"}], " ", 
       RowBox[{"t1", "[", "2", "]"}]}]}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.89065839498733*^9, 3.890658407021303*^9}},
 CellLabel->
  "In[6325]:=",ExpressionUUID->"224e3998-89c3-4146-a974-0706fbb484ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], ".", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "-", 
   RowBox[{"H", "[", 
    RowBox[{"kx", ",", "ky"}], "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.890658304045705*^9, 3.890658394084511*^9}},
 CellLabel->
  "In[6327]:=",ExpressionUUID->"1e3c83ae-3475-44a5-ae20-cffd30b3157b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.890658325489832*^9, 3.890658408757468*^9}},
 CellLabel->
  "Out[6327]=",ExpressionUUID->"91d5d9a5-6ca3-4810-a70f-e344b9ac1ccd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}], "]"}], "//", "ComplexExpand"}], "//",
   "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "Epm", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Epm", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"t1", "[", "1", "]"}], "2"], "+", 
    RowBox[{"4", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", "a", " ", "ky"}], "2"], "-", 
       RowBox[{"ky", " ", "\[Delta]a"}]}], "]"}], " ", 
     RowBox[{"t1", "[", "1", "]"}], " ", 
     RowBox[{"t1", "[", "2", "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SqrtBox["3"], " ", "a", " ", "kx"}], "]"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"t1", "[", "2", "]"}], "2"]}]}]]}]}], "Input",
 CellChangeTimes->{{3.890658414356306*^9, 3.890658532975128*^9}},
 CellLabel->
  "In[6338]:=",ExpressionUUID->"e43948c1-4aa8-46be-b43e-60dde023bd46"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"t1", "[", "1", "]"}], "2"], "+", 
   RowBox[{"4", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"3", " ", "a", " ", "ky"}], "2"], "-", 
      RowBox[{"ky", " ", "\[Delta]a"}]}], "]"}], " ", 
    RowBox[{"t1", "[", "1", "]"}], " ", 
    RowBox[{"t1", "[", "2", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SqrtBox["3"], " ", "a", " ", "kx"}], "]"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"t1", "[", "2", "]"}], "2"]}]}]]], "Output",
 CellChangeTimes->{{3.890658416618895*^9, 3.890658500084985*^9}, 
   3.8906585357865553`*^9},
 CellLabel->
  "Out[6338]=",ExpressionUUID->"fae75263-91d3-4478-942f-a76021df1ff3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"s1", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"kx", "\[Rule]", 
       RowBox[{"+", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"t1", "[", "1", "]"}], 
             RowBox[{"2", " ", 
              RowBox[{"t1", "[", "2", "]"}]}]]}], "]"}]}], 
         RowBox[{
          SqrtBox["3"], " ", "a"}]]}]}], "]"}], ",", 
     RowBox[{"ky", "->", "0"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"s2", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"kx", "\[Rule]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"2", " ", 
          RowBox[{"ArcCos", "[", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"t1", "[", "1", "]"}], 
             RowBox[{"2", " ", 
              RowBox[{"t1", "[", "2", "]"}]}]]}], "]"}]}], 
         RowBox[{
          SqrtBox["3"], " ", "a"}]]}]}], "]"}], ",", 
     RowBox[{"ky", "->", "0"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.890658892830312*^9, 3.890658963147973*^9}, {
  3.890659052619145*^9, 3.890659052692959*^9}},
 CellLabel->
  "In[6457]:=",ExpressionUUID->"6714563b-9200-4be3-bd9e-60164a93990c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"kx", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"t1", "[", "1", "]"}], 
         RowBox[{"2", " ", 
          RowBox[{"t1", "[", "2", "]"}]}]]}], "]"}]}], 
     RowBox[{
      SqrtBox["3"], " ", "a"}]]}], ",", 
   RowBox[{"ky", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.890658895929501*^9, 3.890658930231018*^9}, 
   3.890658963751071*^9, 3.89065905307596*^9, 3.890661060156518*^9},
 CellLabel->
  "Out[6457]=",ExpressionUUID->"b6b93dc2-7c3b-4e0e-a073-af1fe3372d44"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"kx", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"t1", "[", "1", "]"}], 
          RowBox[{"2", " ", 
           RowBox[{"t1", "[", "2", "]"}]}]]}], "]"}]}], 
      RowBox[{
       SqrtBox["3"], " ", "a"}]]}]}], ",", 
   RowBox[{"ky", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.890658895929501*^9, 3.890658930231018*^9}, 
   3.890658963751071*^9, 3.89065905307596*^9, 3.890661060164298*^9},
 CellLabel->
  "Out[6458]=",ExpressionUUID->"b0ac6a11-fe0b-456d-aa51-4d97cf0dd73a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"kx", ",", "ky"}], "]"}], "/.", "s1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"kx", ",", "ky"}], "]"}], "/.", "s2"}]}], "Input",
 CellChangeTimes->{{3.890659111569969*^9, 3.890659130965315*^9}},
 CellLabel->
  "In[6459]:=",ExpressionUUID->"8b2c6023-5ef7-48bc-8444-1c937e148de7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"t1", "[", "1", "]"}], 
          RowBox[{"2", " ", 
           RowBox[{"t1", "[", "2", "]"}]}]]}], "]"}]}], "]"}], " ", 
     RowBox[{"t2", "[", "1", "]"}]}], "+", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"t1", "[", "1", "]"}], " ", 
      RowBox[{"t2", "[", "2", "]"}]}], 
     RowBox[{"t1", "[", "2", "]"}]]}], ",", "0", ",", "0"}], "}"}]], "Output",\

 CellChangeTimes->{{3.89065911248589*^9, 3.8906591314754333`*^9}, 
   3.890661061369773*^9},
 CellLabel->
  "Out[6459]=",ExpressionUUID->"7aca5755-6ee1-410e-b227-c567f02fd8aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"t1", "[", "1", "]"}], 
          RowBox[{"2", " ", 
           RowBox[{"t1", "[", "2", "]"}]}]]}], "]"}]}], "]"}], " ", 
     RowBox[{"t2", "[", "1", "]"}]}], "+", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"t1", "[", "1", "]"}], " ", 
      RowBox[{"t2", "[", "2", "]"}]}], 
     RowBox[{"t1", "[", "2", "]"}]]}], ",", "0", ",", "0"}], "}"}]], "Output",\

 CellChangeTimes->{{3.89065911248589*^9, 3.8906591314754333`*^9}, 
   3.890661061493363*^9},
 CellLabel->
  "Out[6460]=",ExpressionUUID->"a8a9073c-e14b-4d79-9684-8d5ac90657f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"d", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], "/.", "s1"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Grad", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"kx", ",", "ky"}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"d", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}]}], ")"}], "/.", "s2"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "+", "%%"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.890658833853489*^9, 3.8906588693539057`*^9}, {
  3.8906589685490503`*^9, 3.8906589995288687`*^9}, {3.890659041009218*^9, 
  3.8906590475640507`*^9}, {3.890659147511463*^9, 3.8906591959147243`*^9}, {
  3.890659452855501*^9, 3.890659471034087*^9}},
 CellLabel->
  "In[6461]:=",ExpressionUUID->"191ff705-9add-4be7-aa29-44be357e9106"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       SqrtBox[
        RowBox[{"12", "-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"t1", "[", "1", "]"}], "2"]}], 
          SuperscriptBox[
           RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"t1", "[", "1", "]"}]}], " ", 
          RowBox[{"t2", "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"t1", "[", "2", "]"}], " ", 
          RowBox[{"t2", "[", "2", "]"}]}]}], ")"}]}], 
      RowBox[{"t1", "[", "2", "]"}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "a", " ", 
      SqrtBox[
       RowBox[{"12", "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"t1", "[", "1", "]"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
      RowBox[{"t1", "[", "2", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["3", "2"]}], " ", "a", " ", 
       RowBox[{"t1", "[", "1", "]"}]}], "+", 
      RowBox[{"\[Delta]a", " ", 
       RowBox[{"t1", "[", "1", "]"}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8906588437012243`*^9, 3.890658869871442*^9}, {
   3.890658972346282*^9, 3.890659000185004*^9}, {3.8906590481105423`*^9, 
   3.890659054041214*^9}, {3.8906591363611107`*^9, 3.89065916129145*^9}, 
   3.8906591965120564`*^9, {3.890659465545802*^9, 3.890659471362216*^9}, 
   3.8906610627883987`*^9},
 CellLabel->
  "Out[6461]=",ExpressionUUID->"f6f61725-ba3e-458c-9fb1-998349495698"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       SqrtBox[
        RowBox[{"12", "-", 
         FractionBox[
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"t1", "[", "1", "]"}], "2"]}], 
          SuperscriptBox[
           RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"t1", "[", "1", "]"}], " ", 
          RowBox[{"t2", "[", "1", "]"}]}], "-", 
         RowBox[{
          RowBox[{"t1", "[", "2", "]"}], " ", 
          RowBox[{"t2", "[", "2", "]"}]}]}], ")"}]}], 
      RowBox[{"t1", "[", "2", "]"}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", "a", " ", 
      SqrtBox[
       RowBox[{"12", "-", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"t1", "[", "1", "]"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
      RowBox[{"t1", "[", "2", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["3", "2"]}], " ", "a", " ", 
       RowBox[{"t1", "[", "1", "]"}]}], "+", 
      RowBox[{"\[Delta]a", " ", 
       RowBox[{"t1", "[", "1", "]"}]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8906588437012243`*^9, 3.890658869871442*^9}, {
   3.890658972346282*^9, 3.890659000185004*^9}, {3.8906590481105423`*^9, 
   3.890659054041214*^9}, {3.8906591363611107`*^9, 3.89065916129145*^9}, 
   3.8906591965120564`*^9, {3.890659465545802*^9, 3.890659471362216*^9}, 
   3.8906610629671373`*^9},
 CellLabel->
  "Out[6462]=",ExpressionUUID->"bbb72e29-1622-44c4-adbe-bbabf01704bc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", "a"}], "+", 
        RowBox[{"2", " ", "\[Delta]a"}]}], ")"}], " ", 
      RowBox[{"t1", "[", "1", "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8906588437012243`*^9, 3.890658869871442*^9}, {
   3.890658972346282*^9, 3.890659000185004*^9}, {3.8906590481105423`*^9, 
   3.890659054041214*^9}, {3.8906591363611107`*^9, 3.89065916129145*^9}, 
   3.8906591965120564`*^9, {3.890659465545802*^9, 3.890659471362216*^9}, 
   3.890661062970889*^9},
 CellLabel->
  "Out[6463]=",ExpressionUUID->"6bf23586-4b37-4c95-b8b5-c7debe7ac6a2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ux", "=", 
   FractionBox[
    RowBox[{"a", " ", 
     SqrtBox[
      RowBox[{"12", "-", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{"t1", "[", "1", "]"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"t1", "[", "1", "]"}]}], " ", 
        RowBox[{"t2", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"t1", "[", "2", "]"}], " ", 
        RowBox[{"t2", "[", "2", "]"}]}]}], ")"}]}], 
    RowBox[{"t1", "[", "2", "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uy", "=", "0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"vx", "=", 
   RowBox[{
    FractionBox["1", "2"], " ", "a", " ", 
    SqrtBox[
     RowBox[{"12", "-", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox[
         RowBox[{"t1", "[", "1", "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
    RowBox[{"t1", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vy", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["3", "2"]}], " ", "a", " ", 
     RowBox[{"t1", "[", "1", "]"}]}], "+", 
    RowBox[{"\[Delta]a", " ", 
     RowBox[{"t1", "[", "1", "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.89066094528489*^9, 3.890660986480891*^9}},
 CellLabel->
  "In[6452]:=",ExpressionUUID->"ec306163-dec0-4d82-a456-8c54960e00e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"E0", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"h2", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], "/.", "s1"}], ")"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.890661136236211*^9, 3.8906611410371943`*^9}, {
  3.8906617094565487`*^9, 3.890661714444633*^9}},
 CellLabel->
  "In[6502]:=",ExpressionUUID->"2cd23a7b-3f86-4ca8-b7a4-0c067769ec88"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"Hlin", ",", "Elin"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Hlin", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ux", "*", "kx", "*", 
     RowBox[{"PauliMatrix", "[", "0", "]"}]}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Chi]", " ", "vx", "*", 
       RowBox[{"PauliMatrix", "[", "1", "]"}], "*", "kx"}], "+", 
      RowBox[{"vy", "*", 
       RowBox[{"PauliMatrix", "[", "2", "]"}], "*", "ky"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Elin", "[", 
    RowBox[{"kx_", ",", "ky_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"E0", "+", 
     RowBox[{"(", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"Hlin", "[", 
        RowBox[{"kx", ",", "ky"}], "]"}], "]"}], ")"}]}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8906611945021563`*^9, 3.890661388731496*^9}, {
  3.890661773718951*^9, 3.890661774717999*^9}, {3.890662023830834*^9, 
  3.890662040503991*^9}, {3.890662079954866*^9, 3.8906620854756403`*^9}, {
  3.890662135897382*^9, 3.890662161164089*^9}},
 CellLabel->
  "In[6558]:=",ExpressionUUID->"747aa629-39e5-4c84-99b8-dcc3957fd7a6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Chi]", "=", 
  RowBox[{"-", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"Evaluate", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Elin", "[", 
         RowBox[{"kx", ",", "ky"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"t1", "[", "1", "]"}], "->", "t11"}], ",", 
          RowBox[{
           RowBox[{"t1", "[", "2", "]"}], "->", "t12"}], ",", 
          RowBox[{
           RowBox[{"t2", "[", "1", "]"}], "->", "t21"}], ",", 
          RowBox[{
           RowBox[{"t2", "[", "2", "]"}], "->", "t22"}], ",", 
          RowBox[{"\[Delta]a", "->", "da"}], ",", 
          RowBox[{"a", "->", "1"}]}], "}"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"AxesLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<kx\>\"", ",", "\"\<ky\>\"", ",", "\"\<Epm\>\""}], "}"}]}],
      ",", 
     RowBox[{"ViewPoint", "->", "Front"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"da", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t11", ",", "1"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t12", ",", "1"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t21", ",", "1"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t22", ",", "0"}], "}"}], ",", "0", ",", "2"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8906614185430193`*^9, 3.890661514659539*^9}, {
  3.8906620923456593`*^9, 3.8906621182359123`*^9}, {3.890662165878252*^9, 
  3.890662169824235*^9}, {3.890662893853551*^9, 3.890662899923171*^9}},
 CellLabel->
  "In[6571]:=",ExpressionUUID->"4df1f49a-150b-47b8-88bd-38ad0574c997"],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.8906615010270348`*^9, 3.890661515284967*^9}, 
   3.890661573344735*^9, 3.89066172371373*^9, 3.8906617781617928`*^9, {
   3.8906620264551992`*^9, 3.890662043698923*^9}, {3.89066209571651*^9, 
   3.890662170806288*^9}, {3.890662900318264*^9, 3.890662915597644*^9}},
 CellLabel->
  "Out[6571]=",ExpressionUUID->"82f5ae68-a749-4298-812d-06675f57150e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`da$$ = 0, $CellContext`t11$$ = 
    0.21, $CellContext`t12$$ = 1, $CellContext`t21$$ = 1, $CellContext`t22$$ =
     0, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`da$$], 0}, -1, 1}, {{
       Hold[$CellContext`t11$$], 1}, 0, 2}, {{
       Hold[$CellContext`t12$$], 1}, 0, 2}, {{
       Hold[$CellContext`t21$$], 1}, 0, 2}, {{
       Hold[$CellContext`t22$$], 0}, 0, 2}}, Typeset`size$$ = {
    360., {170., 174.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`da$$ = 0, $CellContext`t11$$ = 
        1, $CellContext`t12$$ = 1, $CellContext`t21$$ = 1, $CellContext`t22$$ = 
        0}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot3D[
        Evaluate[
         ReplaceAll[
          $CellContext`Elin[$CellContext`kx, $CellContext`ky], \
{$CellContext`t1[1] -> $CellContext`t11$$, $CellContext`t1[
            2] -> $CellContext`t12$$, $CellContext`t2[
            1] -> $CellContext`t21$$, $CellContext`t2[
            2] -> $CellContext`t22$$, $CellContext`\[Delta]a -> \
$CellContext`da$$, $CellContext`a -> 1}]], {$CellContext`kx, -Pi, 
         Pi}, {$CellContext`ky, -Pi, Pi}, AxesLabel -> {"kx", "ky", "Epm"}, 
        ViewPoint -> Front], 
      "Specifications" :> {{{$CellContext`da$$, 0}, -1, 
         1}, {{$CellContext`t11$$, 1}, 0, 2}, {{$CellContext`t12$$, 1}, 0, 
         2}, {{$CellContext`t21$$, 1}, 0, 2}, {{$CellContext`t22$$, 0}, 0, 
         2}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{404., {271., 276.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8906615010270348`*^9, 3.890661515284967*^9}, 
   3.890661573344735*^9, 3.89066172371373*^9, 3.8906617781617928`*^9, {
   3.8906620264551992`*^9, 3.890662043698923*^9}, {3.89066209571651*^9, 
   3.890662170806288*^9}, {3.890662900318264*^9, 3.890662915634181*^9}},
 CellLabel->
  "Out[6572]=",ExpressionUUID->"f309c42a-c2d7-441d-b336-b911bcecb379"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"plot", "=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Plot3D", "[", 
       RowBox[{
        RowBox[{"Evaluate", "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"h2", "[", 
             RowBox[{"kx", ",", "ky"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Epm", "[", 
              RowBox[{"kx", ",", "ky"}], "]"}], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"+", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"t1", "[", "1", "]"}], "->", "t11"}], ",", 
             RowBox[{
              RowBox[{"t1", "[", "2", "]"}], "->", "t12"}], ",", 
             RowBox[{
              RowBox[{"t2", "[", "1", "]"}], "->", "t21"}], ",", 
             RowBox[{
              RowBox[{"t2", "[", "2", "]"}], "->", "t22"}], ",", 
             RowBox[{"\[Delta]a", "->", "da"}], ",", 
             RowBox[{"a", "->", "1"}]}], "}"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"kx", ",", 
          RowBox[{"0.2", "\[Pi]"}], ",", 
          RowBox[{"2.1", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ky", ",", 
          RowBox[{
           RowBox[{"-", "0.3"}], "\[Pi]"}], ",", 
          RowBox[{"1.7", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
        RowBox[{"PlotPoints", "->", "100"}], ",", 
        RowBox[{"Boxed", "->", "False"}], ",", 
        RowBox[{"Axes", "->", "False"}], ",", 
        RowBox[{"BoxRatios", "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], ",", 
        RowBox[{"ViewPoint", "->", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", 
           RowBox[{"-", "2"}], ",", "0.5"}], "}"}]}]}], "]"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
         RowBox[{"Lighter", "[", 
          RowBox[{"Red", ",", "0.6"}], "]"}], ",", 
         RowBox[{"Sphere", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"kx", ",", "ky", ",", "E0"}], "}"}], "/.", "s1"}], 
             ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"t1", "[", "1", "]"}], "->", "t11"}], ",", 
              RowBox[{
               RowBox[{"t1", "[", "2", "]"}], "->", "t12"}], ",", 
              RowBox[{
               RowBox[{"t2", "[", "1", "]"}], "->", "t21"}], ",", 
              RowBox[{
               RowBox[{"t2", "[", "2", "]"}], "->", "t22"}], ",", 
              RowBox[{"\[Delta]a", "->", "da"}], ",", 
              RowBox[{"a", "->", "1"}]}], "}"}]}], ",", "0.7"}], "]"}]}], 
        "}"}], "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
         RowBox[{"Lighter", "[", 
          RowBox[{"Green", ",", "0.6"}], "]"}], ",", 
         RowBox[{"Sphere", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"kx", "+", "7.25"}], ",", "ky", ",", "E0"}], "}"}], "/.",
               "s2"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"t1", "[", "1", "]"}], "->", "t11"}], ",", 
              RowBox[{
               RowBox[{"t1", "[", "2", "]"}], "->", "t12"}], ",", 
              RowBox[{
               RowBox[{"t2", "[", "1", "]"}], "->", "t21"}], ",", 
              RowBox[{
               RowBox[{"t2", "[", "2", "]"}], "->", "t22"}], ",", 
              RowBox[{"\[Delta]a", "->", "da"}], ",", 
              RowBox[{"a", "->", "1"}]}], "}"}]}], ",", "0.7"}], "]"}]}], 
        "}"}], "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{",", "\[IndentingNewLine]", 
       RowBox[{"Plot3D", "[", 
        RowBox[{
         RowBox[{"Evaluate", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Elin", "[", 
             RowBox[{
              RowBox[{"kx", "-", 
               RowBox[{"s1", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "ky"}], "]"}], 
            "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"t1", "[", "1", "]"}], "->", "t11"}], ",", 
              RowBox[{
               RowBox[{"t1", "[", "2", "]"}], "->", "t12"}], ",", 
              RowBox[{
               RowBox[{"t2", "[", "1", "]"}], "->", "t21"}], ",", 
              RowBox[{
               RowBox[{"t2", "[", "2", "]"}], "->", "t22"}], ",", 
              RowBox[{"\[Delta]a", "->", "da"}], ",", 
              RowBox[{"a", "->", "1"}]}], "}"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"kx", ",", 
           RowBox[{
            RowBox[{"-", "10"}], "\[Pi]"}], ",", 
           RowBox[{"10", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ky", ",", 
           RowBox[{
            RowBox[{"-", "10"}], "\[Pi]"}], ",", 
           RowBox[{"10", "\[Pi]"}]}], "}"}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotTheme", "->", "\"\<Scientific\>\""}], ",", 
         RowBox[{"PlotStyle", "->", "Black"}], ",", 
         RowBox[{"ClippingStyle", "->", "None"}], ",", 
         RowBox[{"PlotPoints", "->", "100"}]}], "]"}]}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"da", ",", "0"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t11", ",", "1"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t12", ",", "1"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t21", ",", "0"}], "}"}], ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t22", ",", "0"}], "}"}], ",", "0", ",", "2"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.890658550943668*^9, 3.890658663864287*^9}, {
   3.8906587119262867`*^9, 3.8906587587118187`*^9}, {3.890661102382399*^9, 
   3.890661162996211*^9}, {3.890661365319681*^9, 3.890661374589283*^9}, {
   3.8906616206656713`*^9, 3.890661691032963*^9}, {3.8906618114252043`*^9, 
   3.8906618888263493`*^9}, {3.890661934425915*^9, 3.890661935357826*^9}, {
   3.890661981138753*^9, 3.890661983570879*^9}, 3.8906620157150383`*^9, {
   3.890664082143673*^9, 3.890664420850277*^9}, {3.890664456975252*^9, 
   3.89066453389377*^9}, {3.890664570587846*^9, 3.890664571125486*^9}, {
   3.89066472431038*^9, 3.890664760663046*^9}, {3.8906648032662563`*^9, 
   3.890664918569791*^9}, {3.89066494943465*^9, 3.8906649524630623`*^9}, {
   3.890664989033112*^9, 3.8906651377724733`*^9}},
 CellLabel->
  "In[6669]:=",ExpressionUUID->"d5d961dc-e256-46e3-ba70-42626805cd82"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`da$$ = 0, $CellContext`t11$$ = 
    1, $CellContext`t12$$ = 
    1, $CellContext`t21$$ = -0.33, $CellContext`t22$$ = 0, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`da$$], 0}, -1, 1}, {{
       Hold[$CellContext`t11$$], 1}, 0, 2}, {{
       Hold[$CellContext`t12$$], 1}, 0, 2}, {{
       Hold[$CellContext`t21$$], 0}, 0, 2}, {{
       Hold[$CellContext`t22$$], 0}, 0, 2}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`da$$ = 0, $CellContext`t11$$ = 
        1, $CellContext`t12$$ = 1, $CellContext`t21$$ = 0, $CellContext`t22$$ = 
        0}, "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> ($CellContext`plot = Show[
         Plot3D[
          Evaluate[
           
           ReplaceAll[$CellContext`h2[$CellContext`kx, $CellContext`ky] + \
$CellContext`Epm[$CellContext`kx, $CellContext`ky] {
               Plus[1], -1}, {$CellContext`t1[
              1] -> $CellContext`t11$$, $CellContext`t1[
              2] -> $CellContext`t12$$, $CellContext`t2[
              1] -> $CellContext`t21$$, $CellContext`t2[
              2] -> $CellContext`t22$$, $CellContext`\[Delta]a -> \
$CellContext`da$$, $CellContext`a -> 1}]], {$CellContext`kx, 0.2 Pi, 2.1 
           Pi}, {$CellContext`ky, (-0.3) Pi, 1.7 Pi}, PlotTheme -> 
          "Scientific", PlotPoints -> 100, Boxed -> False, Axes -> False, 
          BoxRatios -> {1, 1, 1}, ViewPoint -> {0.5, -2, 0.5}], 
         Graphics3D[{
           Opacity[0.5], 
           Lighter[Red, 0.6], 
           Sphere[
            ReplaceAll[
             
             ReplaceAll[{$CellContext`kx, $CellContext`ky, $CellContext`E0}, \
$CellContext`s1], {$CellContext`t1[1] -> $CellContext`t11$$, $CellContext`t1[
               2] -> $CellContext`t12$$, $CellContext`t2[
               1] -> $CellContext`t21$$, $CellContext`t2[
               2] -> $CellContext`t22$$, $CellContext`\[Delta]a -> \
$CellContext`da$$, $CellContext`a -> 1}], 0.7]}], 
         Graphics3D[{
           Opacity[0.5], 
           Lighter[Green, 0.6], 
           Sphere[
            ReplaceAll[
             
             ReplaceAll[{$CellContext`kx + 
               7.25, $CellContext`ky, $CellContext`E0}, $CellContext`s2], \
{$CellContext`t1[1] -> $CellContext`t11$$, $CellContext`t1[
               2] -> $CellContext`t12$$, $CellContext`t2[
               1] -> $CellContext`t21$$, $CellContext`t2[
               2] -> $CellContext`t22$$, $CellContext`\[Delta]a -> \
$CellContext`da$$, $CellContext`a -> 1}], 0.7]}]]), 
      "Specifications" :> {{{$CellContext`da$$, 0}, -1, 
         1}, {{$CellContext`t11$$, 1}, 0, 2}, {{$CellContext`t12$$, 1}, 0, 
         2}, {{$CellContext`t21$$, 0}, 0, 2}, {{$CellContext`t22$$, 0}, 0, 
         2}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{404., {292., 298.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.890658591955371*^9, {3.890658636495442*^9, 3.890658759468216*^9}, 
   3.89065880386334*^9, 3.890660993300026*^9, 3.8906610695986967`*^9, {
   3.89066164829972*^9, 3.8906616914673443`*^9}, 3.890661781361017*^9, {
   3.8906618135195704`*^9, 3.890661889261632*^9}, 3.890661936189788*^9, {
   3.890661999096117*^9, 3.8906620438227587`*^9}, {3.89066407159809*^9, 
   3.890664087250845*^9}, {3.890664120390428*^9, 3.890664373419435*^9}, {
   3.8906644131125727`*^9, 3.890664421359106*^9}, {3.890664460545457*^9, 
   3.8906645344341593`*^9}, 3.890664571812228*^9, 3.890664643100754*^9, {
   3.8906647255649967`*^9, 3.890664760821505*^9}, {3.890664799807135*^9, 
   3.8906649191303797`*^9}, 3.8906649529185143`*^9, {3.890664989534843*^9, 
   3.890665138070489*^9}, 3.890719365731677*^9},
 CellLabel->
  "Out[6669]=",ExpressionUUID->"edbab8af-04d0-44ab-bf42-5d28dec7f327"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\<../CORE/figures/\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<quinoid2_dispersion.png\>\"", ",", "plot", ",", 
   RowBox[{"ImageResolution", "->", "600"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.89065359332526*^9, 3.890653681149021*^9}, {
  3.890653714740527*^9, 3.890653718006988*^9}, {3.890654233893208*^9, 
  3.890654234040428*^9}, {3.890654721100459*^9, 3.890654721205245*^9}, {
  3.8906645475832233`*^9, 3.890664552507903*^9}, {3.890664592484076*^9, 
  3.890664592540187*^9}, {3.890664633438191*^9, 3.8906646468705997`*^9}, {
  3.890665165223135*^9, 3.890665165550391*^9}, {3.890719375905596*^9, 
  3.890719375989571*^9}},
 CellLabel->
  "In[6674]:=",ExpressionUUID->"4be30120-03cf-4d0a-888e-ca4586aedc2d"],

Cell[BoxData["\<\"/Users/andreashaller/CORE/figures\"\>"], "Output",
 CellChangeTimes->{
  3.890664555947003*^9, 3.8906645959515247`*^9, {3.890664639649932*^9, 
   3.890664647430128*^9}, {3.890665155991238*^9, 3.8906651685450077`*^9}, 
   3.890719376942522*^9},
 CellLabel->
  "Out[6674]=",ExpressionUUID->"aa6b90f5-e4d6-4d32-aa43-4e26fafada04"],

Cell[BoxData["\<\"quinoid2_dispersion.png\"\>"], "Output",
 CellChangeTimes->{
  3.890664555947003*^9, 3.8906645959515247`*^9, {3.890664639649932*^9, 
   3.890664647430128*^9}, {3.890665155991238*^9, 3.8906651685450077`*^9}, 
   3.890719378418538*^9},
 CellLabel->
  "Out[6675]=",ExpressionUUID->"08ea1e51-09d6-4c93-b7fe-443c6f17c6da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"t1", "[", "1", "]"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", 
       RowBox[{"t1", "[", "2", "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"2", 
   SqrtBox["3"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"t2", "[", "1", "]"}], " ", "a", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "\[Theta]"}], "]"}]}], " ", "+", 
     RowBox[{
      RowBox[{"t2", "[", "2", "]"}], " ", "a", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SqrtBox["3"], 
   RowBox[{"t1", "[", "2", "]"}], " ", "a", " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "//", "FullSimplify"}]}], "Input",\

 CellChangeTimes->{{3.8906604732298594`*^9, 3.890660496090543*^9}, {
  3.89066053323042*^9, 3.890660559182139*^9}, {3.890660617262252*^9, 
  3.8906606653811913`*^9}, {3.89066072503139*^9, 3.890660736272764*^9}, {
  3.890660767381082*^9, 3.8906607846635923`*^9}},
 CellLabel->
  "In[6445]:=",ExpressionUUID->"b223c500-218c-44a7-af26-e58ad40b9c6a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", 
   SqrtBox[
    RowBox[{"12", "-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox[
        RowBox[{"t1", "[", "1", "]"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"t1", "[", "1", "]"}]}], " ", 
      RowBox[{"t2", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"t1", "[", "2", "]"}], " ", 
      RowBox[{"t2", "[", "2", "]"}]}]}], ")"}]}], 
  RowBox[{"t1", "[", "2", "]"}]]], "Output",
 CellChangeTimes->{{3.8906604817522993`*^9, 3.89066049746095*^9}, {
  3.8906605337611017`*^9, 3.890660559569542*^9}, {3.890660617469598*^9, 
  3.890660665462618*^9}, {3.890660727468505*^9, 3.890660736727643*^9}, {
  3.890660779808628*^9, 3.890660785000482*^9}},
 CellLabel->
  "Out[6446]=",ExpressionUUID->"66b87dfb-a6ce-4d05-8439-ba5c6f87a08e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "a", " ", 
  SqrtBox[
   RowBox[{"12", "-", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"t1", "[", "1", "]"}], "2"]}], 
     SuperscriptBox[
      RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
  RowBox[{"t1", "[", "2", "]"}]}]], "Output",
 CellChangeTimes->{{3.8906604817522993`*^9, 3.89066049746095*^9}, {
  3.8906605337611017`*^9, 3.890660559569542*^9}, {3.890660617469598*^9, 
  3.890660665462618*^9}, {3.890660727468505*^9, 3.890660736727643*^9}, {
  3.890660779808628*^9, 3.890660785006605*^9}},
 CellLabel->
  "Out[6447]=",ExpressionUUID->"a6751c1c-8114-49a6-ba04-652aba3cdef8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"h2", "[", 
    RowBox[{"kx", ",", "ky"}], "]"}], "/.", "s1"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"h2", "[", 
     RowBox[{"kx", ",", "ky"}], "]"}], "/.", "s2"}], "//", "FullSimplify"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"h2", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky"}], "}"}]}], "]"}], "/.", "s1"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{"h2", "[", 
      RowBox[{"kx", ",", "ky"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "ky"}], "}"}]}], "]"}], "/.", "s2"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.8906594098663397`*^9, 3.890659444971998*^9}, {
  3.890659496652574*^9, 3.890659506490972*^9}},
 CellLabel->
  "In[6416]:=",ExpressionUUID->"9a0649af-bafd-42fd-b873-0e8394c3c1ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"t1", "[", "1", "]"}], "2"], 
      SuperscriptBox[
       RowBox[{"t1", "[", "2", "]"}], "2"]]}], ")"}], " ", 
   RowBox[{"t2", "[", "1", "]"}]}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"t1", "[", "1", "]"}], " ", 
    RowBox[{"t2", "[", "2", "]"}]}], 
   RowBox[{"t1", "[", "2", "]"}]]}]], "Output",
 CellChangeTimes->{{3.890659421622583*^9, 3.890659445527897*^9}, 
   3.8906595070897617`*^9, 3.890660601767584*^9},
 CellLabel->
  "Out[6416]=",ExpressionUUID->"c6d5c7aa-f6d6-40fc-a0ff-16d0ef6bfcb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"t1", "[", "1", "]"}], "2"], 
      SuperscriptBox[
       RowBox[{"t1", "[", "2", "]"}], "2"]]}], ")"}], " ", 
   RowBox[{"t2", "[", "1", "]"}]}], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"t1", "[", "1", "]"}], " ", 
    RowBox[{"t2", "[", "2", "]"}]}], 
   RowBox[{"t1", "[", "2", "]"}]]}]], "Output",
 CellChangeTimes->{{3.890659421622583*^9, 3.890659445527897*^9}, 
   3.8906595070897617`*^9, 3.8906606019138803`*^9},
 CellLabel->
  "Out[6417]=",ExpressionUUID->"dd3b790b-876f-40df-8443-ae9ae3d273ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"a", " ", 
     SqrtBox[
      RowBox[{"12", "-", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{"t1", "[", "1", "]"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"t1", "[", "1", "]"}]}], " ", 
        RowBox[{"t2", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"t1", "[", "2", "]"}], " ", 
        RowBox[{"t2", "[", "2", "]"}]}]}], ")"}]}], 
    RowBox[{"t1", "[", "2", "]"}]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.890659421622583*^9, 3.890659445527897*^9}, 
   3.8906595070897617`*^9, 3.890660602078644*^9},
 CellLabel->
  "Out[6418]=",ExpressionUUID->"0cc226ff-374b-49d5-bed7-c46cdafe770f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"a", " ", 
     SqrtBox[
      RowBox[{"12", "-", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{"t1", "[", "1", "]"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"t1", "[", "2", "]"}], "2"]]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"t1", "[", "1", "]"}], " ", 
        RowBox[{"t2", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"t1", "[", "2", "]"}], " ", 
        RowBox[{"t2", "[", "2", "]"}]}]}], ")"}]}], 
    RowBox[{"t1", "[", "2", "]"}]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.890659421622583*^9, 3.890659445527897*^9}, 
   3.8906595070897617`*^9, 3.890660602249281*^9},
 CellLabel->
  "Out[6419]=",ExpressionUUID->"90c839df-f8cb-4129-9919-5ff6f1800f71"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"ky", " ", 
         RowBox[{"(", 
          RowBox[{"a", "-", "\[Delta]a"}], ")"}]}], "]"}]}], " ", 
      RowBox[{"t1", "[", "1", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"a", " ", "ky"}], "2"], "]"}], " ", 
      RowBox[{"t1", "[", "2", "]"}]}]}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"ky", " ", 
         RowBox[{"(", 
          RowBox[{"a", "-", "\[Delta]a"}], ")"}]}], "]"}]}], " ", 
      RowBox[{"t1", "[", "1", "]"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"a", " ", "ky"}], "2"], "]"}], " ", 
      RowBox[{"t1", "[", "2", "]"}]}]}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Input",
 CellLabel->
  "In[6420]:=",ExpressionUUID->"02633ec6-adbd-445f-add1-86db4c309e31"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       RowBox[{"ky", " ", 
        RowBox[{"(", 
         RowBox[{"a", "-", "\[Delta]a"}], ")"}]}], "]"}]}], " ", 
     RowBox[{"t1", "[", "1", "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"a", " ", "ky"}], "2"], "]"}], " ", 
     RowBox[{"t1", "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{"ky", " ", 
        RowBox[{"(", 
         RowBox[{"a", "-", "\[Delta]a"}], ")"}]}], "]"}]}], " ", 
     RowBox[{"t1", "[", "1", "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["3"], " ", "a", " ", "kx"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"a", " ", "ky"}], "2"], "]"}], " ", 
     RowBox[{"t1", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.890660604805586*^9},
 CellLabel->
  "Out[6420]=",ExpressionUUID->"26756b27-15d9-4ac9-9cc5-f1e21be12f71"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Eigenvalues", "[", 
   RowBox[{"H", "[", 
    RowBox[{"kx", ",", "ky", ",", "\[Delta]a1", ",", "\[Delta]a2"}], "]"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.890621319090267*^9, 3.890621359643746*^9}, {
  3.890621398164831*^9, 3.890621402799141*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"334c1a97-4c69-4b48-ac01-064084d27f08"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"0.2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"ky", " ", 
            RowBox[{"(", 
             RowBox[{
              FractionBox["3", "2"], "-", "\[Delta]a1"}], ")"}]}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox["3"], " ", "kx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Delta]a2"}], ")"}]}], "]"}]}], "+", 
         
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SqrtBox["3"], " ", "kx", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Delta]a2"}], ")"}]}], "]"}]}]}], 
        ")"}]}], "+", 
      SqrtBox[
       RowBox[{"3", "+", 
        RowBox[{"4", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"ky", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["3", "2"], "-", "\[Delta]a1"}], ")"}]}], "]"}], " ", 
         
         RowBox[{"Cos", "[", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           SqrtBox["3"], " ", "kx", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Delta]a2"}], ")"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           SqrtBox["3"], " ", "kx", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Delta]a2"}], ")"}]}], "]"}]}]}]]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", 
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]a1", ",", "0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]a2", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.89062142681678*^9, 3.89062147184413*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"c6fe3b47-9b96-4d82-996c-40fc30a5ae21"]
},
WindowSize->{960, 1027},
WindowMargins->{{Automatic, 0}, {Automatic, -180}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0f3c3c8d-f316-4cfc-aed9-d7ea5bfcf516"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 13231, 359, 781, "Input",ExpressionUUID->"00e4702b-2c65-412d-86b2-8482e5759209"],
Cell[13814, 383, 15735, 408, 463, "Output",ExpressionUUID->"c831fe2f-6f38-4ae8-bb03-bcdcf76ec378"]
}, Open  ]],
Cell[29564, 794, 312, 6, 30, "Input",ExpressionUUID->"d5ee9abd-dd6f-42cb-88a5-eb38f3b11d64"],
Cell[29879, 802, 342, 8, 52, "Input",ExpressionUUID->"a17df307-4eb2-4edd-9ad8-564787bd7ab9"],
Cell[CellGroupData[{
Cell[30246, 814, 260, 4, 52, "Input",ExpressionUUID->"9765244e-0c72-4a01-b0b4-a615fb26a4dd"],
Cell[30509, 820, 756, 25, 67, "Output",ExpressionUUID->"9310be0a-646c-47b0-b955-687e090cc6b5"],
Cell[31268, 847, 1472, 52, 67, "Output",ExpressionUUID->"5f1cc2ea-0c50-46ab-946b-412f7a4e04ec"]
}, Open  ]],
Cell[32755, 902, 603, 13, 52, "Input",ExpressionUUID->"03466bea-e24b-4889-8f16-14b326e630b0"],
Cell[CellGroupData[{
Cell[33383, 919, 2344, 59, 140, "Input",ExpressionUUID->"af2f609f-a70e-481f-8b8b-ff53311d5f29"],
Cell[35730, 980, 1526, 33, 64, "Output",ExpressionUUID->"e9638ed2-c2a8-46b2-a8b2-f3e996bb1907"],
Cell[37259, 1015, 2455, 59, 90, "Output",ExpressionUUID->"3b9d66a0-7d7a-499c-8fee-c1b357383bdc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39751, 1079, 1856, 46, 165, "Input",ExpressionUUID->"de734b72-89be-4689-8cdf-1300e50ae39f"],
Cell[41610, 1127, 774, 23, 64, "Output",ExpressionUUID->"a593f7ac-57cc-4835-badb-3f908bf889ae"]
}, Open  ]],
Cell[42399, 1153, 805, 24, 52, "Input",ExpressionUUID->"cd70d5d4-35d7-4426-9625-b5a149badff6"],
Cell[CellGroupData[{
Cell[43229, 1181, 644, 16, 47, "Input",ExpressionUUID->"5149ab17-cf7d-4db3-a78e-b74403d62a44"],
Cell[43876, 1199, 877, 26, 64, "Output",ExpressionUUID->"005c2675-ac45-4107-b00d-f516c5b8ffe4"]
}, Open  ]],
Cell[44768, 1228, 1682, 51, 113, "Input",ExpressionUUID->"224e3998-89c3-4146-a974-0706fbb484ec"],
Cell[CellGroupData[{
Cell[46475, 1283, 535, 15, 30, "Input",ExpressionUUID->"1e3c83ae-3475-44a5-ae20-cffd30b3157b"],
Cell[47013, 1300, 321, 9, 48, "Output",ExpressionUUID->"91d5d9a5-6ca3-4810-a70f-e344b9ac1ccd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47371, 1314, 1345, 40, 100, "Input",ExpressionUUID->"e43948c1-4aa8-46be-b43e-60dde023bd46"],
Cell[48719, 1356, 934, 28, 68, "Output",ExpressionUUID->"fae75263-91d3-4478-942f-a76021df1ff3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49690, 1389, 1346, 40, 126, "Input",ExpressionUUID->"6714563b-9200-4be3-bd9e-60164a93990c"],
Cell[51039, 1431, 635, 18, 80, "Output",ExpressionUUID->"b6b93dc2-7c3b-4e0e-a073-af1fe3372d44"],
Cell[51677, 1451, 665, 19, 80, "Output",ExpressionUUID->"b0ac6a11-fe0b-456d-aa51-4d97cf0dd73a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52379, 1475, 363, 9, 52, "Input",ExpressionUUID->"8b2c6023-5ef7-48bc-8444-1c937e148de7"],
Cell[52745, 1486, 787, 24, 66, "Output",ExpressionUUID->"7aca5755-6ee1-410e-b227-c567f02fd8aa"],
Cell[53535, 1512, 787, 24, 66, "Output",ExpressionUUID->"a8a9073c-e14b-4d79-9684-8d5ac90657f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54359, 1541, 1130, 32, 73, "Input",ExpressionUUID->"191ff705-9add-4be7-aa29-44be357e9106"],
Cell[55492, 1575, 1827, 53, 89, "Output",ExpressionUUID->"f6f61725-ba3e-458c-9fb1-998349495698"],
Cell[57322, 1630, 1823, 53, 89, "Output",ExpressionUUID->"bbb72e29-1622-44c4-adbe-bbabf01704bc"],
Cell[59148, 1685, 836, 22, 48, "Output",ExpressionUUID->"6bf23586-4b37-4c95-b8b5-c7debe7ac6a2"]
}, Open  ]],
Cell[59999, 1710, 1527, 49, 195, "Input",ExpressionUUID->"ec306163-dec0-4d82-a456-8c54960e00e5"],
Cell[61529, 1761, 385, 11, 30, "Input",ExpressionUUID->"2cd23a7b-3f86-4ca8-b7a4-0c067769ec88"],
Cell[61917, 1774, 1232, 33, 73, "Input",ExpressionUUID->"747aa629-39e5-4c84-99b8-dcc3957fd7a6"],
Cell[CellGroupData[{
Cell[63174, 1811, 2164, 61, 94, "Input",ExpressionUUID->"4df1f49a-150b-47b8-88bd-38ad0574c997"],
Cell[65341, 1874, 415, 7, 48, "Output",ExpressionUUID->"82f5ae68-a749-4298-812d-06675f57150e"],
Cell[65759, 1883, 2866, 55, 580, "Output",ExpressionUUID->"f309c42a-c2d7-441d-b336-b911bcecb379"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68662, 1943, 7498, 190, 430, "Input",ExpressionUUID->"d5d961dc-e256-46e3-ba70-42626805cd82"],
Cell[76163, 2135, 4726, 93, 623, "Output",ExpressionUUID->"edbab8af-04d0-44ab-bf42-5d28dec7f327"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80926, 2233, 864, 16, 52, "Input",ExpressionUUID->"4be30120-03cf-4d0a-888e-ca4586aedc2d"],
Cell[81793, 2251, 345, 6, 48, "Output",ExpressionUUID->"aa6b90f5-e4d6-4d32-aa43-4e26fafada04"],
Cell[82141, 2259, 335, 6, 48, "Output",ExpressionUUID->"08ea1e51-09d6-4c93-b7fe-443c6f17c6da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82513, 2270, 1202, 35, 75, "Input",ExpressionUUID->"b223c500-218c-44a7-af26-e58ad40b9c6a"],
Cell[83718, 2307, 928, 26, 85, "Output",ExpressionUUID->"66b87dfb-a6ce-4d05-8439-ba5c6f87a08e"],
Cell[84649, 2335, 674, 17, 75, "Output",ExpressionUUID->"a6751c1c-8114-49a6-ba04-652aba3cdef8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85360, 2357, 1061, 33, 115, "Input",ExpressionUUID->"9a0649af-bafd-42fd-b873-0e8394c3c1ab"],
Cell[86424, 2392, 647, 19, 71, "Output",ExpressionUUID->"c6d5c7aa-f6d6-40fc-a0ff-16d0ef6bfcb8"],
Cell[87074, 2413, 649, 19, 71, "Output",ExpressionUUID->"dd3b790b-876f-40df-8443-ae9ae3d273ca"],
Cell[87726, 2434, 867, 26, 85, "Output",ExpressionUUID->"0cc226ff-374b-49d5-bed7-c46cdafe770f"],
Cell[88596, 2462, 842, 25, 85, "Output",ExpressionUUID->"90c839df-f8cb-4129-9919-5ff6f1800f71"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89475, 2492, 1366, 44, 90, "Input",ExpressionUUID->"02633ec6-adbd-445f-add1-86db4c309e31"],
Cell[90844, 2538, 1239, 39, 103, "Output",ExpressionUUID->"26756b27-15d9-4ac9-9cc5-f1e21be12f71"]
}, Open  ]],
Cell[92098, 2580, 395, 8, 30, "Input",ExpressionUUID->"334c1a97-4c69-4b48-ac01-064084d27f08"],
Cell[92496, 2590, 2228, 66, 154, "Input",ExpressionUUID->"c6fe3b47-9b96-4d82-996c-40fc30a5ae21"]
}
]
*)

