(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27675,        617]
NotebookOptionsPosition[     26560,        595]
NotebookOutlinePosition[     26955,        611]
CellTagsIndexPosition[     26912,        608]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[HBar]", ",", "m", ",", "\[Sigma]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[HBar]", "=", 
   RowBox[{"m", "=", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", 
   RowBox[{"20", "\[Sigma]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmax", "=", 
   RowBox[{"10", "\[Sigma]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", "=", "0"}], ";", " ", 
  RowBox[{"y0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Psi]", ",", "V", ",", "\[CapitalOmega]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"]}], 
   RowBox[{"2", " "}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "=", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "L"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"-", "L"}], "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"L", "/", "2"}], ",", 
       RowBox[{"L", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RegionPlot", "[", "\[CapitalOmega]", "]"}]}], "Input",
 CellChangeTimes->{{3.900729887514974*^9, 3.900729888323646*^9}, {
   3.9007300169479113`*^9, 3.9007300254272842`*^9}, {3.900730217962071*^9, 
   3.900730333871237*^9}, {3.900730369700583*^9, 3.900730486406179*^9}, {
   3.900730724815724*^9, 3.9007308765374193`*^9}, {3.900730948800743*^9, 
   3.9007309528115273`*^9}, {3.9007310339346933`*^9, 3.90073111834724*^9}, {
   3.900731288466223*^9, 3.900731499685783*^9}, {3.900731668951721*^9, 
   3.900731676414171*^9}, 3.90073173094808*^9, 3.9007323012371817`*^9, 
   3.900732393753913*^9, {3.900732494979331*^9, 3.9007325218635063`*^9}, {
   3.9007326674003887`*^9, 3.900732692873561*^9}, {3.9007327623026123`*^9, 
   3.900732774644609*^9}, 3.900732832646029*^9, {3.900732924812414*^9, 
   3.900733000486656*^9}, {3.900733548690988*^9, 3.9007335612922087`*^9}, {
   3.900733607823749*^9, 3.900733619054276*^9}, {3.900733785773768*^9, 
   3.900733896916567*^9}, {3.9007340070141363`*^9, 3.9007340071623707`*^9}, {
   3.9007344496411543`*^9, 3.9007344505072947`*^9}, {3.900734539781806*^9, 
   3.9007345617702103`*^9}, {3.9007346998966913`*^9, 3.900734726677372*^9}, {
   3.900734842729311*^9, 3.900734843953092*^9}, {3.900734912031546*^9, 
   3.9007349330904007`*^9}, {3.900735034751523*^9, 3.900735214349612*^9}, {
   3.900735290256858*^9, 3.90073529156001*^9}, 3.900735594730566*^9, 
   3.900735658097204*^9, {3.900735714754383*^9, 3.900735730819789*^9}, {
   3.9007357662917957`*^9, 3.9007358599765787`*^9}, {3.900735903330249*^9, 
   3.900735907968244*^9}, 3.900736084836935*^9, {3.900736121512793*^9, 
   3.900736138992625*^9}, {3.900736173504732*^9, 3.900736173687476*^9}, {
   3.900738639253682*^9, 3.900738658654305*^9}, {3.9007456362461853`*^9, 
   3.900745660276539*^9}, {3.9007456986500053`*^9, 3.900745722714634*^9}, {
   3.900745753407642*^9, 3.900745753624918*^9}, {3.900745866658815*^9, 
   3.900745867297639*^9}, {3.9007459166851473`*^9, 3.900745922326736*^9}, {
   3.900745963406982*^9, 3.900745964745625*^9}, {3.9007460028954153`*^9, 
   3.9007460047658243`*^9}, {3.9007461237262993`*^9, 3.900746124050729*^9}, {
   3.900746360730792*^9, 3.900746407027763*^9}, {3.900746520861903*^9, 
   3.900746557725342*^9}, {3.900746600340678*^9, 3.900746655417871*^9}, {
   3.9007472461596127`*^9, 3.9007472463148727`*^9}, {3.900747387224413*^9, 
   3.900747387541794*^9}, {3.9007475123849897`*^9, 3.9007475134167957`*^9}, 
   3.90074757924049*^9, {3.900747617470099*^9, 3.900747619561021*^9}, {
   3.900747684303985*^9, 3.900747693027368*^9}, {3.9007477784157143`*^9, 
   3.9007477835755463`*^9}, {3.90074781901683*^9, 3.900747819531563*^9}, {
   3.90074795018684*^9, 3.900747971092527*^9}, {3.900748075178054*^9, 
   3.900748120679908*^9}, {3.900748155758041*^9, 3.900748167972599*^9}, {
   3.900748206841014*^9, 3.900748207582515*^9}, {3.90074825560786*^9, 
   3.9007482558573523`*^9}, {3.9007482914556923`*^9, 3.900748294166913*^9}, {
   3.900748333768073*^9, 3.900748342383624*^9}, {3.9007483792788687`*^9, 
   3.900748407481106*^9}, {3.900748459756055*^9, 3.900748459894457*^9}, {
   3.900748502435142*^9, 3.9007485077830753`*^9}, {3.900749867257721*^9, 
   3.900749895665357*^9}, {3.9007504077189703`*^9, 3.900750407886859*^9}},
 CellLabel->
  "In[771]:=",ExpressionUUID->"d9863ba2-4441-4181-8cd8-9f583aae6f69"],

Cell[BoxData[
 RowBox[{"solution", "=", 
  RowBox[{"NDSolveValue", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", "t"}], "]"}]}], "==", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", 
          FractionBox[
           SuperscriptBox["\[HBar]", "2"], 
           RowBox[{"2", "m"}]]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Psi]", "[", 
              RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "+", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Psi]", "[", 
              RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"V", "[", 
          RowBox[{"x", ",", "y"}], "]"}], 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"t", ",", "x", ",", "y"}], "]"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"1", ",", "0", ",", "0"}], "]"}], "[", "\[Psi]", "]"}], 
          "[", 
          RowBox[{"0", ",", "x", ",", "y"}], "]"}], "==", "0"}], ","}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"0", ",", "x", ",", "y"}], "]"}], "==", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", "x"}]], 
        SqrtBox[
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", "\[Pi]", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x", "-", "x0"}], ")"}], "2"], 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Sigma]", "2"]}]]}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y", "-", "y0"}], ")"}], "2"], 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Sigma]", "2"]}]]}]]}]]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PeriodicBoundaryCondition", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
        RowBox[{"x", "\[Equal]", 
         RowBox[{
          RowBox[{"-", "L"}], "/", "2"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"TranslationTransform", "[", 
         RowBox[{"{", 
          RowBox[{"L", ",", "0"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PeriodicBoundaryCondition", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
        RowBox[{"y", "\[Equal]", 
         RowBox[{
          RowBox[{"-", "L"}], "/", "2"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"TranslationTransform", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "L"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"DirichletCondition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Psi]", "[", 
          RowBox[{"t", ",", "x", ",", "y"}], "]"}], "==", "0"}], ",", 
        "True"}], "]"}], "*)"}], "\[IndentingNewLine]", "}"}], ",", "\[Psi]", 
    ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"-", "L"}], "/", "2"}], ",", 
        RowBox[{"L", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{
         RowBox[{"-", "L"}], "/", "2"}], ",", 
        RowBox[{"L", "/", "2"}]}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.900729887514974*^9, 3.900729888323646*^9}, {
   3.9007300169479113`*^9, 3.9007300254272842`*^9}, {3.900730217962071*^9, 
   3.900730333871237*^9}, {3.900730369700583*^9, 3.900730486406179*^9}, {
   3.900730724815724*^9, 3.9007308765374193`*^9}, {3.900730948800743*^9, 
   3.9007309528115273`*^9}, {3.9007310339346933`*^9, 3.90073111834724*^9}, {
   3.900731288466223*^9, 3.900731499685783*^9}, {3.900731668951721*^9, 
   3.900731676414171*^9}, 3.90073173094808*^9, 3.9007323012371817`*^9, 
   3.900732393753913*^9, {3.900732494979331*^9, 3.9007325218635063`*^9}, {
   3.9007326674003887`*^9, 3.900732692873561*^9}, {3.9007327623026123`*^9, 
   3.900732774644609*^9}, 3.900732832646029*^9, {3.900732924812414*^9, 
   3.900733000486656*^9}, {3.900733548690988*^9, 3.9007335612922087`*^9}, {
   3.900733607823749*^9, 3.900733619054276*^9}, {3.900733785773768*^9, 
   3.900733896916567*^9}, {3.9007340070141363`*^9, 3.9007340071623707`*^9}, {
   3.9007344496411543`*^9, 3.9007344505072947`*^9}, {3.900734539781806*^9, 
   3.9007345617702103`*^9}, {3.9007346998966913`*^9, 3.900734726677372*^9}, {
   3.900734842729311*^9, 3.900734843953092*^9}, {3.900734912031546*^9, 
   3.9007349330904007`*^9}, {3.900735034751523*^9, 3.900735214349612*^9}, {
   3.900735290256858*^9, 3.90073529156001*^9}, 3.900735594730566*^9, 
   3.900735658097204*^9, {3.900735714754383*^9, 3.900735730819789*^9}, {
   3.9007357662917957`*^9, 3.9007358599765787`*^9}, {3.900735903330249*^9, 
   3.900735907968244*^9}, 3.900736084836935*^9, {3.900736121512793*^9, 
   3.900736138992625*^9}, {3.900736173504732*^9, 3.900736173687476*^9}, {
   3.900738639253682*^9, 3.900738658654305*^9}, {3.9007456362461853`*^9, 
   3.900745660276539*^9}, {3.9007456986500053`*^9, 3.900745722714634*^9}, {
   3.900745753407642*^9, 3.900745753624918*^9}, {3.900745866658815*^9, 
   3.900745867297639*^9}, {3.9007459166851473`*^9, 3.900745922326736*^9}, {
   3.900745963406982*^9, 3.900745964745625*^9}, {3.9007460028954153`*^9, 
   3.9007460047658243`*^9}, {3.9007461237262993`*^9, 3.900746124050729*^9}, {
   3.900746360730792*^9, 3.900746407027763*^9}, {3.900746520861903*^9, 
   3.9007465437285223`*^9}, {3.900746661813229*^9, 3.900746715819931*^9}, {
   3.900746804099558*^9, 3.900746813609118*^9}, {3.90074697647771*^9, 
   3.900746977862617*^9}, {3.900747241816037*^9, 3.900747242389163*^9}, {
   3.900747459596581*^9, 3.9007474766354513`*^9}, {3.900747545003079*^9, 
   3.900747576251545*^9}, {3.900747960040904*^9, 3.9007479609193296`*^9}, {
   3.9007488418328247`*^9, 3.9007488574897833`*^9}, {3.9007489336773033`*^9, 
   3.900748943581717*^9}, {3.900749010239801*^9, 3.900749051723899*^9}, {
   3.900749083590411*^9, 3.900749153675933*^9}, {3.900749241315775*^9, 
   3.90074924150686*^9}, {3.900749274004932*^9, 3.900749274634197*^9}, {
   3.900749310542055*^9, 3.90074933263935*^9}, {3.900749413588982*^9, 
   3.900749414848879*^9}, {3.900749454909142*^9, 3.9007494765347548`*^9}, {
   3.900749507529608*^9, 3.9007495081859293`*^9}, {3.900749886588497*^9, 
   3.900749886929281*^9}},
 CellLabel->
  "In[782]:=",ExpressionUUID->"8cf6d7c5-30d9-4c73-a4dd-b8013c3e0a9e"],

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"solution", "[", 
      RowBox[{"0", ",", "x", ",", "y"}], "]"}], "]"}], "2"], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.900747427095293*^9, 3.900747447369731*^9}, {
  3.900747493536677*^9, 3.900747504926907*^9}},
 CellLabel->
  "In[783]:=",ExpressionUUID->"bffdd301-2302-4996-9497-864ab862ae73"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Abs", "[", 
     RowBox[{"solution", "[", 
      RowBox[{"0", ",", "x", ",", "y"}], "]"}], "]"}], "2"], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}], ",", 
   RowBox[{"PlotRange", "->", "Full"}], ",", 
   RowBox[{"PlotPoints", "->", "200"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9007479114277267`*^9, 3.9007479320214*^9}, {
  3.900748011477028*^9, 3.9007480136398973`*^9}, {3.9007485468316717`*^9, 
  3.9007485705295763`*^9}},
 CellLabel->
  "In[784]:=",ExpressionUUID->"2a2395e1-9082-4429-b171-ddc84764d95f"],

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"plots", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Plot3D", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"solution", "[", 
            RowBox[{"t", ",", "x", ",", "y"}], "]"}], "]"}], "2"], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              RowBox[{"solution", "[", 
               RowBox[{"0", ",", "0", ",", "0"}], "]"}], "]"}], "2"]}], 
           "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax", ",", 
         RowBox[{"tmax", "/", "20"}]}], "}"}]}], "]"}]}], ";"}], ",", 
   RowBox[{"N", "[", 
    RowBox[{"t", "/", "tmax"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.900734171674107*^9, 3.900734174423214*^9}, {
   3.9007342666425858`*^9, 3.900734267085569*^9}, {3.900734358852235*^9, 
   3.900734505970479*^9}, {3.900734639335828*^9, 3.9007346906762657`*^9}, 
   3.900734838023106*^9, {3.9007349526189823`*^9, 3.9007349885169783`*^9}, {
   3.900735280987217*^9, 3.900735377173849*^9}, {3.9007354734662457`*^9, 
   3.900735490336289*^9}, {3.900735573402679*^9, 3.900735574409214*^9}, {
   3.9007356143642597`*^9, 3.900735632545293*^9}, 3.900735720895022*^9, {
   3.900745742193803*^9, 3.900745773539242*^9}, 3.900745872541483*^9, {
   3.900745982003278*^9, 3.900745998100768*^9}, {3.900747296283513*^9, 
   3.900747373017991*^9}, {3.900748030188114*^9, 3.9007480479034357`*^9}},
 CellLabel->
  "In[785]:=",ExpressionUUID->"753a6641-2e76-4eb9-82b3-f242b516fc0e"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", "plots", "]"}]], "Input",
 CellChangeTimes->{{3.900735369445443*^9, 3.900735423601088*^9}, {
   3.900735538752701*^9, 3.900735544254718*^9}, 3.900747290496645*^9},
 CellLabel->
  "In[786]:=",ExpressionUUID->"5ba5062a-226c-4852-8bb7-83bd24ad4582"],

Cell[BoxData[
 RowBox[{"solution2", "=", 
  RowBox[{"NDSolveValue", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[HBar]", " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", "t"}], "]"}]}], "==", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", 
          FractionBox[
           SuperscriptBox["\[HBar]", "2"], 
           RowBox[{"2", "m"}]]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Psi]", "[", 
              RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "+", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"\[Psi]", "[", 
              RowBox[{"t", ",", "x", ",", "y"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], ")"}]}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"V", "[", 
          RowBox[{"x", ",", "y"}], "]"}], 
         RowBox[{"\[Psi]", "[", 
          RowBox[{"t", ",", "x", ",", "y"}], "]"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"1", ",", "0", ",", "0"}], "]"}], "[", "\[Psi]", "]"}], 
          "[", 
          RowBox[{"0", ",", "x", ",", "y"}], "]"}], "==", "0"}], ","}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"0", ",", "x", ",", "y"}], "]"}], "==", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "k", " ", "x"}]], 
        SqrtBox[
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", "\[Pi]", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x", "-", "x0"}], ")"}], "2"], 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Sigma]", "2"]}]]}]], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y", "-", "y0"}], ")"}], "2"], 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Sigma]", "2"]}]]}]]}]]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"-", "L"}], "/", "2"}], ",", "y"}], "]"}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"t", ",", 
         RowBox[{"L", "/", "2"}], ",", "y"}], "]"}], "==", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"t", ",", "x", ",", 
         RowBox[{
          RowBox[{"-", "L"}], "/", "2"}]}], "]"}], "==", "0"}], ",", 
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"t", ",", "x", ",", 
         RowBox[{"L", "/", "2"}]}], "]"}], "==", "0"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[Psi]", ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"-", "L"}], "/", "2"}], ",", 
      RowBox[{"L", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{
       RowBox[{"-", "L"}], "/", "2"}], ",", 
      RowBox[{"L", "/", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"WorkingPrecision", "->", "MachinePrecision"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Method", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<PDEDiscretization\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<MethodOfLines\>\"", ",", 
         RowBox[{"\"\<SpatialDiscretization\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<TensorProductGrid\>\"", ",", 
            RowBox[{"\"\<MinPoints\>\"", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"pp", "=", "100"}], ")"}]}]}], "}"}]}]}], "}"}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.900729887514974*^9, 3.900729888323646*^9}, {
   3.9007300169479113`*^9, 3.9007300254272842`*^9}, {3.900730217962071*^9, 
   3.900730333871237*^9}, {3.900730369700583*^9, 3.900730486406179*^9}, {
   3.900730724815724*^9, 3.9007308765374193`*^9}, {3.900730948800743*^9, 
   3.9007309528115273`*^9}, {3.9007310339346933`*^9, 3.90073111834724*^9}, {
   3.900731288466223*^9, 3.900731499685783*^9}, {3.900731668951721*^9, 
   3.900731676414171*^9}, 3.90073173094808*^9, 3.9007323012371817`*^9, 
   3.900732393753913*^9, {3.900732494979331*^9, 3.9007325218635063`*^9}, {
   3.9007326674003887`*^9, 3.900732692873561*^9}, {3.9007327623026123`*^9, 
   3.900732774644609*^9}, 3.900732832646029*^9, {3.900732924812414*^9, 
   3.900733000486656*^9}, {3.900733548690988*^9, 3.9007335612922087`*^9}, {
   3.900733607823749*^9, 3.900733619054276*^9}, {3.900733785773768*^9, 
   3.900733896916567*^9}, {3.9007340070141363`*^9, 3.9007340071623707`*^9}, {
   3.9007344496411543`*^9, 3.9007344505072947`*^9}, {3.900734539781806*^9, 
   3.9007345617702103`*^9}, {3.9007346998966913`*^9, 3.900734726677372*^9}, {
   3.900734842729311*^9, 3.900734843953092*^9}, {3.900734912031546*^9, 
   3.9007349330904007`*^9}, {3.900735034751523*^9, 3.900735214349612*^9}, {
   3.900735290256858*^9, 3.90073529156001*^9}, 3.900735594730566*^9, 
   3.900735658097204*^9, {3.900735714754383*^9, 3.900735730819789*^9}, {
   3.9007357662917957`*^9, 3.9007358599765787`*^9}, {3.900735903330249*^9, 
   3.900735907968244*^9}, 3.900736084836935*^9, {3.900736121512793*^9, 
   3.900736138992625*^9}, {3.900736173504732*^9, 3.900736173687476*^9}, {
   3.900738639253682*^9, 3.900738658654305*^9}, {3.9007456362461853`*^9, 
   3.900745660276539*^9}, {3.9007456986500053`*^9, 3.900745722714634*^9}, {
   3.900745753407642*^9, 3.900745753624918*^9}, {3.900745866658815*^9, 
   3.900745867297639*^9}, {3.9007459166851473`*^9, 3.900745922326736*^9}, {
   3.900745963406982*^9, 3.900745964745625*^9}, {3.9007460028954153`*^9, 
   3.9007460047658243`*^9}, {3.9007461237262993`*^9, 3.900746124050729*^9}, {
   3.900746360730792*^9, 3.900746407027763*^9}, {3.900746520861903*^9, 
   3.9007465437285223`*^9}, {3.900746661813229*^9, 3.900746715819931*^9}, {
   3.900746804099558*^9, 3.900746813609118*^9}, {3.90074697647771*^9, 
   3.900746977862617*^9}, {3.900747241816037*^9, 3.900747242389163*^9}, {
   3.900747459596581*^9, 3.9007474766354513`*^9}, {3.900747545003079*^9, 
   3.900747576251545*^9}, {3.900747960040904*^9, 3.9007479609193296`*^9}, {
   3.9007488418328247`*^9, 3.9007488574897833`*^9}, {3.9007489336773033`*^9, 
   3.900748943581717*^9}, {3.900749010239801*^9, 3.900749051723899*^9}, {
   3.900749083590411*^9, 3.900749153675933*^9}, {3.900749241315775*^9, 
   3.90074924150686*^9}, {3.900749274004932*^9, 3.900749274634197*^9}, {
   3.900749310542055*^9, 3.90074933263935*^9}, {3.900749413588982*^9, 
   3.900749414848879*^9}, {3.900749454909142*^9, 3.9007494765347548`*^9}, {
   3.900749507529608*^9, 3.9007495081859293`*^9}, {3.900749580241394*^9, 
   3.9007496320022297`*^9}, {3.900749707661212*^9, 3.900749728865814*^9}, {
   3.9007500691468897`*^9, 3.900750089470285*^9}, {3.900750139484006*^9, 
   3.900750247944889*^9}, {3.900750333006386*^9, 3.9007503956543837`*^9}, {
   3.9007504541626177`*^9, 3.9007504546145487`*^9}, 3.900750489897481*^9, {
   3.900750521278421*^9, 3.900750523047613*^9}, {3.900750642510437*^9, 
   3.900750693552402*^9}, {3.900750726209366*^9, 3.900750732856337*^9}},
 CellLabel->
  "In[806]:=",ExpressionUUID->"decd7be5-2945-4564-93da-56971622b668"],

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"plots", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Plot3D", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{"solution", "[", 
            RowBox[{"t", ",", "x", ",", "y"}], "]"}], "]"}], "2"], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "\[CapitalOmega]"}], 
         ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              RowBox[{"solution", "[", 
               RowBox[{"0", ",", "0", ",", "0"}], "]"}], "]"}], "2"]}], 
           "}"}]}], ",", 
         RowBox[{"PlotPoints", "->", "pp"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax", ",", 
         RowBox[{"tmax", "/", "20"}]}], "}"}]}], "]"}]}], ";"}], ",", 
   RowBox[{"N", "[", 
    RowBox[{"t", "/", "tmax"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.900734171674107*^9, 3.900734174423214*^9}, {
   3.9007342666425858`*^9, 3.900734267085569*^9}, {3.900734358852235*^9, 
   3.900734505970479*^9}, {3.900734639335828*^9, 3.9007346906762657`*^9}, 
   3.900734838023106*^9, {3.9007349526189823`*^9, 3.9007349885169783`*^9}, {
   3.900735280987217*^9, 3.900735377173849*^9}, {3.9007354734662457`*^9, 
   3.900735490336289*^9}, {3.900735573402679*^9, 3.900735574409214*^9}, {
   3.9007356143642597`*^9, 3.900735632545293*^9}, 3.900735720895022*^9, {
   3.900745742193803*^9, 3.900745773539242*^9}, 3.900745872541483*^9, {
   3.900745982003278*^9, 3.900745998100768*^9}, {3.900747296283513*^9, 
   3.900747373017991*^9}, {3.900748030188114*^9, 3.9007480479034357`*^9}, {
   3.90075067552413*^9, 3.900750695930875*^9}},
 CellLabel->
  "In[807]:=",ExpressionUUID->"3c0e978d-05d3-4925-8fe9-1faa9aeada5a"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", "plots", "]"}]], "Input",
 CellChangeTimes->{{3.900735369445443*^9, 3.900735423601088*^9}, {
   3.900735538752701*^9, 3.900735544254718*^9}, 3.900747290496645*^9},
 CellLabel->
  "In[808]:=",ExpressionUUID->"a3862e98-07ef-4503-9bd9-da3847dc86c4"]
},
WindowSize->{720, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4b84edac-beb3-48d0-a583-f3af61a4eaf9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4778, 92, 264, "Input",ExpressionUUID->"d9863ba2-4441-4181-8cd8-9f583aae6f69"],
Cell[5339, 114, 7700, 169, 495, "Input",ExpressionUUID->"8cf6d7c5-30d9-4c73-a4dd-b8013c3e0a9e"],
Cell[13042, 285, 517, 14, 33, "Input",ExpressionUUID->"bffdd301-2302-4996-9497-864ab862ae73"],
Cell[13562, 301, 657, 16, 33, "Input",ExpressionUUID->"2a2395e1-9082-4429-b171-ddc84764d95f"],
Cell[14222, 319, 1827, 41, 102, "Input",ExpressionUUID->"753a6641-2e76-4eb9-82b3-f242b516fc0e"],
Cell[16052, 362, 289, 5, 30, "Input",ExpressionUUID->"5ba5062a-226c-4852-8bb7-83bd24ad4582"],
Cell[16344, 369, 7990, 172, 432, "Input",ExpressionUUID->"decd7be5-2945-4564-93da-56971622b668"],
Cell[24337, 543, 1927, 43, 102, "Input",ExpressionUUID->"3c0e978d-05d3-4925-8fe9-1faa9aeada5a"],
Cell[26267, 588, 289, 5, 30, "Input",ExpressionUUID->"a3862e98-07ef-4503-9bd9-da3847dc86c4"]
}
]
*)

