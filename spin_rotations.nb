(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     77365,       2124]
NotebookOptionsPosition[     70016,       2001]
NotebookOutlinePosition[     70415,       2017]
CellTagsIndexPosition[     70372,       2014]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "generateSpinOperators", "]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"generateSpinOperators", "[", "S_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d", ",", " ", "Sx", ",", " ", "Sy", ",", " ", "Sz", ",", " ", "Splus", 
       ",", " ", "Sminus", ",", "ms"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{
        RowBox[{"2", "S"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ms", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"-", "S"}], ",", "S"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Splus", " ", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "d"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Splus", "[", 
           RowBox[{"[", 
            RowBox[{"#", ",", 
             RowBox[{"#", "+", "1"}]}], "]"}], "]"}], "=", 
          SqrtBox[
           RowBox[{
            RowBox[{"S", 
             RowBox[{"(", 
              RowBox[{"S", "+", "1"}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"ms", "[", 
              RowBox[{"[", "#", "]"}], "]"}], 
             RowBox[{"ms", "[", 
              RowBox[{"[", 
               RowBox[{"#", "+", "1"}], "]"}], "]"}]}]}]]}], ")"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Length", "[", "ms", "]"}], "-", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Sminus", " ", "=", " ", 
       RowBox[{"Splus", "\[ConjugateTranspose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sx", "=", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", 
         RowBox[{"Splus", "+", "Sminus"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sy", "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[ImaginaryI]"}]], 
        RowBox[{"(", 
         RowBox[{"Splus", "-", "Sminus"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Sz", "=", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sx", ".", "Sy"}], "-", 
          RowBox[{"Sy", ".", "Sx"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "Sx", ",", " ", "Sy", ",", " ", "Sz", ",", " ", "Splus", ",", 
        "Sminus"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{
  "Sx", ",", " ", "Sy", ",", " ", "Sz", ",", " ", "Splus", ",", "Sminus", ",",
    "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "Sx", ",", " ", "Sy", ",", " ", "Sz", ",", " ", "Splus", ",", "Sminus"}], 
    "}"}], "=", 
   RowBox[{"generateSpinOperators", "[", "S", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForm", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"Sx", ",", "Sy", ",", "Sz", ",", "Splus", ",", "Sminus"}], 
    "}"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.8837151308900957`*^9, 3.883715155169854*^9}, {
   3.8837151995386744`*^9, 3.8837152463170347`*^9}, 3.883726400439286*^9, {
   3.883730366680769*^9, 3.883730512367765*^9}, {3.883730726209984*^9, 
   3.883731119036509*^9}, 3.883731287514518*^9, {3.8837316172747183`*^9, 
   3.883731625486525*^9}, {3.883731925646884*^9, 3.8837319258937483`*^9}, {
   3.88373195817834*^9, 3.8837319668149433`*^9}, {3.883732767132958*^9, 
   3.883732767784688*^9}, {3.8837328489873953`*^9, 3.883732874253516*^9}, {
   3.883732937185771*^9, 3.883732937859675*^9}, {3.884241624009181*^9, 
   3.884241627923473*^9}, {3.8842533133287582`*^9, 3.884253335227714*^9}, {
   3.884253500229467*^9, 3.884253539406597*^9}, {3.88425405820044*^9, 
   3.884254058484439*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"70608b01-a617-4dde-8b70-785530065bc7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox["1", "2"]},
       {
        FractionBox["1", "2"], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", "2"]}]},
       {
        FractionBox["\[ImaginaryI]", "2"], "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", "2"], "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", "2"]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1"},
       {"0", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0"},
       {"1", "0"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.883730784312008*^9, 3.883730815673088*^9}, {
   3.883730909995467*^9, 3.883730959331511*^9}, {3.883731004673996*^9, 
   3.883731068729754*^9}, {3.883731114183713*^9, 3.883731119474523*^9}, 
   3.8837312878866158`*^9, 3.883731626064249*^9, 3.88373192654878*^9, {
   3.883731959148282*^9, 3.883731967124423*^9}, 3.8837327682281303`*^9, {
   3.88373284948874*^9, 3.883732875246847*^9}, 3.883732938524539*^9, 
   3.883812200349161*^9, 3.884237238546238*^9, 3.8842415513220367`*^9, {
   3.884241599259253*^9, 3.8842416282532673`*^9}, {3.884253314350016*^9, 
   3.884253337601924*^9}, 3.884253385409561*^9, {3.884253500868764*^9, 
   3.8842535397302713`*^9}, 3.8842540587895327`*^9},
 CellLabel->
  "Out[382]=",ExpressionUUID->"dfbfa24a-68ad-40b2-b022-88d246673419"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sx", ".", "Sx"}], " ", "+", " ", 
     RowBox[{"Sy", ".", "Sy"}], " ", "+", " ", 
     RowBox[{"Sz", ".", "Sz"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"S", "*", 
     RowBox[{"(", 
      RowBox[{"S", "+", "1"}], ")"}]}], ")"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.884241552758088*^9, 3.8842416174040318`*^9}, {
  3.8842416823376207`*^9, 3.884241684558298*^9}},
 CellLabel->
  "In[383]:=",ExpressionUUID->"a6b0396f-f5f2-4410-a3fb-5c5fa1866812"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8842415568706627`*^9, 3.884241629076126*^9}, 
   3.884241685031926*^9, {3.88425331437392*^9, 3.884253337640079*^9}, 
   3.884253392821273*^9, {3.884253501592147*^9, 3.884253540711424*^9}, 
   3.8842540596554613`*^9},
 CellLabel->
  "Out[383]//MatrixForm=",ExpressionUUID->"9905850b-6295-4f72-a917-\
b998b38e1c57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "\[ImaginaryI]", ",", " ", "0"}], "}"}]}], ",", 
     
     RowBox[{
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "\[ImaginaryI]"}], ",", " ", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"T", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Inverse", "[", "T", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.883812208909719*^9, 3.883812297891918*^9}, {
  3.883812367576726*^9, 3.8838123948442097`*^9}, {3.883812431815157*^9, 
  3.883812509593368*^9}, {3.884252764240399*^9, 3.884252774889756*^9}, {
  3.8842529629613647`*^9, 3.884253010629918*^9}, {3.884253273938592*^9, 
  3.884253280050084*^9}, {3.8842534705293694`*^9, 3.884253488659993*^9}, {
  3.8842547686087503`*^9, 3.8842547735679493`*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"bdc83ed1-256e-45c0-a34f-1879f1cc18b0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0"},
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883812263076222*^9, 3.883812298372212*^9}, {
   3.883812361753508*^9, 3.883812509879341*^9}, 3.883812551980749*^9, 
   3.8838128674720383`*^9, 3.8842372386707697`*^9, {3.884252746441455*^9, 
   3.8842527754214373`*^9}, {3.884252968352591*^9, 3.8842530109797783`*^9}, 
   3.884253280888997*^9, {3.8842533143777847`*^9, 3.8842533376439543`*^9}, 
   3.8842533936546507`*^9, {3.884253489892269*^9, 3.884253541340818*^9}, 
   3.884254060227971*^9, 3.884254774027071*^9},
 CellLabel->
  "Out[398]//MatrixForm=",ExpressionUUID->"f5f9f3b2-ddbb-44ef-80cd-\
bbea86ae3c3b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0"},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883812263076222*^9, 3.883812298372212*^9}, {
   3.883812361753508*^9, 3.883812509879341*^9}, 3.883812551980749*^9, 
   3.8838128674720383`*^9, 3.8842372386707697`*^9, {3.884252746441455*^9, 
   3.8842527754214373`*^9}, {3.884252968352591*^9, 3.8842530109797783`*^9}, 
   3.884253280888997*^9, {3.8842533143777847`*^9, 3.8842533376439543`*^9}, 
   3.8842533936546507`*^9, {3.884253489892269*^9, 3.884253541340818*^9}, 
   3.884254060227971*^9, 3.8842547740296593`*^9},
 CellLabel->
  "Out[399]//MatrixForm=",ExpressionUUID->"58db0489-dde9-4acf-86e5-\
5c0e4de4ed22"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", "\[ConjugateTranspose]"}], ".", "T"}], "\[IndentingNewLine]", 
 RowBox[{"T", ".", 
  RowBox[{"T", "\[ConjugateTranspose]"}]}]}], "Input",
 CellChangeTimes->{{3.88425464326324*^9, 3.884254645765552*^9}, {
  3.8842548293072243`*^9, 3.884254831048716*^9}},
 CellLabel->
  "In[402]:=",ExpressionUUID->"0426f023-a13a-451c-97a5-0bc17ac5dfbd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.884254646789268*^9, 3.884254781941825*^9, 
  3.884254831592519*^9},
 CellLabel->
  "Out[402]=",ExpressionUUID->"6078b80a-99da-4031-af32-f9b6201f875b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.884254646789268*^9, 3.884254781941825*^9, 
  3.8842548315956182`*^9},
 CellLabel->
  "Out[403]=",ExpressionUUID->"562d9ebd-1a95-4424-b3ad-448c3d96b62a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", ".", 
   RowBox[{"{", 
    RowBox[{"Sxt", ",", "Syt", ",", "Szt"}], "}"}]}], " ", 
  RowBox[{"(*", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        SqrtBox["2"]}], 
       SuperscriptBox["S", "+"]}], ",", 
      RowBox[{
       RowBox[{"1", "/", 
        SqrtBox["2"]}], 
       SuperscriptBox["S", "-"]}], ",", " ", 
      SuperscriptBox["S", "z"]}], ")"}], "T"], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Sxt", ",", "Syt", ",", "Szt"}], "}"}], "\[Transpose]"}], ".", 
  RowBox[{"T", "\[ConjugateTranspose]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       SqrtBox["2"]}], 
      SuperscriptBox["S", "-"]}], ",", 
     RowBox[{
      RowBox[{"1", "/", 
       SqrtBox["2"]}], 
      SuperscriptBox["S", "+"]}], ",", " ", 
     SuperscriptBox["S", "z"]}], ")"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8842527914204683`*^9, 3.884252820387473*^9}, {
  3.884256347988577*^9, 3.88425635197653*^9}, {3.88425638605954*^9, 
  3.884256391889045*^9}, {3.884257227706541*^9, 
  3.884257324937636*^9}},ExpressionUUID->"e290e566-0978-441e-ade1-\
5d0dcfda71a7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["Sxt", 
     SqrtBox["2"]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "Syt"}], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    FractionBox["Sxt", 
     SqrtBox["2"]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "Syt"}], 
     SqrtBox["2"]]}], ",", "Szt"}], "}"}]], "Output",
 CellChangeTimes->{{3.8842527922754498`*^9, 3.884252820956155*^9}, {
   3.8842529739851713`*^9, 3.884253012896305*^9}, {3.8842533143964252`*^9, 
   3.884253337664055*^9}, 3.884253421645083*^9, 3.884256352443061*^9, 
   3.884256392441482*^9, {3.8842572776761513`*^9, 3.884257305393724*^9}},
 CellLabel->
  "Out[413]=",ExpressionUUID->"2da14f3e-ff74-42af-9bc2-5fb95ef985b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["Sxt", 
     SqrtBox["2"]], "-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "Syt"}], 
     SqrtBox["2"]]}], ",", 
   RowBox[{
    FractionBox["Sxt", 
     SqrtBox["2"]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "Syt"}], 
     SqrtBox["2"]]}], ",", "Szt"}], "}"}]], "Output",
 CellChangeTimes->{{3.8842527922754498`*^9, 3.884252820956155*^9}, {
   3.8842529739851713`*^9, 3.884253012896305*^9}, {3.8842533143964252`*^9, 
   3.884253337664055*^9}, 3.884253421645083*^9, 3.884256352443061*^9, 
   3.884256392441482*^9, {3.8842572776761513`*^9, 3.88425730539704*^9}},
 CellLabel->
  "Out[414]=",ExpressionUUID->"4565f385-9d54-4308-bc15-1db22b0d3410"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"T", "\[ConjugateTranspose]"}], ".", "T"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{
  3.884252847790275*^9, {3.884252893032516*^9, 3.884252899164188*^9}, {
   3.884252931611924*^9, 3.884252947928997*^9}, {3.884253016901432*^9, 
   3.8842530241308403`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"c494ec9d-270e-4ee0-935a-ff937f93cc9f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", "0", "0"},
     {"0", "2", "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.884252848261331*^9, {3.884252896596963*^9, 3.884252899645761*^9}, {
   3.884252933337405*^9, 3.884253024505007*^9}, {3.8842533144067802`*^9, 
   3.8842533376671867`*^9}},
 CellLabel->
  "Out[261]//MatrixForm=",ExpressionUUID->"7b15bdd0-440f-4964-a583-\
9735448a78c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Inverse", "[", "T", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.884252832920662*^9, 3.8842528366005087`*^9}, {
  3.884252902810205*^9, 3.884252930033852*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"b6c103f1-4844-47fe-af0b-22212fce96f9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], 
      FractionBox["1", "2"], "0"},
     {
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      FractionBox["\[ImaginaryI]", "2"], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.884252837456325*^9, {3.884252905746427*^9, 3.884252926202868*^9}, 
   3.884252996967905*^9, {3.884253314409997*^9, 3.88425333767723*^9}},
 CellLabel->
  "Out[262]//MatrixForm=",ExpressionUUID->"204b3e2b-1da2-4c29-bc0c-\
f571fdb3e389"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"Rz", ",", "Ry"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rz", "[", "\[Phi]_", "]"}], "=", 
   RowBox[{"ComplexExpand", "[", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]", " ", "Sz"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ry", "[", "\[Theta]_", "]"}], "=", 
   RowBox[{"ComplexExpand", "[", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]", " ", "Sy"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883731121350978*^9, 3.8837312093724613`*^9}, {
  3.8837314454440813`*^9, 3.883731459144391*^9}, {3.883731631541648*^9, 
  3.883731632079678*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"7be83afb-1f3b-4431-814b-752c20b0fc80"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "R", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "[", 
    RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"ComplexExpand", "[", 
    RowBox[{
     RowBox[{"Rz", "[", "\[Phi]", "]"}], ".", 
     RowBox[{"Ry", "[", "\[Theta]", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.88373118757395*^9, 3.883731227239375*^9}, {
   3.883731463938856*^9, 3.88373149002527*^9}, 3.883731633520152*^9},
 CellLabel->
  "In[266]:=",ExpressionUUID->"4470774c-d119-4737-93cc-19541547f666"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"tilde", ",", "Sxtilde", ",", "Sytilde", ",", "Sztilde"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tilde", "[", 
    RowBox[{"S\[Alpha]_", ",", "\[Phi]_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}], "\[ConjugateTranspose]"}], 
     "]"}], ".", "S\[Alpha]", ".", 
    RowBox[{"R", "[", 
     RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tilde", "[", 
    RowBox[{"Sx", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "//", 
   "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sxtilde", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"+", "Sz"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"Sx", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
    RowBox[{"Sy", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%%", "-", "Sxtilde"}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tilde", "[", 
    RowBox[{"Sy", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "//", 
   "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sytilde", "=", 
   RowBox[{
    RowBox[{"Sz", " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
    RowBox[{"Sx", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
    RowBox[{"Sy", " ", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%%", "-", "Sytilde"}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tilde", "[", 
    RowBox[{"Sz", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "//", 
   "FullSimplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sztilde", "=", 
   RowBox[{
    RowBox[{"Sz", " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
    RowBox[{"Sx", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%%", "-", "Sztilde"}], "//", "Simplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.883731246477086*^9, 3.883731349840673*^9}, {
  3.883731405550709*^9, 3.883731436757782*^9}, {3.8837314991722097`*^9, 
  3.883731954011908*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"55d188ee-3c7c-4439-88e5-7af4f1328f41"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883731326713546*^9, 3.883731350345242*^9}, {
   3.883731407987226*^9, 3.8837314372500896`*^9}, {3.88373149305402*^9, 
   3.883731600519112*^9}, {3.8837316355489902`*^9, 3.88373183158193*^9}, {
   3.8837318727968397`*^9, 3.883731969343854*^9}, 3.883732770196417*^9, {
   3.883732851423534*^9, 3.8837328752922907`*^9}, 3.8837329388789682`*^9, 
   3.88423724023755*^9, {3.8842533145765553`*^9, 3.884253337715807*^9}},
 CellLabel->
  "Out[271]//MatrixForm=",ExpressionUUID->"2839e06e-3c2f-4ea7-bac0-\
17c473246f90"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883731326713546*^9, 3.883731350345242*^9}, {
   3.883731407987226*^9, 3.8837314372500896`*^9}, {3.88373149305402*^9, 
   3.883731600519112*^9}, {3.8837316355489902`*^9, 3.88373183158193*^9}, {
   3.8837318727968397`*^9, 3.883731969343854*^9}, 3.883732770196417*^9, {
   3.883732851423534*^9, 3.8837328752922907`*^9}, 3.8837329388789682`*^9, 
   3.88423724023755*^9, {3.8842533145765553`*^9, 3.8842533377169313`*^9}},
 CellLabel->
  "Out[273]//MatrixForm=",ExpressionUUID->"b8924ffe-ba56-4f6f-86e0-\
3e282222880d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883731326713546*^9, 3.883731350345242*^9}, {
   3.883731407987226*^9, 3.8837314372500896`*^9}, {3.88373149305402*^9, 
   3.883731600519112*^9}, {3.8837316355489902`*^9, 3.88373183158193*^9}, {
   3.8837318727968397`*^9, 3.883731969343854*^9}, 3.883732770196417*^9, {
   3.883732851423534*^9, 3.8837328752922907`*^9}, 3.8837329388789682`*^9, 
   3.88423724023755*^9, {3.8842533145765553`*^9, 3.8842533377402887`*^9}},
 CellLabel->
  "Out[275]//MatrixForm=",ExpressionUUID->"cd9df321-d8ff-4a05-b8e2-\
b2e682159474"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883731326713546*^9, 3.883731350345242*^9}, {
   3.883731407987226*^9, 3.8837314372500896`*^9}, {3.88373149305402*^9, 
   3.883731600519112*^9}, {3.8837316355489902`*^9, 3.88373183158193*^9}, {
   3.8837318727968397`*^9, 3.883731969343854*^9}, 3.883732770196417*^9, {
   3.883732851423534*^9, 3.8837328752922907`*^9}, 3.8837329388789682`*^9, 
   3.88423724023755*^9, {3.8842533145765553`*^9, 3.884253337741498*^9}},
 CellLabel->
  "Out[277]//MatrixForm=",ExpressionUUID->"5ba5fe60-2d77-47d3-9c86-\
03677139c4f8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883731326713546*^9, 3.883731350345242*^9}, {
   3.883731407987226*^9, 3.8837314372500896`*^9}, {3.88373149305402*^9, 
   3.883731600519112*^9}, {3.8837316355489902`*^9, 3.88373183158193*^9}, {
   3.8837318727968397`*^9, 3.883731969343854*^9}, 3.883732770196417*^9, {
   3.883732851423534*^9, 3.8837328752922907`*^9}, 3.8837329388789682`*^9, 
   3.88423724023755*^9, {3.8842533145765553`*^9, 3.8842533377501783`*^9}},
 CellLabel->
  "Out[279]//MatrixForm=",ExpressionUUID->"afd84702-71d3-412a-83a7-\
c44f4d4ef132"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883731326713546*^9, 3.883731350345242*^9}, {
   3.883731407987226*^9, 3.8837314372500896`*^9}, {3.88373149305402*^9, 
   3.883731600519112*^9}, {3.8837316355489902`*^9, 3.88373183158193*^9}, {
   3.8837318727968397`*^9, 3.883731969343854*^9}, 3.883732770196417*^9, {
   3.883732851423534*^9, 3.8837328752922907`*^9}, 3.8837329388789682`*^9, 
   3.88423724023755*^9, {3.8842533145765553`*^9, 3.884253337751293*^9}},
 CellLabel->
  "Out[281]//MatrixForm=",ExpressionUUID->"75dd0848-b39d-4bde-a341-\
eceaee8c2353"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", 
    RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", " ", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Phi]", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0", ",", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.883732458861895*^9, 3.883732564474367*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"9dedd23c-2c31-4717-a93f-a5de100fdc2e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "0", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883732557075633*^9, 3.883732565002524*^9}, 
   3.883732770914606*^9, {3.883732852478963*^9, 3.8837328753076563`*^9}, {
   3.8837329389049664`*^9, 3.8837329451575613`*^9}, 3.884237241559998*^9, {
   3.884253314718676*^9, 3.884253337754361*^9}},
 CellLabel->
  "Out[283]//MatrixForm=",ExpressionUUID->"e49ae995-4888-43ea-bf1b-\
ae04d16eec10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"tilde", "[", 
       RowBox[{"#", ",", "\[Phi]", ",", "\[Theta]"}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"Sx", ",", "Sy", ",", "Sz"}], "}"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"U", "[", 
      RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"Sx", ",", "Sy", ",", "Sz"}], "}"}]}], ")"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Flatten", "[", "%", "]"}], "//", "DeleteDuplicates"}]}], "Input",
 CellChangeTimes->{{3.883732585667836*^9, 3.883732718752056*^9}, {
  3.883732785558894*^9, 3.883732840549343*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"41f153eb-924f-4022-8a20-079cd2842945"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.883732607516406*^9, 3.88373267937323*^9}, {
   3.8837327143432913`*^9, 3.8837327204444532`*^9}, {3.883732783707343*^9, 
   3.883732875322353*^9}, {3.883732938923809*^9, 3.883732945995405*^9}, 
   3.884237242293253*^9, {3.884253314832514*^9, 3.884253337765995*^9}},
 CellLabel->
  "Out[284]=",ExpressionUUID->"cda39cd3-2482-4bf3-889f-1bdff8e022f4"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.883732607516406*^9, 3.88373267937323*^9}, {
   3.8837327143432913`*^9, 3.8837327204444532`*^9}, {3.883732783707343*^9, 
   3.883732875322353*^9}, {3.883732938923809*^9, 3.883732945995405*^9}, 
   3.884237242293253*^9, {3.884253314832514*^9, 3.8842533377668858`*^9}},
 CellLabel->
  "Out[285]=",ExpressionUUID->"3ffd86eb-d05b-408d-91f4-207a39b234a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"U", "[", 
      RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}], "\[Transpose]"}], ")"}], 
   ".", 
   RowBox[{"U", "[", 
    RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", 
    RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}], ".", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"U", "[", 
      RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}], "\[Transpose]"}], ")"}]}], "//",
   "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.883732907102845*^9, 3.883732926815518*^9}, {
  3.883732998291757*^9, 3.8837330242348127`*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"2d685493-ecca-4fdc-a85f-b0a475f786b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.883732910549343*^9, 3.883732946548287*^9}, {
   3.88373299922309*^9, 3.88373302457977*^9}, 3.8842372422970963`*^9, {
   3.884253314836639*^9, 3.884253337776486*^9}},
 CellLabel->
  "Out[286]=",ExpressionUUID->"359d8252-4bc6-4f83-8ff6-ae206792018c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.883732910549343*^9, 3.883732946548287*^9}, {
   3.88373299922309*^9, 3.88373302457977*^9}, 3.8842372422970963`*^9, {
   3.884253314836639*^9, 3.884253337777429*^9}},
 CellLabel->
  "Out[287]=",ExpressionUUID->"3f29ebae-d417-4a46-adaa-1e6a2c9e2a6e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Series", "[", 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     RowBox[{
      FractionBox["n", "2"], "x"}]}]], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "3"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox["1", "2"], "x"}]}]], "-", "1"}], ")"}], "n"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.883808520358973*^9, 3.88380854962713*^9}, {
  3.883808584459424*^9, 3.8838086077677402`*^9}, {3.883808649850113*^9, 
  3.883808756021511*^9}, {3.8838088050076427`*^9, 3.883808817492639*^9}, {
  3.883808895638109*^9, 3.8838088957028427`*^9}, {3.883811819770494*^9, 
  3.883811878423092*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"35babb4b-149b-4cfe-93ea-9812b44a3665"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   FractionBox[
    RowBox[{"n", " ", "x"}], "4"], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["n", "2"], " ", 
     SuperscriptBox["x", "2"]}], "32"], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["n", "3"], " ", 
     SuperscriptBox["x", "3"]}], "128"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "4"],
    SeriesData[$CellContext`x, 0, {}, 0, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {
   1, Rational[-1, 4] $CellContext`n, Rational[-1, 32] $CellContext`n^2, 
    Rational[-1, 128] $CellContext`n^3}, 0, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.883808550201086*^9, {3.883808594556946*^9, 3.883808608305694*^9}, {
   3.88380865380519*^9, 3.883808756370535*^9}, {3.883808811113327*^9, 
   3.883808818108358*^9}, 3.8838088961888113`*^9, {3.8838118395531073`*^9, 
   3.8838118787709103`*^9}, 3.884237242317017*^9, {3.8842533148455687`*^9, 
   3.884253337780609*^9}},
 CellLabel->
  "Out[288]=",ExpressionUUID->"47735e93-d1f8-4180-8255-44e10312c621"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   FractionBox[
    RowBox[{"n", " ", "x"}], "4"], "-", 
   FractionBox[
    RowBox[{"n", " ", 
     SuperscriptBox["x", "2"]}], "32"], "-", 
   FractionBox[
    RowBox[{"n", " ", 
     SuperscriptBox["x", "3"]}], "128"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "4"],
    SeriesData[$CellContext`x, 0, {}, 0, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {
   1, Rational[-1, 4] $CellContext`n, Rational[-1, 32] $CellContext`n, 
    Rational[-1, 128] $CellContext`n}, 0, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.883808550201086*^9, {3.883808594556946*^9, 3.883808608305694*^9}, {
   3.88380865380519*^9, 3.883808756370535*^9}, {3.883808811113327*^9, 
   3.883808818108358*^9}, 3.8838088961888113`*^9, {3.8838118395531073`*^9, 
   3.8838118787709103`*^9}, 3.884237242317017*^9, {3.8842533148455687`*^9, 
   3.884253337781555*^9}},
 CellLabel->
  "Out[289]=",ExpressionUUID->"b8ce4fb9-e2e2-43dc-98c3-51ac8c402ea8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"Jmn", ",", "J", ",", " ", "B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Jmn", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Bn", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.883814578232258*^9, 3.883814599651083*^9}, {
  3.8838148476481028`*^9, 3.8838149052939453`*^9}, {3.883814984496323*^9, 
  3.883814997456668*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"db4fdb89-d187-466c-a8b3-ba537289f23e"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"spinspin", ",", "m", ",", "n"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spinspin", "[", 
   RowBox[{"Sp_", ",", "Sm_", ",", "Sz_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sp", "[", "m", "]"}], ",", " ", 
      RowBox[{"Sm", "[", "m", "]"}], ",", " ", 
      RowBox[{"Sz", "[", "m", "]"}]}], "}"}], "\[Transpose]"}], ".", "J", ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sp", "[", "n", "]"}], ",", " ", 
     RowBox[{"Sm", "[", "n", "]"}], ",", " ", 
     RowBox[{"Sz", "[", "n", "]"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.8838149086724243`*^9, 3.883814965097982*^9}, {
  3.883815003372013*^9, 3.883815007893916*^9}, {3.883815505875227*^9, 
  3.8838155533036337`*^9}, {3.883815701586289*^9, 3.88381570333939*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"1bc99355-66c5-44e4-af50-b969e6dd96c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"Spt1", ",", "Smt1", ",", "Sz"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Spt1", "[", "m_", "]"}], "=", 
  RowBox[{"\[HBar]", " ", 
   SqrtBox[
    RowBox[{"2", "s"}]], 
   RowBox[{"a", "[", "m", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Smt1", "[", "m_", "]"}], "=", 
  RowBox[{"\[HBar]", " ", 
   SqrtBox[
    RowBox[{"2", "s"}]], 
   RowBox[{"ad", "[", "m", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "[", "m_", "]"}], "=", 
  RowBox[{"\[HBar]", 
   RowBox[{"(", 
    RowBox[{"s", "-", 
     RowBox[{"n", "[", "m", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.883815596150042*^9, 3.883815604334133*^9}, {
  3.8838156364888477`*^9, 3.883815738797936*^9}, {3.883817072334573*^9, 
  3.883817075639122*^9}, {3.883817486613535*^9, 3.883817491491434*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"3b31a212-aa27-4b86-98fa-c9eb22dc76e1"],

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], " ", 
  SqrtBox["s"], " ", "\[HBar]", " ", 
  RowBox[{"a", "[", "m", "]"}]}]], "Output",
 CellChangeTimes->{
  3.883815705252924*^9, 3.88381573946516*^9, 3.883817076824321*^9, 
   3.883817492098817*^9, 3.883817552931582*^9, {3.8838180156988993`*^9, 
   3.8838180389605713`*^9}, 3.884237242340711*^9, {3.884253314861581*^9, 
   3.884253337795952*^9}},
 CellLabel->
  "Out[296]=",ExpressionUUID->"60eddae8-4744-4dc2-b158-78a38b0988d3"],

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], " ", 
  SqrtBox["s"], " ", "\[HBar]", " ", 
  RowBox[{"ad", "[", "m", "]"}]}]], "Output",
 CellChangeTimes->{
  3.883815705252924*^9, 3.88381573946516*^9, 3.883817076824321*^9, 
   3.883817492098817*^9, 3.883817552931582*^9, {3.8838180156988993`*^9, 
   3.8838180389605713`*^9}, 3.884237242340711*^9, {3.884253314861581*^9, 
   3.884253337796893*^9}},
 CellLabel->
  "Out[297]=",ExpressionUUID->"d0cdc723-1d7a-414f-a21a-c09766b89ba9"],

Cell[BoxData[
 RowBox[{"\[HBar]", " ", 
  RowBox[{"(", 
   RowBox[{"s", "-", 
    RowBox[{"n", "[", "m", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.883815705252924*^9, 3.88381573946516*^9, 3.883817076824321*^9, 
   3.883817492098817*^9, 3.883817552931582*^9, {3.8838180156988993`*^9, 
   3.8838180389605713`*^9}, 3.884237242340711*^9, {3.884253314861581*^9, 
   3.8842533377977877`*^9}},
 CellLabel->
  "Out[298]=",ExpressionUUID->"62a0d6d2-dc4f-48c5-a38e-dd173d1711b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"o1", ",", "o2", ",", "o3", ",", "o4", ",", "o5", ",", "o6"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"o1", "=", 
   RowBox[{"a", "[", "m", "]"}]}], ";", 
  RowBox[{"o2", "=", 
   RowBox[{"ad", "[", "m", "]"}]}], ";", 
  RowBox[{"o3", "=", 
   RowBox[{"n", "[", "m", "]"}]}], ";", 
  RowBox[{"o4", "=", 
   RowBox[{"a", "[", "n", "]"}]}], ";", 
  RowBox[{"o5", "=", 
   RowBox[{"ad", "[", "n", "]"}]}], ";", 
  RowBox[{"o6", "=", 
   RowBox[{"n", "[", "n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"spinspin", "[", 
      RowBox[{"Spt1", ",", "Smt1", ",", "Sz"}], "]"}], "//", "ExpandAll"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"o1", ",", "o2", ",", "o3", ",", "o4", ",", "o5", ",", "o6"}], 
     "}"}]}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.88381557234011*^9, 3.883815580374096*^9}, {
  3.8838157434091387`*^9, 3.883815756420602*^9}, {3.88381580875268*^9, 
  3.883815883474864*^9}, {3.883815928951339*^9, 3.8838159302798147`*^9}, {
  3.883815960967143*^9, 3.8838159724840927`*^9}, {3.8838160060810633`*^9, 
  3.883816062689148*^9}, {3.883816100648344*^9, 3.883816152467338*^9}, {
  3.883816356480068*^9, 3.883816439995976*^9}, {3.883816665751129*^9, 
  3.88381684595466*^9}, {3.883816876555523*^9, 3.883816908884552*^9}, {
  3.883816960214612*^9, 3.883816961853539*^9}, {3.8838171540559893`*^9, 
  3.883817170639762*^9}, {3.883817445281929*^9, 3.8838174511452923`*^9}, {
  3.8838175019345818`*^9, 3.883817518297509*^9}, {3.883817619543055*^9, 
  3.88381764512074*^9}, {3.883817884600252*^9, 3.883818055441156*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"fdf10e1e-f286-4b8d-a17d-fb0f4826f6ea"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.883817580824823*^9, {3.8838176202022247`*^9, 3.8838176455127487`*^9}, {
   3.883817885852109*^9, 3.88381794327207*^9}, {3.883817975437941*^9, 
   3.8838180562673197`*^9}, 3.884237242356472*^9, {3.8842533148730307`*^9, 
   3.8842533378083553`*^9}},
 CellLabel->
  "Out[301]=",ExpressionUUID->"b285a0e7-8395-417a-813a-db1448e873ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"Spt1", ",", "Smt1", ",", "Sz"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Spt1", "[", "m_", "]"}], "=", 
  RowBox[{"\[HBar]", " ", 
   SqrtBox[
    RowBox[{"2", "s"}]], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"d", "*", 
      RowBox[{"n", "[", "m", "]"}]}]}], ")"}], 
   RowBox[{"a", "[", "m", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Smt1", "[", "m_", "]"}], "=", 
  RowBox[{"\[HBar]", " ", 
   SqrtBox[
    RowBox[{"2", "s"}]], 
   RowBox[{"ad", "[", "m", "]"}], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"d", "*", 
      RowBox[{"n", "[", "m", "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", "[", "m_", "]"}], "=", 
  RowBox[{"\[HBar]", 
   RowBox[{"(", 
    RowBox[{"s", "-", 
     RowBox[{"n", "[", "m", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.883815596150042*^9, 3.883815604334133*^9}, {
  3.8838156364888477`*^9, 3.883815738797936*^9}, {3.883817072334573*^9, 
  3.883817075639122*^9}, {3.883817486613535*^9, 3.883817491491434*^9}, {
  3.8838175658536386`*^9, 3.883817577982916*^9}, {3.8838196841849823`*^9, 
  3.883819707424963*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"44e672d4-cff8-4cdc-ad69-82db4c5b53f7"],

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], " ", 
  SqrtBox["s"], " ", "\[HBar]", " ", 
  RowBox[{"a", "[", "m", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"d", " ", 
     RowBox[{"n", "[", "m", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.883815705252924*^9, 3.88381573946516*^9, 3.883817076824321*^9, 
   3.883817492098817*^9, {3.883817552931582*^9, 3.883817579431157*^9}, 
   3.883818029359923*^9, 3.883819708118355*^9, 3.8842372423594913`*^9, {
   3.884253314876233*^9, 3.884253337811688*^9}},
 CellLabel->
  "Out[303]=",ExpressionUUID->"b7750a99-9cfd-4b88-aa96-140713351eb7"],

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], " ", 
  SqrtBox["s"], " ", "\[HBar]", " ", 
  RowBox[{"ad", "[", "m", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"d", " ", 
     RowBox[{"n", "[", "m", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.883815705252924*^9, 3.88381573946516*^9, 3.883817076824321*^9, 
   3.883817492098817*^9, {3.883817552931582*^9, 3.883817579431157*^9}, 
   3.883818029359923*^9, 3.883819708118355*^9, 3.8842372423594913`*^9, {
   3.884253314876233*^9, 3.884253337812595*^9}},
 CellLabel->
  "Out[304]=",ExpressionUUID->"d54450ec-ba67-4632-a8e5-16fac7527ad1"],

Cell[BoxData[
 RowBox[{"\[HBar]", " ", 
  RowBox[{"(", 
   RowBox[{"s", "-", 
    RowBox[{"n", "[", "m", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.883815705252924*^9, 3.88381573946516*^9, 3.883817076824321*^9, 
   3.883817492098817*^9, {3.883817552931582*^9, 3.883817579431157*^9}, 
   3.883818029359923*^9, 3.883819708118355*^9, 3.8842372423594913`*^9, {
   3.884253314876233*^9, 3.884253337813451*^9}},
 CellLabel->
  "Out[305]=",ExpressionUUID->"03615e18-783a-4110-9ef4-e6315de37f85"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"o1", ",", "o2", ",", "o3", ",", "o4", ",", "o5", ",", "o6"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"o1", "=", 
   RowBox[{"a", "[", "m", "]"}]}], ";", 
  RowBox[{"o2", "=", 
   RowBox[{"ad", "[", "m", "]"}]}], ";", 
  RowBox[{"o3", "=", 
   RowBox[{"n", "[", "m", "]"}]}], ";", 
  RowBox[{"o4", "=", 
   RowBox[{"a", "[", "n", "]"}]}], ";", 
  RowBox[{"o5", "=", 
   RowBox[{"ad", "[", "n", "]"}]}], ";", 
  RowBox[{"o6", "=", 
   RowBox[{"n", "[", "n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"CoefficientList", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"spinspin", "[", 
      RowBox[{"Spt1", ",", "Smt1", ",", "Sz"}], "]"}], "//", "ExpandAll"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"o1", ",", "o2", ",", "o3", ",", "o4", ",", "o5", ",", "o6"}], 
     "}"}]}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "2", ",", "2"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.88381557234011*^9, 3.883815580374096*^9}, {
  3.8838157434091387`*^9, 3.883815756420602*^9}, {3.88381580875268*^9, 
  3.883815883474864*^9}, {3.883815928951339*^9, 3.8838159302798147`*^9}, {
  3.883815960967143*^9, 3.8838159724840927`*^9}, {3.8838160060810633`*^9, 
  3.883816062689148*^9}, {3.883816100648344*^9, 3.883816152467338*^9}, {
  3.883816356480068*^9, 3.883816439995976*^9}, {3.883816665751129*^9, 
  3.88381684595466*^9}, {3.883816876555523*^9, 3.883816908884552*^9}, {
  3.883816960214612*^9, 3.883816961853539*^9}, {3.8838171540559893`*^9, 
  3.883817170639762*^9}, {3.883817445281929*^9, 3.8838174511452923`*^9}, {
  3.8838175019345818`*^9, 3.883817518297509*^9}, {3.883817619543055*^9, 
  3.88381764512074*^9}, {3.883817884600252*^9, 3.883818033009193*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"b8fbc06d-2e74-4183-a236-dcd8d7a3e874"],

Cell[BoxData[
 RowBox[{"2", " ", "d", " ", "s", " ", 
  SuperscriptBox["\[HBar]", "2"], " ", 
  RowBox[{"Jmn", "[", 
   RowBox[{"2", ",", "2"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.883817580824823*^9, {3.8838176202022247`*^9, 3.8838176455127487`*^9}, {
   3.883817885852109*^9, 3.88381794327207*^9}, {3.883817975437941*^9, 
   3.883818033246759*^9}, 3.8838197091002607`*^9, 3.884237242375698*^9, {
   3.88425331488871*^9, 3.884253337824432*^9}},
 CellLabel->
  "Out[308]=",ExpressionUUID->"ce63ef50-cb19-4f93-acad-e01a11599659"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"(", 
    RowBox[{"A", "+", 
     RowBox[{"A", "\[Transpose]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"A", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"bla", "=", 
  RowBox[{"T", ".", "A", ".", 
   RowBox[{"Inverse", "[", "T", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"bla", "=", 
  RowBox[{
   RowBox[{"Inverse", "[", "T", "]"}], ".", "A", ".", "T"}]}]}], "Input",
 CellChangeTimes->{{3.883824004028885*^9, 3.8838240678537807`*^9}, {
  3.883824138010847*^9, 3.883824141945578*^9}, {3.883824226574987*^9, 
  3.883824317897341*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"3f31c1f9-bba3-4770-8272-bbccfd7ea970"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.0279175509135845`"}], "1.1461455882450982`", 
      RowBox[{"-", "0.8400126533172996`"}]},
     {"1.1461455882450982`", "0.9490921129573939`", "0.45007538264359637`"},
     {
      RowBox[{"-", "0.8400126533172996`"}], "0.45007538264359637`", 
      "1.2869552735445335`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.883824004615848*^9, {3.8838240553314*^9, 3.883824068629912*^9}, 
   3.88382410862217*^9, {3.883824142518642*^9, 3.88382414616374*^9}, {
   3.883824244726*^9, 3.883824318546234*^9}, 3.884237242379388*^9, {
   3.884253314892152*^9, 3.884253337827835*^9}},
 CellLabel->
  "Out[311]//MatrixForm=",ExpressionUUID->"a65e1d40-5b28-4d37-9dbb-\
4087fa69f436"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.039412718978095285`"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.9885048319354892`"}], "+", 
      RowBox[{"1.1461455882450982`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.8400126533172996`"}], "+", 
      RowBox[{"0.45007538264359637`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.9885048319354892`"}], "-", 
      RowBox[{"1.1461455882450982`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.039412718978095285`"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.8400126533172996`"}], "-", 
      RowBox[{"0.45007538264359637`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.4200063266586498`"}], "-", 
      RowBox[{"0.22503769132179818`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.4200063266586498`"}], "+", 
      RowBox[{"0.22503769132179818`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.2869552735445335`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.883824004615848*^9, {3.8838240553314*^9, 3.883824068629912*^9}, 
   3.88382410862217*^9, {3.883824142518642*^9, 3.88382414616374*^9}, {
   3.883824244726*^9, 3.883824318546234*^9}, 3.884237242379388*^9, {
   3.884253314892152*^9, 3.884253337828803*^9}},
 CellLabel->
  "Out[312]=",ExpressionUUID->"0ac2e1da-7bb0-4aab-8c95-2b060e29d073"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.1067328692670029`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.9885048319354892`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.1949686353368516`"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.9885048319354892`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1855583072231934`"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.645044017980448`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.3899372706737032`"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", 
      RowBox[{"1.290088035960896`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.2869552735445335`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.883824004615848*^9, {3.8838240553314*^9, 3.883824068629912*^9}, 
   3.88382410862217*^9, {3.883824142518642*^9, 3.88382414616374*^9}, {
   3.883824244726*^9, 3.883824318546234*^9}, 3.884237242379388*^9, {
   3.884253314892152*^9, 3.884253337829822*^9}},
 CellLabel->
  "Out[313]=",ExpressionUUID->"791ae29d-69e8-4ca3-9dbe-2cb18f063d45"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bla", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bla", "-", 
   RowBox[{"bla", "\[ConjugateTranspose]"}]}], "//", "MatrixForm"}]}], "Input",\

 CellChangeTimes->{{3.8838240695544043`*^9, 3.883824188995921*^9}, {
  3.8838242797762003`*^9, 3.883824280570224*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"2e389c21-012b-47ef-977d-8987bcceaec2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"1.1067328692670029`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.9885048319354892`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "0.1949686353368516`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9885048319354892`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{
       RowBox[{"-", "1.1855583072231934`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.645044017980448`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.3899372706737032`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.290088035960896`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"1.2869552735445335`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883824070574667*^9, 3.8838241896284113`*^9}, {
   3.883824247676888*^9, 3.883824319801794*^9}, 3.884237242390339*^9, {
   3.884253314897162*^9, 3.8842533378409233`*^9}},
 CellLabel->
  "Out[314]//MatrixForm=",ExpressionUUID->"c7ab5366-b612-43be-adb9-\
63120b14ddae"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.1949686353368516`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.645044017980448`", " ", "\[ImaginaryI]"}]}]},
     {
      RowBox[{
       RowBox[{"-", "0.1949686353368516`"}], "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.645044017980448`", " ", "\[ImaginaryI]"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.883824070574667*^9, 3.8838241896284113`*^9}, {
   3.883824247676888*^9, 3.883824319801794*^9}, 3.884237242390339*^9, {
   3.884253314897162*^9, 3.884253337842147*^9}},
 CellLabel->
  "Out[315]//MatrixForm=",ExpressionUUID->"4260f4e0-3756-4941-9e29-\
ec1ed88e5b98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U", "[", 
  RowBox[{"0", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.8842375308381653`*^9, 3.884237532664186*^9}},
 CellLabel->
  "In[316]:=",ExpressionUUID->"6afd02d8-2b95-407d-af73-9412813f92b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.884237533073927*^9, {3.8842533149066772`*^9, 3.884253337845148*^9}},
 CellLabel->
  "Out[316]=",ExpressionUUID->"04f6daf8-d536-4017-8d90-7f7a041b62f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a1c", ",", "a2c", ",", "0"}], "}"}], "\[Transpose]"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j11", ",", "j12", ",", "j13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j21", ",", "j22", ",", "j23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j31", ",", "j32", ",", "j33"}], "}"}]}], "}"}], ".", 
   RowBox[{"{", 
    RowBox[{"a1nc", ",", "a2nc", ",", "0"}], "}"}]}], "//", 
  "ExpandAll"}]], "Input",
 CellChangeTimes->{{3.884239767469836*^9, 3.884239829869186*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"041de06c-3d75-4883-84b3-bb46fd580cac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1c", " ", "a1nc", " ", "j11"}], "+", 
  RowBox[{"a1c", " ", "a2nc", " ", "j12"}], "+", 
  RowBox[{"a1nc", " ", "a2c", " ", "j21"}], "+", 
  RowBox[{"a2c", " ", "a2nc", " ", "j22"}]}]], "Output",
 CellChangeTimes->{{3.8842398012767973`*^9, 3.884239830371387*^9}, {
  3.8842533149097767`*^9, 3.884253337857354*^9}},
 CellLabel->
  "Out[317]=",ExpressionUUID->"81315c24-59b1-48fd-bd9c-d06293c06b19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "a3c"}], "}"}], "\[Transpose]"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j11", ",", "j12", ",", "j13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j21", ",", "j22", ",", "j23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j31", ",", "j32", ",", "j33"}], "}"}]}], "}"}], ".", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "a3nc"}], "}"}]}], "//", 
  "ExpandAll"}]], "Input",
 CellChangeTimes->{{3.8842399471974382`*^9, 3.8842399585669203`*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"681fbfbc-9123-42dc-809b-d17320cd2cda"],

Cell[BoxData[
 RowBox[{"a3c", " ", "a3nc", " ", "j33"}]], "Output",
 CellChangeTimes->{
  3.884239959243733*^9, {3.8842533149124613`*^9, 3.884253337860363*^9}},
 CellLabel->
  "Out[318]=",ExpressionUUID->"025c4775-f107-4bdb-8c36-bedd5765e4ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"T", "\[ConjugateTranspose]"}], ".", 
    RowBox[{
     RowBox[{"U", "[", 
      RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}], "\[Transpose]"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ".", 
    RowBox[{"U", "[", 
     RowBox[{"\[Phi]", ",", "\[Theta]"}], "]"}], ".", "T"}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.884261336452694*^9, 3.8842614101575727`*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"7dd4ed0d-3967-406f-8264-e90898399f49"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], "2"], 
      RowBox[{
       FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", "\[ImaginaryI]", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], 
      FractionBox[
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], "2"], 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
       SqrtBox["2"]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
        SqrtBox["2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
        SqrtBox["2"]]}], 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.884261345137292*^9, 3.884261349311418*^9}, {
  3.884261386176156*^9, 3.884261410867976*^9}},
 CellLabel->
  "Out[420]//MatrixForm=",ExpressionUUID->"db4060d4-c2c0-4999-87de-\
68adf2a444db"]
}, Open  ]]
},
WindowSize->{960, 1027},
WindowMargins->{{0, Automatic}, {Automatic, -180}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e782cb47-e2a0-4627-a588-d05e368561ec"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4386, 116, 489, "Input",ExpressionUUID->"70608b01-a617-4dde-8b70-785530065bc7"],
Cell[4969, 140, 3542, 97, 65, "Output",ExpressionUUID->"dfbfa24a-68ad-40b2-b022-88d246673419"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8548, 242, 552, 16, 30, "Input",ExpressionUUID->"a6b0396f-f5f2-4410-a3fb-5c5fa1866812"],
Cell[9103, 260, 818, 22, 63, "Output",ExpressionUUID->"9905850b-6295-4f72-a917-b998b38e1c57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9958, 287, 1174, 30, 98, "Input",ExpressionUUID->"bdc83ed1-256e-45c0-a34f-1879f1cc18b0"],
Cell[11135, 319, 1315, 35, 99, "Output",ExpressionUUID->"f5f9f3b2-ddbb-44ef-80cd-bbea86ae3c3b"],
Cell[12453, 356, 1317, 35, 99, "Output",ExpressionUUID->"58db0489-dde9-4acf-86e5-5c0e4de4ed22"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13807, 396, 376, 8, 52, "Input",ExpressionUUID->"0426f023-a13a-451c-97a5-0bc17ac5dfbd"],
Cell[14186, 406, 432, 12, 34, "Output",ExpressionUUID->"6078b80a-99da-4031-af32-f9b6201f875b"],
Cell[14621, 420, 434, 12, 34, "Output",ExpressionUUID->"562d9ebd-1a95-4424-b3ad-448c3d96b62a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15092, 437, 1245, 40, 58, "Input",ExpressionUUID->"e290e566-0978-441e-ade1-5d0dcfda71a7"],
Cell[16340, 479, 742, 20, 54, "Output",ExpressionUUID->"2da14f3e-ff74-42af-9bc2-5fb95ef985b6"],
Cell[17085, 501, 741, 20, 54, "Output",ExpressionUUID->"4565f385-9d54-4308-bc15-1db22b0d3410"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17863, 526, 447, 11, 52, "Input",ExpressionUUID->"c494ec9d-270e-4ee0-935a-ff937f93cc9f"],
Cell[18313, 539, 806, 23, 79, "Output",ExpressionUUID->"7b15bdd0-440f-4964-a583-9735448a78c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19156, 567, 293, 6, 30, "Input",ExpressionUUID->"b6c103f1-4844-47fe-af0b-22212fce96f9"],
Cell[19452, 575, 920, 27, 95, "Output",ExpressionUUID->"204b3e2b-1da2-4c29-bc0c-f571fdb3e389"]
}, Open  ]],
Cell[20387, 605, 868, 23, 73, "Input",ExpressionUUID->"7be83afb-1f3b-4431-814b-752c20b0fc80"],
Cell[21258, 630, 557, 13, 52, "Input",ExpressionUUID->"4470774c-d119-4737-93cc-19541547f666"],
Cell[CellGroupData[{
Cell[21840, 647, 2915, 84, 304, "Input",ExpressionUUID->"55d188ee-3c7c-4439-88e5-7af4f1328f41"],
Cell[24758, 733, 1956, 51, 79, "Output",ExpressionUUID->"2839e06e-3c2f-4ea7-bac0-17c473246f90"],
Cell[26717, 786, 1018, 24, 63, "Output",ExpressionUUID->"b8924ffe-ba56-4f6f-86e0-3e282222880d"],
Cell[27738, 812, 1984, 52, 79, "Output",ExpressionUUID->"cd9df321-d8ff-4a05-b8e2-b2e682159474"],
Cell[29725, 866, 1016, 24, 63, "Output",ExpressionUUID->"5ba5fe60-2d77-47d3-9c86-03677139c4f8"],
Cell[30744, 892, 1358, 35, 83, "Output",ExpressionUUID->"afd84702-71d3-412a-83a7-c44f4d4ef132"],
Cell[32105, 929, 1016, 24, 63, "Output",ExpressionUUID->"75dd0848-b39d-4bde-a341-eceaee8c2353"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33158, 958, 1247, 35, 73, "Input",ExpressionUUID->"9dedd23c-2c31-4717-a93f-a5de100fdc2e"],
Cell[34408, 995, 1519, 41, 83, "Output",ExpressionUUID->"e49ae995-4888-43ea-bf1b-ae04d16eec10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35964, 1041, 795, 22, 52, "Input",ExpressionUUID->"41f153eb-924f-4022-8a20-079cd2842945"],
Cell[36762, 1065, 918, 26, 34, "Output",ExpressionUUID->"cda39cd3-2482-4bf3-889f-1bdff8e022f4"],
Cell[37683, 1093, 422, 7, 34, "Output",ExpressionUUID->"3ffd86eb-d05b-408d-91f4-207a39b234a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38142, 1105, 763, 23, 52, "Input",ExpressionUUID->"2d685493-ecca-4fdc-a85f-b0a475f786b2"],
Cell[38908, 1130, 531, 13, 34, "Output",ExpressionUUID->"359d8252-4bc6-4f83-8ff6-ae206792018c"],
Cell[39442, 1145, 531, 13, 34, "Output",ExpressionUUID->"3f29ebae-d417-4a46-adaa-1e6a2c9e2a6e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40010, 1163, 965, 28, 103, "Input",ExpressionUUID->"35babb4b-149b-4cfe-93ea-9812b44a3665"],
Cell[40978, 1193, 1106, 29, 53, "Output",ExpressionUUID->"47735e93-d1f8-4180-8255-44e10312c621"],
Cell[42087, 1224, 1048, 27, 53, "Output",ExpressionUUID->"b8ce4fb9-e2e2-43dc-98c3-51ac8c402ea8"]
}, Open  ]],
Cell[43150, 1254, 864, 24, 73, "Input",ExpressionUUID->"db4fdb89-d187-466c-a8b3-ba537289f23e"],
Cell[44017, 1280, 920, 22, 52, "Input",ExpressionUUID->"1bc99355-66c5-44e4-af50-b969e6dd96c3"],
Cell[CellGroupData[{
Cell[44962, 1306, 936, 25, 96, "Input",ExpressionUUID->"3b31a212-aa27-4b86-98fa-c9eb22dc76e1"],
Cell[45901, 1333, 473, 11, 35, "Output",ExpressionUUID->"60eddae8-4744-4dc2-b158-78a38b0988d3"],
Cell[46377, 1346, 474, 11, 35, "Output",ExpressionUUID->"d0cdc723-1d7a-414f-a21a-c09766b89ba9"],
Cell[46854, 1359, 480, 11, 34, "Output",ExpressionUUID->"62a0d6d2-dc4f-48c5-a38e-dd173d1711b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47371, 1375, 1844, 42, 73, "Input",ExpressionUUID->"fdf10e1e-f286-4b8d-a17d-fb0f4826f6ea"],
Cell[49218, 1419, 383, 7, 34, "Output",ExpressionUUID->"b285a0e7-8395-417a-813a-db1448e873ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49638, 1431, 1262, 35, 96, "Input",ExpressionUUID->"44e672d4-cff8-4cdc-ad69-82db4c5b53f7"],
Cell[50903, 1468, 606, 15, 35, "Output",ExpressionUUID->"b7750a99-9cfd-4b88-aa96-140713351eb7"],
Cell[51512, 1485, 607, 15, 35, "Output",ExpressionUUID->"d54450ec-ba67-4632-a8e5-16fac7527ad1"],
Cell[52122, 1502, 498, 11, 34, "Output",ExpressionUUID->"03615e18-783a-4110-9ef4-e6315de37f85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52657, 1518, 1844, 42, 73, "Input",ExpressionUUID->"b8fbc06d-2e74-4183-a236-dcd8d7a3e874"],
Cell[54504, 1562, 536, 11, 34, "Output",ExpressionUUID->"ce63ef50-cb19-4f93-acad-e01a11599659"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55077, 1578, 969, 26, 115, "Input",ExpressionUUID->"3f31c1f9-bba3-4770-8272-bbccfd7ea970"],
Cell[56049, 1606, 1126, 28, 79, "Output",ExpressionUUID->"a65e1d40-5b28-4d37-9dbb-4087fa69f436"],
Cell[57178, 1636, 1694, 43, 77, "Output",ExpressionUUID->"0ac2e1da-7bb0-4aab-8c95-2b060e29d073"],
Cell[58875, 1681, 1570, 36, 56, "Output",ExpressionUUID->"791ae29d-69e8-4ca3-9dbe-2cb18f063d45"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60482, 1722, 393, 9, 52, "Input",ExpressionUUID->"2e389c21-012b-47ef-977d-8987bcceaec2"],
Cell[60878, 1733, 1773, 43, 79, "Output",ExpressionUUID->"c7ab5366-b612-43be-adb9-63120b14ddae"],
Cell[62654, 1778, 1685, 41, 79, "Output",ExpressionUUID->"4260f4e0-3756-4941-9e29-ec1ed88e5b98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64376, 1824, 228, 5, 30, "Input",ExpressionUUID->"6afd02d8-2b95-407d-af73-9412813f92b8"],
Cell[64607, 1831, 436, 12, 34, "Output",ExpressionUUID->"04f6daf8-d536-4017-8d90-7f7a041b62f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65080, 1848, 669, 19, 30, "Input",ExpressionUUID->"041de06c-3d75-4883-84b3-bb46fd580cac"],
Cell[65752, 1869, 432, 9, 34, "Output",ExpressionUUID->"81315c24-59b1-48fd-bd9c-d06293c06b19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66221, 1883, 668, 19, 30, "Input",ExpressionUUID->"681fbfbc-9123-42dc-809b-d17320cd2cda"],
Cell[66892, 1904, 243, 5, 34, "Output",ExpressionUUID->"025c4775-f107-4bdb-8c36-bedd5765e4ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67172, 1914, 768, 21, 30, "Input",ExpressionUUID->"7dd4ed0d-3967-406f-8264-e90898399f49"],
Cell[67943, 1937, 2057, 61, 121, "Output",ExpressionUUID->"db4060d4-c2c0-4999-87de-68adf2a444db"]
}, Open  ]]
}
]
*)

