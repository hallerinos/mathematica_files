(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26086,        631]
NotebookOptionsPosition[     24146,        592]
NotebookOutlinePosition[     24539,        608]
CellTagsIndexPosition[     24496,        605]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"psit", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "1", ",", "7"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"psi", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"Sequence", "@@", "psit"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"invpsi", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"KroneckerProduct", "[", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"Reverse", "[", "psit", "]"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"o1", "=", 
   RowBox[{"Ordering", "[", "psi", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"o2", "=", 
   RowBox[{"Ordering", "[", "invpsi", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"invpsi", "[", 
      RowBox[{"[", 
       RowBox[{"o2", "[", 
        RowBox[{"[", "o1", "]"}], "]"}], "]"}], "]"}], "]"}], "-", "psi"}], 
   "]"}], "==", 
  RowBox[{"{", "0", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", " ", "=", " ", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Length", "[", "psi", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pMatrix", " ", "=", " ", 
   RowBox[{"id", "[", 
    RowBox[{"[", 
     RowBox[{"o1", ",", "o2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SparseArray", "[", "%", "]"}], "\[IndentingNewLine]", 
 RowBox[{"DeleteDuplicates", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"PermutationMatrix", "[", 
     RowBox[{"o2", "[", 
      RowBox[{"[", "o1", "]"}], "]"}], "]"}], "-", "pMatrix"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.912830330107172*^9, 3.912830604088574*^9}, {
  3.91283063608014*^9, 3.91283065991788*^9}, {3.912830973537827*^9, 
  3.912830973720439*^9}, {3.912831485858323*^9, 3.91283149355755*^9}, {
  3.912833106073189*^9, 3.912833112306229*^9}, {3.912833402528987*^9, 
  3.912833483859193*^9}, {3.912833727639723*^9, 3.912833738785336*^9}, {
  3.9128338453331738`*^9, 3.912833845577805*^9}, {3.912833883349888*^9, 
  3.912833891843837*^9}, {3.912833923760524*^9, 3.912833932012335*^9}, {
  3.912833970500319*^9, 3.912833995698381*^9}, {3.912834030886941*^9, 
  3.912834202133787*^9}, {3.9128374512983007`*^9, 3.912837718137994*^9}, {
  3.9131961128698473`*^9, 3.91319613131643*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"28f515a4-b79c-4601-8bed-f10d28bda064"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9128375386927843`*^9, 3.912837666514934*^9}, {
  3.912837697854253*^9, 3.912837718631624*^9}, {3.913196109652196*^9, 
  3.913196131986247*^9}},
 CellLabel->"Out[99]=",ExpressionUUID->"2f818616-d7c4-4d6e-a898-9695afc431df"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["SparseArray",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = True, Typeset`embedState$$ = "Ready"}, 
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"], 
               ImageSizeCache -> {11., {0., 11.}}], Appearance -> None, 
              BaseStyle -> {}, ButtonFunction :> (Typeset`open$$ = True), 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJztmDFLA1EQhA8Cgn/BLqKNlWAhpNlKrEK4VIoQUQg2Biux8R9onSJYBUFQ
sPGaYGtjIwoWYieChkAQAoJVIqKtSiCBmd0pDo4p3n0z+3bv3eU3d8rVXJIk
Uz/X131h77LSmL6xo4Vmtvhxb+1m/jk97Zj0b/14MFku1h7tLF2t5LZfrdeb
mNtdexPnP3rrYH6plbXtYfnkfL/eteuVWn/9fXQ8/WwrHczeWWemUKq+PNnG
xe1h8apLvw5aPuL0wY/GidZ3487Ha/7sdUHTWfxGqy+aX/bc2PnFo32OzCme
v3W072Wdx+TLEyca/7DPRcs52nyIln80zmg5RONBmwNo+Q/LyfLeRNNZ+LXP
NR8YOcXDxfObPqr/ISx+0TjReFjOJ+zvC+Xm2y+LzlJftLqw+EVbBy0fcfrg
R+NE6zuWeRWNB40TLR+vnPKr3JB9icdHv7D49cqj8xiXX6+5ofli50Tj13mD
q4+i5R+N8xNOKcK7
              "], {{0, 0}, {26, 26}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["128", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"128", ",", "128"}], "}"}], "SummaryItem"]}]}}, 
             AutoDelete -> False, 
             BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {
              "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
          False, BaselinePosition -> {1, 1}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], True -> 
        GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"], 
               ImageSizeCache -> {11., {0., 11.}}], Appearance -> None, 
              BaseStyle -> {}, ButtonFunction :> (Typeset`open$$ = False), 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[
             RasterBox[CompressedData["
1:eJztmDFLA1EQhA8Cgn/BLqKNlWAhpNlKrEK4VIoQUQg2Biux8R9onSJYBUFQ
sPGaYGtjIwoWYieChkAQAoJVIqKtSiCBmd0pDo4p3n0z+3bv3eU3d8rVXJIk
Uz/X131h77LSmL6xo4Vmtvhxb+1m/jk97Zj0b/14MFku1h7tLF2t5LZfrdeb
mNtdexPnP3rrYH6plbXtYfnkfL/eteuVWn/9fXQ8/WwrHczeWWemUKq+PNnG
xe1h8apLvw5aPuL0wY/GidZ3487Ha/7sdUHTWfxGqy+aX/bc2PnFo32OzCme
v3W072Wdx+TLEyca/7DPRcs52nyIln80zmg5RONBmwNo+Q/LyfLeRNNZ+LXP
NR8YOcXDxfObPqr/ISx+0TjReFjOJ+zvC+Xm2y+LzlJftLqw+EVbBy0fcfrg
R+NE6zuWeRWNB40TLR+vnPKr3JB9icdHv7D49cqj8xiXX6+5ofli50Tj13mD
q4+i5R+N8xNOKcK7
              "], {{0, 0}, {26, 26}}, {0, 1}], AspectRatio -> 1, Axes -> 
             False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
             Directive[
               Opacity[0.5], 
               Thickness[Tiny], 
               RGBColor[0.368417, 0.506779, 0.709798]], 
             FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
             Directive[
               GrayLevel[0.5, 0.4]], ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], 
             Method -> {
              "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
               Automatic, 
               "DefaultGraphicsInteraction" -> {
                "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
                 "Effects" -> {
                  "Highlight" -> {"ratio" -> 2}, 
                   "HighlightPoint" -> {"ratio" -> 2}, 
                   "Droplines" -> {
                    "freeformCursorMode" -> True, 
                    "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
               "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
               Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Specified elements: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["128", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"128", ",", "128"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["0.0078125`", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"\"", "SummaryItem"]}]}, {
               TagBox[
                TagBox[
                 GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", BaselinePosition -> Baseline, ContentPadding -> 
                    False, FrameMargins -> 0, 
                    ImageSize -> {{1, 300}, Automatic}, StripOnInput -> True],
                     LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "65"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", BaselinePosition -> Baseline, ContentPadding -> 
                    False, FrameMargins -> 0, 
                    ImageSize -> {{1, 300}, Automatic}, StripOnInput -> True],
                     LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"3", ",", "33"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", BaselinePosition -> Baseline, ContentPadding -> 
                    False, FrameMargins -> 0, 
                    ImageSize -> {{1, 300}, Automatic}, StripOnInput -> True],
                     LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"4", ",", "97"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", BaselinePosition -> Baseline, ContentPadding -> 
                    False, FrameMargins -> 0, 
                    ImageSize -> {{1, 300}, Automatic}, StripOnInput -> True],
                     LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, DefaultBaseStyle -> "Column", 
                  GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                  GridBoxItemSize -> {
                   "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                 "Column"], "SummaryItem"]}}, AutoDelete -> False, 
             BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {
              "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, AutoDelete -> 
          False, BaselinePosition -> {1, 1}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  SparseArray[
  Automatic, {128, 128}, 0, {
   1, {{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 
     20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 
     38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 
     56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 
     74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 
     92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 
     108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 
     122, 123, 124, 125, 126, 127, 128}, {{1}, {65}, {33}, {97}, {17}, {81}, {
     49}, {113}, {9}, {73}, {41}, {105}, {25}, {89}, {57}, {121}, {5}, {69}, {
     37}, {101}, {21}, {85}, {53}, {117}, {13}, {77}, {45}, {109}, {29}, {
     93}, {61}, {125}, {3}, {67}, {35}, {99}, {19}, {83}, {51}, {115}, {11}, {
     75}, {43}, {107}, {27}, {91}, {59}, {123}, {7}, {71}, {39}, {103}, {
     23}, {87}, {55}, {119}, {15}, {79}, {47}, {111}, {31}, {95}, {63}, {
     127}, {2}, {66}, {34}, {98}, {18}, {82}, {50}, {114}, {10}, {74}, {42}, {
     106}, {26}, {90}, {58}, {122}, {6}, {70}, {38}, {102}, {22}, {86}, {
     54}, {118}, {14}, {78}, {46}, {110}, {30}, {94}, {62}, {126}, {4}, {
     68}, {36}, {100}, {20}, {84}, {52}, {116}, {12}, {76}, {44}, {108}, {
     28}, {92}, {60}, {124}, {8}, {72}, {40}, {104}, {24}, {88}, {56}, {
     120}, {16}, {80}, {48}, {112}, {32}, {96}, {64}, {128}}}, {1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
    1}}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.9128375386927843`*^9, 3.912837666514934*^9}, {
  3.912837697854253*^9, 3.912837718631624*^9}, {3.913196109652196*^9, 
  3.9131961320583553`*^9}},
 CellLabel->
  "Out[102]=",ExpressionUUID->"eff047dc-e55c-4c70-8340-c44f81c322fb"],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.9128375386927843`*^9, 3.912837666514934*^9}, {
  3.912837697854253*^9, 3.912837718631624*^9}, {3.913196109652196*^9, 
  3.913196132066585*^9}},
 CellLabel->
  "Out[103]=",ExpressionUUID->"138fc5f2-9f51-4554-87ca-af84c5de45b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KroneckerProduct", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[109]:=",ExpressionUUID->"34afa957-0b07-446e-80d5-8df80c576505"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9131971924135838`*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"4f8e2bc7-6ef4-4252-a0c6-8eaa7e7f4924"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"KroneckerProduct", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"KroneckerProduct", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.91319715273857*^9, 3.913197165698341*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"0c010b43-5eff-48e3-845e-27f749433318"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9131971548135233`*^9, 3.913197193244652*^9}},
 CellLabel->
  "Out[110]=",ExpressionUUID->"d5cb9cc6-6ee3-408a-b3f7-e86ef7c66708"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9131971548135233`*^9, 3.9131971932478037`*^9}},
 CellLabel->
  "Out[111]=",ExpressionUUID->"24f82b70-4bd7-4b12-a693-2d2e3a903bd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"KroneckerProduct", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9131971412420063`*^9, 3.913197145312639*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"d92bb6a9-147f-41d9-a53f-17b6ce6651bb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.913197145768734*^9, 3.913197195197907*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"bc606ef9-b96f-47c1-bc27-2598a4f38d25"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sv", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PauliMatrix", "[", "i", "]"}], "/", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.913197719505309*^9, 3.913197756043702*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"212f9a72-600a-4c40-8024-4ad4f4dcb0ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"state", " ", "=", 
   RowBox[{"Normalize", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "+", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "\[ImaginaryI]"}]}],
        ")"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "+", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "\[ImaginaryI]"}]}],
        ")"}], 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rstate", " ", "=", " ", 
   RowBox[{
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]", " ", 
      RowBox[{"Sv", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ".", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Theta]", " ", 
      RowBox[{"Sv", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ".", "state"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9131977386302233`*^9, 3.913197810920822*^9}, {
  3.913197873094923*^9, 3.9131978818646507`*^9}, {3.913197916477055*^9, 
  3.9131979829363937`*^9}, {3.9131997977353983`*^9, 3.913199811414755*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"054e561a-648a-4155-90a9-9502ad94d920"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fstate", " ", "=", " ", 
   RowBox[{"4", 
    RowBox[{
     RowBox[{"Sv", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ".", 
     RowBox[{"Sv", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ".", "state"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"state", "\[Conjugate]"}], ".", "s", ".", "state"}], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", "Sv"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fstate", "\[Conjugate]"}], ".", "s", ".", "fstate"}], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", "Sv"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.913197992545988*^9, 3.91319804281131*^9}, {
  3.9131982094980993`*^9, 3.913198221104267*^9}, {3.913198263339917*^9, 
  3.913198270402543*^9}, {3.913198304718465*^9, 3.913198306426248*^9}, {
  3.9131984116229486`*^9, 3.913198423314238*^9}, {3.913199702510099*^9, 
  3.9131997039468803`*^9}, {3.913199738195693*^9, 3.913199774914998*^9}, {
  3.913199843654697*^9, 3.913199917565325*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"ae794e75-be0f-4736-a301-f72704a1ba72"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.36320489429218017`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.3039881209195284`"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.1602292953926348`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.91319799312031*^9, 3.9131980430901117`*^9}, 
   3.913198221617381*^9, 3.913198270864479*^9, {3.913198307202773*^9, 
   3.913198325963928*^9}, {3.9131984118267107`*^9, 3.9131984235792913`*^9}, 
   3.913199705302348*^9, {3.913199738762577*^9, 3.913199777560589*^9}, {
   3.913199815469502*^9, 3.913199917776973*^9}},
 CellLabel->
  "Out[253]=",ExpressionUUID->"327616e1-43c2-40cb-99ab-700b1d921768"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.36320489429218017`"}], "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.3039881209195284`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"0.1602292953926348`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.91319799312031*^9, 3.9131980430901117`*^9}, 
   3.913198221617381*^9, 3.913198270864479*^9, {3.913198307202773*^9, 
   3.913198325963928*^9}, {3.9131984118267107`*^9, 3.9131984235792913`*^9}, 
   3.913199705302348*^9, {3.913199738762577*^9, 3.913199777560589*^9}, {
   3.913199815469502*^9, 3.913199917781763*^9}},
 CellLabel->
  "Out[254]=",ExpressionUUID->"2957890e-dea8-497c-acd6-17219f07b7e1"]
}, Open  ]]
},
WindowSize->{1120, 1207},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c8e9bae1-70ae-42d6-bbf4-357da6647c19"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2715, 70, 220, "Input",ExpressionUUID->"28f515a4-b79c-4601-8bed-f10d28bda064"],
Cell[3298, 94, 276, 4, 34, "Output",ExpressionUUID->"2f818616-d7c4-4d6e-a898-9695afc431df"],
Cell[3577, 100, 12686, 251, 179, "Output",ExpressionUUID->"eff047dc-e55c-4c70-8340-c44f81c322fb"],
Cell[16266, 353, 299, 6, 34, "Output",ExpressionUUID->"138fc5f2-9f51-4554-87ca-af84c5de45b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16602, 364, 273, 8, 30, "Input",ExpressionUUID->"34afa957-0b07-446e-80d5-8df80c576505"],
Cell[16878, 374, 298, 9, 34, "Output",ExpressionUUID->"4f8e2bc7-6ef4-4252-a0c6-8eaa7e7f4924"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17213, 388, 531, 15, 52, "Input",ExpressionUUID->"0c010b43-5eff-48e3-845e-27f749433318"],
Cell[17747, 405, 322, 9, 34, "Output",ExpressionUUID->"d5cb9cc6-6ee3-408a-b3f7-e86ef7c66708"],
Cell[18072, 416, 324, 9, 34, "Output",ExpressionUUID->"24f82b70-4bd7-4b12-a693-2d2e3a903bd7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18433, 430, 341, 9, 30, "Input",ExpressionUUID->"d92bb6a9-147f-41d9-a53f-17b6ce6651bb"],
Cell[18777, 441, 318, 9, 34, "Output",ExpressionUUID->"bc606ef9-b96f-47c1-bc27-2598a4f38d25"]
}, Open  ]],
Cell[19110, 453, 406, 11, 30, "Input",ExpressionUUID->"212f9a72-600a-4c40-8024-4ad4f4dcb0ae"],
Cell[19519, 466, 1800, 54, 52, "Input",ExpressionUUID->"054e561a-648a-4155-90a9-9502ad94d920"],
Cell[CellGroupData[{
Cell[21344, 524, 1166, 29, 73, "Input",ExpressionUUID->"ae794e75-be0f-4736-a301-f72704a1ba72"],
Cell[22513, 555, 807, 16, 34, "Output",ExpressionUUID->"327616e1-43c2-40cb-99ab-700b1d921768"],
Cell[23323, 573, 807, 16, 34, "Output",ExpressionUUID->"2957890e-dea8-497c-acd6-17219f07b7e1"]
}, Open  ]]
}
]
*)

